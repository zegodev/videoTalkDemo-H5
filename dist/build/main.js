webpackJsonp([0],{150:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=150},177:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=177},201:function(e,t,n){"use strict";function i(e){return M._19(0,[(e()(),M.Z(0,0,null,null,2,"ion-nav",[],null,null,null,_e.b,_e.a)),M._15(6144,null,be.a,null,[ye.a]),M.Y(2,4374528,null,0,ye.a,[[2,Ce.a],[2,Se.a],Te.a,Ee.a,Re.a,M.j,M.u,M.z,M.i,Pe.l,Ie.a,[2,Le.a],ke.a,M.k],{root:[0,"root"]},null),(e()(),M._18(-1,null,["\n"]))],function(e,t){e(t,2,0,t.component.rootPage)},null)}function r(e){return M._19(0,[(e()(),M.Z(0,0,null,null,2,"ion-option",[],null,null,null,null,null)),M.Y(1,16384,[[21,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(2,null,["",""]))],function(e,t){e(t,1,0,t.context.$implicit.deviceId)},function(e,t){e(t,2,0,t.context.$implicit.label)})}function l(e){return M._19(0,[(e()(),M.Z(0,0,null,null,2,"ion-option",[],null,null,null,null,null)),M.Y(1,16384,[[28,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(2,null,["",""]))],function(e,t){e(t,1,0,t.context.$implicit.deviceId)},function(e,t){e(t,2,0,t.context.$implicit.label)})}function s(e){return M._19(0,[M._16(402653184,1,{navBar:0}),(e()(),M.Z(1,0,null,null,10,"ion-header",[],null,null,null,null,null)),M.Y(2,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(4,0,null,null,6,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Oe.b,Oe.a)),M.Y(5,49152,[[1,4]],0,De.a,[Te.a,[2,Ce.a],[2,Se.a],Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(7,0,null,3,2,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(8,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      设置\n    "])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n"])),(e()(),M.Z(13,0,null,null,251,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(14,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(16,0,null,1,247,"ion-list",[],null,null,null,null,null)),M.Y(17,16384,null,0,Ze.a,[Ee.a,M.j,M.z,Re.a,Pe.l,ke.a],null,null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(19,0,null,null,13,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(20,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,2,{contentLabel:0}),M._16(603979776,3,{_buttons:1}),M._16(603979776,4,{_icons:1}),M.Y(24,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(26,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(27,16384,[[2,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["用户ID"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(30,0,null,3,1,"ion-input",[["readonly",""],["type","text"]],null,null,null,Je.b,Je.a)),M.Y(31,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{value:[0,"value"],type:[1,"type"],readonly:[2,"readonly"]},null),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(34,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(35,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,5,{contentLabel:0}),M._16(603979776,6,{_buttons:1}),M._16(603979776,7,{_icons:1}),M.Y(39,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(41,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(42,16384,[[5,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["用户名"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(45,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.nickName=n)&&i}return i},Je.b,Je.a)),M.Y(46,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(48,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(49,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(56,0,null,null,43,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(57,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,8,{contentLabel:0}),M._16(603979776,9,{_buttons:1}),M._16(603979776,10,{_icons:1}),M.Y(61,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(63,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(64,16384,[[8,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["日志级别"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(67,0,null,3,31,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,68)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,68)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.logLevel=n)&&i}return i},Xe.b,Xe.a)),M.Y(68,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,11,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(71,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(73,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(75,0,null,null,2,"ion-option",[["value","0"]],null,null,null,null,null)),M.Y(76,16384,[[11,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["debug"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(79,0,null,null,2,"ion-option",[["selected","true"],["value","1"]],null,null,null,null,null)),M.Y(80,16384,[[11,4]],0,Ue.a,[M.j],{selected:[0,"selected"],value:[1,"value"]},null),(e()(),M._18(-1,null,["info"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(83,0,null,null,2,"ion-option",[["value","2"]],null,null,null,null,null)),M.Y(84,16384,[[11,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["warn"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(87,0,null,null,2,"ion-option",[["value","3"]],null,null,null,null,null)),M.Y(88,16384,[[11,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["error"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(91,0,null,null,2,"ion-option",[["value","98"]],null,null,null,null,null)),M.Y(92,16384,[[11,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["report"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(95,0,null,null,2,"ion-option",[["value","100"]],null,null,null,null,null)),M.Y(96,16384,[[11,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["disable"])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(109,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(110,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,12,{contentLabel:0}),M._16(603979776,13,{_buttons:1}),M._16(603979776,14,{_icons:1}),M.Y(114,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(116,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(117,16384,[[12,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["采集监听"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(120,0,null,4,5,"ion-toggle",[],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,121)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.muted=n)&&i}return i},et.b,et.a)),M.Y(121,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],null,null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(123,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(125,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(128,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(129,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,15,{contentLabel:0}),M._16(603979776,16,{_buttons:1}),M._16(603979776,17,{_icons:1}),M.Y(133,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(135,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(136,16384,[[15,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["麦克风"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(139,0,null,4,5,"ion-toggle",[],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,140)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.audio=n)&&i}return i},et.b,et.a)),M.Y(140,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],null,null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(142,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(144,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(147,0,null,null,22,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(148,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,18,{contentLabel:0}),M._16(603979776,19,{_buttons:1}),M._16(603979776,20,{_icons:1}),M.Y(152,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(154,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(155,16384,[[18,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["音频设备"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(158,0,null,3,10,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,159)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,159)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.audioInput=n)&&i}return i},Xe.b,Xe.a)),M.Y(159,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,21,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(162,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(164,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.U(16777216,null,null,1,null,r)),M.Y(167,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"]},null),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(171,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(172,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,22,{contentLabel:0}),M._16(603979776,23,{_buttons:1}),M._16(603979776,24,{_icons:1}),M.Y(176,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(178,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(179,16384,[[22,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["摄像头"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(182,0,null,4,5,"ion-toggle",[],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,183)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.video=n)&&i}return i},et.b,et.a)),M.Y(183,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],null,null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(185,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(187,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(190,0,null,null,22,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(191,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,25,{contentLabel:0}),M._16(603979776,26,{_buttons:1}),M._16(603979776,27,{_icons:1}),M.Y(195,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(197,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(198,16384,[[25,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["视频设备"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(201,0,null,3,10,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,202)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,202)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.videoInput=n)&&i}return i},Xe.b,Xe.a)),M.Y(202,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,28,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(205,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(207,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.U(16777216,null,null,1,null,l)),M.Y(210,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"]},null),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(214,0,null,null,32,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(215,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,29,{contentLabel:0}),M._16(603979776,30,{_buttons:1}),M._16(603979776,31,{_icons:1}),M.Y(219,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(221,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(222,16384,[[29,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["视频质量"])),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(225,0,null,3,20,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,226)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,226)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.videoQuality=n)&&i}return i},Xe.b,Xe.a)),M.Y(226,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,32,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(229,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(231,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(233,0,null,null,2,"ion-option",[["value","1"]],null,null,null,null,null)),M.Y(234,16384,[[32,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["标清"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(237,0,null,null,2,"ion-option",[["value","2"]],null,null,null,null,null)),M.Y(238,16384,[[32,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["高清"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(241,0,null,null,2,"ion-option",[["value","3"]],null,null,null,null,null)),M.Y(242,16384,[[32,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["超清"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(252,0,null,null,10,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(253,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,33,{contentLabel:0}),M._16(603979776,34,{_buttons:1}),M._16(603979776,35,{_icons:1}),M.Y(257,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(259,0,null,2,2,"button",[["full",""],["ion-button",""],["large",""],["round",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.showConfirm()&&i}return i},rt.b,rt.a)),M.Y(260,1097728,[[34,4]],0,lt.a,[[8,""],Ee.a,M.j,M.z],{large:[0,"large"],round:[1,"round"],full:[2,"full"]},null),(e()(),M._18(-1,0,["确定"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M._18(-1,null,["\n  "])),(e()(),M._18(-1,1,["\n\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,31,0,n.idName,"text","");e(t,46,0,n.nickName);e(t,49,0,"text");e(t,68,0,"取消","确定","false");e(t,71,0,n.logLevel);e(t,76,0,"0");e(t,80,0,"true","1");e(t,84,0,"2");e(t,88,0,"3");e(t,92,0,"98");e(t,96,0,"100");e(t,123,0,n.muted);e(t,142,0,n.audio);e(t,159,0,"取消","确定","false");e(t,162,0,n.audioInput);e(t,167,0,n.audioInputList);e(t,185,0,n.video);e(t,202,0,"取消","确定","false");e(t,205,0,n.videoInput);e(t,210,0,n.videoInputList);e(t,226,0,"取消","确定","false");e(t,229,0,n.videoQuality);e(t,234,0,"1");e(t,238,0,"2");e(t,242,0,"3");e(t,260,0,"","","")},function(e,t){e(t,4,0,M._13(t,5)._hidden,M._13(t,5)._sbPadding);e(t,13,0,M._13(t,14).statusbarPadding,M._13(t,14)._hasRefresher);e(t,45,0,M._13(t,48).ngClassUntouched,M._13(t,48).ngClassTouched,M._13(t,48).ngClassPristine,M._13(t,48).ngClassDirty,M._13(t,48).ngClassValid,M._13(t,48).ngClassInvalid,M._13(t,48).ngClassPending);e(t,67,0,M._13(t,68)._disabled,M._13(t,73).ngClassUntouched,M._13(t,73).ngClassTouched,M._13(t,73).ngClassPristine,M._13(t,73).ngClassDirty,M._13(t,73).ngClassValid,M._13(t,73).ngClassInvalid,M._13(t,73).ngClassPending);e(t,120,0,M._13(t,121)._disabled,M._13(t,121)._value,M._13(t,121)._activated,M._13(t,125).ngClassUntouched,M._13(t,125).ngClassTouched,M._13(t,125).ngClassPristine,M._13(t,125).ngClassDirty,M._13(t,125).ngClassValid,M._13(t,125).ngClassInvalid,M._13(t,125).ngClassPending);e(t,139,0,M._13(t,140)._disabled,M._13(t,140)._value,M._13(t,140)._activated,M._13(t,144).ngClassUntouched,M._13(t,144).ngClassTouched,M._13(t,144).ngClassPristine,M._13(t,144).ngClassDirty,M._13(t,144).ngClassValid,M._13(t,144).ngClassInvalid,M._13(t,144).ngClassPending);e(t,158,0,M._13(t,159)._disabled,M._13(t,164).ngClassUntouched,M._13(t,164).ngClassTouched,M._13(t,164).ngClassPristine,M._13(t,164).ngClassDirty,M._13(t,164).ngClassValid,M._13(t,164).ngClassInvalid,M._13(t,164).ngClassPending);e(t,182,0,M._13(t,183)._disabled,M._13(t,183)._value,M._13(t,183)._activated,M._13(t,187).ngClassUntouched,M._13(t,187).ngClassTouched,M._13(t,187).ngClassPristine,M._13(t,187).ngClassDirty,M._13(t,187).ngClassValid,M._13(t,187).ngClassInvalid,M._13(t,187).ngClassPending);e(t,201,0,M._13(t,202)._disabled,M._13(t,207).ngClassUntouched,M._13(t,207).ngClassTouched,M._13(t,207).ngClassPristine,M._13(t,207).ngClassDirty,M._13(t,207).ngClassValid,M._13(t,207).ngClassInvalid,M._13(t,207).ngClassPending);e(t,225,0,M._13(t,226)._disabled,M._13(t,231).ngClassUntouched,M._13(t,231).ngClassTouched,M._13(t,231).ngClassPristine,M._13(t,231).ngClassDirty,M._13(t,231).ngClassValid,M._13(t,231).ngClassInvalid,M._13(t,231).ngClassPending)})}function o(e){return M._19(0,[(e()(),M.Z(0,0,null,null,35,"ion-header",[],null,null,null,null,null)),M.Y(1,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(3,0,null,null,31,"ion-toolbar",[["class","toolbar"],["color","primary"]],[[2,"statusbar-padding",null]],null,null,ut.b,ut.a)),M.Y(4,49152,null,0,xe.a,[Ee.a,M.j,M.z],{color:[0,"color"]},null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(6,0,null,3,27,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(7,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      "])),(e()(),M.Z(9,0,null,0,23,"ion-grid",[["class","grid"]],null,null,null,null,null)),M.Y(10,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(12,0,null,null,19,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(13,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(15,0,null,null,1,"ion-col",[["class","col"],["col-4",""]],null,null,null,null,null)),M.Y(16,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(18,0,null,null,3,"ion-col",[["class","col"],["col-4",""],["style","text-align: center"]],null,null,null,null,null)),M.Y(19,16384,null,0,ht.a,[],null,null),(e()(),M.Z(20,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),M._18(-1,null,["VideoTalk"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(23,0,null,null,2,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),M.Y(24,16384,null,0,ht.a,[],null,null),(e()(),M.Z(25,0,null,null,0,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(27,0,null,null,3,"ion-col",[["class","setting col"],["col-2",""]],null,[[null,"click"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==(r.isSupport&&r.openSetting())&&i}return i},null,null)),M.Y(28,16384,null,0,ht.a,[],null,null),(e()(),M.Z(29,0,null,null,1,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,["设置"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,0,["\n    "])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n\n"])),(e()(),M.Z(37,0,null,null,39,"ion-content",[["padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(38,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(40,0,null,1,16,"ion-item",[["class","roomId item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(41,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,1,{contentLabel:0}),M._16(603979776,2,{_buttons:1}),M._16(603979776,3,{_icons:1}),M.Y(45,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(47,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(48,16384,[[1,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["请输入会话ID"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(51,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.roomId=n)&&i}return i},Je.b,Je.a)),M.Y(52,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(54,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(55,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(58,0,null,1,17,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(59,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(61,0,null,null,1,"ion-col",[["class","col"],["col-4",""]],null,null,null,null,null)),M.Y(62,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(64,0,null,null,6,"ion-col",[["class","col"],["col-4",""],["style","text-align: center"]],null,null,null,null,null)),M.Y(65,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n       "])),(e()(),M.Z(67,0,null,null,2,"button",[["ion-button",""],["margin-top",""],["tappable",""]],null,[[null,"click"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==(r.isSupport&&r.openRoom())&&i}return i},rt.b,rt.a)),M.Y(68,1097728,null,0,lt.a,[[8,""],Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["开始视频通话"])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(72,0,null,null,2,"ion-col",[["class","col"],["col-4",""]],null,null,null,null,null)),M.Y(73,16384,null,0,ht.a,[],null,null),(e()(),M.Z(74,0,null,null,0,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,["\n  "])),(e()(),M._18(-1,1,["\n\n\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,4,0,"primary");e(t,52,0,n.roomId);e(t,55,0,"text")},function(e,t){e(t,3,0,M._13(t,4)._sbPadding);e(t,37,0,M._13(t,38).statusbarPadding,M._13(t,38)._hasRefresher);e(t,51,0,M._13(t,54).ngClassUntouched,M._13(t,54).ngClassTouched,M._13(t,54).ngClassPristine,M._13(t,54).ngClassDirty,M._13(t,54).ngClassValid,M._13(t,54).ngClassInvalid,M._13(t,54).ngClassPending)})}function a(e){return M._19(0,[(e()(),M.Z(0,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(1,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n            "])),(e()(),M.Z(3,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(4,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(5,null,["",""])),(e()(),M._18(-1,null,["\n          "]))],function(e,t){e(t,4,0,"secondary")},function(e,t){e(t,5,0,t.parent.context.$implicit.stream_id)})}function u(e){return M._19(0,[(e()(),M.Z(0,0,[[2,0],["subVideo",1]],null,1,"video",[["autoplay",""],["playsinline",""]],[[8,"id",0]],null,null,null,null)),(e()(),M._18(-1,null,["\n            您的浏览器不支持 video 标签。\n          "]))],null,function(e,t){e(t,0,0,M._2(1,"",t.parent.context.$implicit.stream_id,""))})}function c(e){return M._19(0,[(e()(),M.Z(0,0,null,null,8,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(1,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,a)),M.Y(4,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,u)),M.Y(7,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n        "]))],function(e,t){e(t,4,0,t.context.index<3);e(t,7,0,t.context.index<3)},null)}function d(e){return M._19(0,[M._16(402653184,1,{localVideo:0}),M._16(671088640,2,{subVideoList:1}),(e()(),M.Z(2,0,null,null,89,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(3,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(5,0,null,1,59,"ion-grid",[["class","topRow grid"]],null,null,null,null,null)),M.Y(6,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(8,0,null,null,55,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(9,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(11,0,null,null,33,"ion-col",[["class","col col"],["col-8",""]],null,null,null,null,null)),M.Y(12,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(14,0,null,null,6,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleCam()&&i}return i},vt.b,vt.a)),M.Y(15,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(17,0,null,0,2,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(18,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(22,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleMic()&&i}return i},vt.b,vt.a)),M.Y(23,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(25,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(26,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(29,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleVolume()&&i}return i},vt.b,vt.a)),M.Y(30,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n        "])),(e()(),M.Z(32,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(33,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(36,0,null,null,7,"button",[["class","fab-in-list show"],["ion-fab",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.changeUseCam()&&i}return i},vt.b,vt.a)),M.Y(37,278528,null,0,it.g,[M.p,M.q,M.j,M.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),M._14(38,{cannotToggleCam:0}),M.Y(39,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(41,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(42,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(46,0,null,null,16,"ion-col",[["class","col col"],["col-4",""]],null,null,null,null,null)),M.Y(47,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(49,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.showLogs()&&i}return i},vt.b,vt.a)),M.Y(50,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n                    "])),(e()(),M.Z(52,0,null,0,1,"span",[["class","button-inner"]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n                        日志\n                    "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(56,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.logoutRoom()&&i}return i},vt.b,vt.a)),M.Y(57,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(59,0,null,0,1,"ion-icon",[["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(60,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(66,0,null,1,23,"ion-grid",[["class","subVideo grid"]],null,null,null,null,null)),M.Y(67,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(69,0,null,null,19,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(70,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(72,0,null,null,12,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(73,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(75,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(76,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(78,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(79,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(80,null,["",""])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(83,0,[[1,0],["localVideo",1]],null,0,"video",[["autoplay",""],["muted",""],["playsinline",""]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n\n\n        "])),(e()(),M.U(16777216,null,null,1,null,c)),M.Y(87,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n"])),(e()(),M._18(-1,null,["\n\n\n"]))],function(e,t){var n=t.component;e(t,18,0,n.offOnCam);e(t,26,0,n.offOnMic);e(t,33,0,n.offOnVolume);e(t,37,0,"fab-in-list show",e(t,38,0,!n.isSuportMultipCam));e(t,42,0,n.changeCam);e(t,60,0,"close");e(t,79,0,"secondary");e(t,87,0,n.useLocalStreamList,n.identify)},function(e,t){var n=t.component;e(t,2,0,M._13(t,3).statusbarPadding,M._13(t,3)._hasRefresher);e(t,17,0,M._13(t,18)._hidden);e(t,25,0,M._13(t,26)._hidden);e(t,32,0,M._13(t,33)._hidden);e(t,36,0,!n.isSuportMultipCam);e(t,41,0,M._13(t,42)._hidden);e(t,59,0,M._13(t,60)._hidden);e(t,80,0,"me:"+n.publishStreamId)})}function h(e){return M._19(0,[(e()(),M.Z(0,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(1,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n            "])),(e()(),M.Z(3,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(4,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(5,null,["","(",")"])),(e()(),M._18(-1,null,["\n          "]))],function(e,t){e(t,4,0,"secondary")},function(e,t){e(t,5,0,t.parent.context.$implicit.stream_id,t.component.status["pull"+t.parent.context.$implicit.stream_id])})}function p(e){return M._19(0,[(e()(),M.Z(0,0,[[2,0],["subVideo",1]],null,1,"video",[["autoplay",""],["playsinline",""]],[[8,"id",0]],null,null,null,null)),(e()(),M._18(-1,null,["\n            您的浏览器不支持 video 标签。\n          "]))],null,function(e,t){e(t,0,0,M._2(1,"",t.parent.context.$implicit.stream_id,""))})}function g(e){return M._19(0,[(e()(),M.Z(0,0,null,null,8,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(1,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,h)),M.Y(4,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,p)),M.Y(7,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n        "]))],function(e,t){e(t,4,0,t.context.index<3);e(t,7,0,t.context.index<3)},null)}function f(e){return M._19(0,[M._16(402653184,1,{localVideo:0}),M._16(671088640,2,{subVideoList:1}),(e()(),M.Z(2,0,null,null,93,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(3,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(5,0,null,1,63,"ion-grid",[["class","topRow grid"]],null,null,null,null,null)),M.Y(6,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(8,0,null,null,59,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(9,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(11,0,null,null,37,"ion-col",[["class","col col"],["col-8",""]],null,null,null,null,null)),M.Y(12,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(14,0,null,null,6,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleCam()&&i}return i},vt.b,vt.a)),M.Y(15,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(17,0,null,0,2,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(18,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(22,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleMic()&&i}return i},vt.b,vt.a)),M.Y(23,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(25,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(26,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(29,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleVolume()&&i}return i},vt.b,vt.a)),M.Y(30,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n        "])),(e()(),M.Z(32,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(33,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(36,0,null,null,7,"button",[["class","fab-in-list show"],["ion-fab",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.changeUseCam()&&i}return i},vt.b,vt.a)),M.Y(37,278528,null,0,it.g,[M.p,M.q,M.j,M.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),M._14(38,{cannotToggleCam:0}),M.Y(39,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(41,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(42,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(45,0,null,null,2,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.togglePullStream()&&i}return i},vt.b,vt.a)),M.Y(46,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          切拉流\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(50,0,null,null,16,"ion-col",[["class","col col"],["col-4",""]],null,null,null,null,null)),M.Y(51,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(53,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.showLogs()&&i}return i},vt.b,vt.a)),M.Y(54,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n                    "])),(e()(),M.Z(56,0,null,0,1,"span",[["class","button-inner"]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n                        日志\n                    "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(60,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.logoutRoom()&&i}return i},vt.b,vt.a)),M.Y(61,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(63,0,null,0,1,"ion-icon",[["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(64,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n\n\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(70,0,null,1,23,"ion-grid",[["class","subVideo grid"]],null,null,null,null,null)),M.Y(71,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(73,0,null,null,19,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(74,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(76,0,null,null,12,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(77,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(79,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(80,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(82,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(83,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(84,null,["","(",")"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(87,0,[[1,0],["localVideo",1]],null,0,"video",[["autoplay",""],["muted",""],["playsinline",""]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n\n\n        "])),(e()(),M.U(16777216,null,null,1,null,g)),M.Y(91,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n"])),(e()(),M._18(-1,null,["\n\n\n"]))],function(e,t){var n=t.component;e(t,18,0,n.offOnCam);e(t,26,0,n.offOnMic);e(t,33,0,n.offOnVolume);e(t,37,0,"fab-in-list show",e(t,38,0,!n.isSuportMultipCam));e(t,42,0,n.changeCam);e(t,64,0,"close");e(t,83,0,"secondary");e(t,91,0,n.useLocalStreamList,n.identify)},function(e,t){var n=t.component;e(t,2,0,M._13(t,3).statusbarPadding,M._13(t,3)._hasRefresher);e(t,17,0,M._13(t,18)._hidden);e(t,25,0,M._13(t,26)._hidden);e(t,32,0,M._13(t,33)._hidden);e(t,36,0,!n.isSuportMultipCam);e(t,41,0,M._13(t,42)._hidden);e(t,63,0,M._13(t,64)._hidden);e(t,84,0,"me:"+n.publishStreamId,n.status["push"+n.publishStreamId])})}function m(e){return M._19(0,[(e()(),M.Z(0,0,null,null,2,"ion-option",[],null,null,null,null,null)),M.Y(1,16384,[[5,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(2,null,["",""]))],function(e,t){e(t,1,0,t.context.$implicit)},function(e,t){e(t,2,0,t.context.$implicit)})}function v(e){return M._19(0,[(e()(),M.Z(0,0,null,null,10,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(1,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,6,{contentLabel:0}),M._16(603979776,7,{_buttons:1}),M._16(603979776,8,{_icons:1}),M.Y(5,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M.Z(7,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(8,16384,[[6,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(9,null,["",""])),(e()(),M._18(-1,2,["\n    "]))],null,function(e,t){e(t,9,0,t.context.$implicit)})}function _(e){return M._19(0,[(e()(),M.Z(0,0,null,null,75,"ion-header",[],null,null,null,null,null)),M.Y(1,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(3,0,null,null,10,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Oe.b,Oe.a)),M.Y(4,49152,null,0,De.a,[Te.a,[2,Ce.a],[2,Se.a],Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(6,0,null,3,2,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(7,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      日志\n    "])),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(10,0,null,3,2,"button",[["float-end",""],["ion-fab",""],["mini",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleRefresh()&&i}return i},vt.b,vt.a)),M.Y(11,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(12,0,[" ",""])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(15,0,null,null,59,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(16,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,1,{contentLabel:0}),M._16(603979776,2,{_buttons:1}),M._16(603979776,3,{_icons:1}),M.Y(20,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n\n    "])),(e()(),M.Z(22,0,null,1,6,"ion-label",[],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.showPrompt()&&i}return i},null,null)),M.Y(23,16384,[[1,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(25,0,null,null,2,"button",[["color","light"],["ion-button",""]],null,null,null,rt.b,rt.a)),M.Y(26,1097728,null,0,lt.a,[[8,""],Ee.a,M.j,M.z],{color:[0,"color"]},null),(e()(),M._18(27,0,["自定义过滤-",""])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,2,["\n\n    "])),(e()(),M.Z(30,0,null,3,23,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,31)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,31)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.levelID=n)&&i}return i},Xe.b,Xe.a)),M.Y(31,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,4,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(34,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(36,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(38,0,null,null,2,"ion-option",[["value","debug"]],null,null,null,null,null)),M.Y(39,16384,[[4,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["debug"])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(42,0,null,null,2,"ion-option",[["value","info"]],null,null,null,null,null)),M.Y(43,16384,[[4,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["info"])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(46,0,null,null,2,"ion-option",[["value","warning"]],null,null,null,null,null)),M.Y(47,16384,[[4,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["warnings"])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(50,0,null,null,2,"ion-option",[["value","errors"]],null,null,null,null,null)),M.Y(51,16384,[[4,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["errors"])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,2,["\n\n    "])),(e()(),M.Z(55,0,null,3,18,"ion-select",[["cancelText","取消"],["multiple","false"],["okText","确定"]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==M._13(e,56)._click(n)&&i}if("keyup.space"===t){i=!1!==M._13(e,56)._keyup()&&i}if("ngModelChange"===t){i=!1!==(r.typeID=n)&&i}return i},Xe.b,Xe.a)),M.Y(56,1228800,null,1,$e.a,[Te.a,Be.a,Ee.a,M.j,M.z,[2,He.a],Le.a],{cancelText:[0,"cancelText"],okText:[1,"okText"],multiple:[2,"multiple"]},null),M._16(603979776,5,{options:1}),M._15(1024,null,Ke.e,function(e){return[e]},[$e.a]),M.Y(59,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(61,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(63,0,null,null,2,"ion-option",[["value",""]],null,null,null,null,null)),M.Y(64,16384,[[5,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["全部"])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.U(16777216,null,null,1,null,m)),M.Y(68,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"]},null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(70,0,null,null,2,"ion-option",[["value","###"]],null,null,null,null,null)),M.Y(71,16384,[[5,4]],0,Ue.a,[M.j],{value:[0,"value"]},null),(e()(),M._18(-1,null,["其他"])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,2,["\n\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n"])),(e()(),M.Z(77,0,null,null,9,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(78,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(80,0,null,1,5,"ion-list",[],null,null,null,null,null)),M.Y(81,16384,null,0,Ze.a,[Ee.a,M.j,M.z,Re.a,Pe.l,ke.a],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.U(16777216,null,null,1,null,v)),M.Y(84,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),M._18(-1,null,["\n  "])),(e()(),M._18(-1,1,["\n\n"])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,26,0,"light");e(t,31,0,"取消","确定","false");e(t,34,0,n.levelID);e(t,39,0,"debug");e(t,43,0,"info");e(t,47,0,"warning");e(t,51,0,"errors");e(t,56,0,"取消","确定","false");e(t,59,0,n.typeID);e(t,64,0,"");e(t,68,0,n.typeArray);e(t,71,0,"###");e(t,84,0,n.logArray,n.item)},function(e,t){var n=t.component;e(t,3,0,M._13(t,4)._hidden,M._13(t,4)._sbPadding);e(t,12,0,n.refreshStatus);e(t,27,0,n._customerKey);e(t,30,0,M._13(t,31)._disabled,M._13(t,36).ngClassUntouched,M._13(t,36).ngClassTouched,M._13(t,36).ngClassPristine,M._13(t,36).ngClassDirty,M._13(t,36).ngClassValid,M._13(t,36).ngClassInvalid,M._13(t,36).ngClassPending);e(t,55,0,M._13(t,56)._disabled,M._13(t,61).ngClassUntouched,M._13(t,61).ngClassTouched,M._13(t,61).ngClassPristine,M._13(t,61).ngClassDirty,M._13(t,61).ngClassValid,M._13(t,61).ngClassInvalid,M._13(t,61).ngClassPending);e(t,77,0,M._13(t,78).statusbarPadding,M._13(t,78)._hasRefresher)})}function b(e){return M._19(0,[(e()(),M.Z(0,0,null,null,36,"ion-header",[],null,null,null,null,null)),M.Y(1,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(3,0,null,null,32,"ion-toolbar",[["class","toolbar"],["color","primary"]],[[2,"statusbar-padding",null]],null,null,ut.b,ut.a)),M.Y(4,49152,null,0,xe.a,[Ee.a,M.j,M.z],{color:[0,"color"]},null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(6,0,null,3,28,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(7,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      "])),(e()(),M.Z(9,0,null,0,24,"ion-grid",[["class","grid"]],null,null,null,null,null)),M.Y(10,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(12,0,null,null,20,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(13,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(15,0,null,null,1,"ion-col",[["class","col"],["col-4",""]],null,null,null,null,null)),M.Y(16,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(18,0,null,null,3,"ion-col",[["class","col"],["col-4",""],["style","text-align: center"]],null,null,null,null,null)),M.Y(19,16384,null,0,ht.a,[],null,null),(e()(),M.Z(20,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),M._18(-1,null,["VideoTalk"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(23,0,null,null,3,"ion-col",[["class","col"],["col-2",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.openHistory()&&i}return i},null,null)),M.Y(24,16384,null,0,ht.a,[],null,null),(e()(),M.Z(25,0,null,null,1,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,["版本更新详细"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(28,0,null,null,3,"ion-col",[["class","setting col"],["col-2",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.openSetting()&&i}return i},null,null)),M.Y(29,16384,null,0,ht.a,[],null,null),(e()(),M.Z(30,0,null,null,1,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,["设置"])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,0,["\n    "])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n\n"])),(e()(),M.Z(38,0,null,null,249,"ion-content",[["padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(39,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(41,0,null,1,16,"ion-item",[["class","roomId item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(42,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,1,{contentLabel:0}),M._16(603979776,2,{_buttons:1}),M._16(603979776,3,{_icons:1}),M.Y(46,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(48,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(49,16384,[[1,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["请输入房间号"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(52,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.roomId=n)&&i}return i},Je.b,Je.a)),M.Y(53,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(55,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(56,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n\n  "])),(e()(),M.Z(59,0,null,1,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(60,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,4,{contentLabel:0}),M._16(603979776,5,{_buttons:1}),M._16(603979776,6,{_icons:1}),M.Y(64,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(66,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(67,16384,[[4,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["请输入signUrl"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(70,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.signUrl=n)&&i}return i},Je.b,Je.a)),M.Y(71,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(73,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(74,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n\n\n  "])),(e()(),M.Z(81,0,null,1,85,"ion-card",[],null,null,null,null,null)),M.Y(82,16384,null,0,It.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(84,0,null,null,2,"ion-card-header",[],null,null,null,null,null)),M.Y(85,16384,null,0,Lt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      推流\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(88,0,null,null,77,"ion-card-content",[],null,null,null,null,null)),M.Y(89,16384,null,0,kt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(91,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(92,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,7,{contentLabel:0}),M._16(603979776,8,{_buttons:1}),M._16(603979776,9,{_icons:1}),M.Y(96,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(98,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(99,16384,[[7,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["是否推流"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(102,0,null,4,5,"ion-toggle",[["checked","true"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,103)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.isPublish=n)&&i}return i},et.b,et.a)),M.Y(103,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(105,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(107,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(110,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(111,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,10,{contentLabel:0}),M._16(603979776,11,{_buttons:1}),M._16(603979776,12,{_icons:1}),M.Y(115,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(117,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(118,16384,[[10,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["是否推音频"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(121,0,null,4,5,"ion-toggle",[["checked","true"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,122)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.isPublishAudio=n)&&i}return i},et.b,et.a)),M.Y(122,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(124,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(126,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n\n      "])),(e()(),M.Z(129,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(130,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,13,{contentLabel:0}),M._16(603979776,14,{_buttons:1}),M._16(603979776,15,{_icons:1}),M.Y(134,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(136,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(137,16384,[[13,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["是否推视频"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(140,0,null,4,5,"ion-toggle",[["checked","true"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,141)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.isPublishVideo=n)&&i}return i},et.b,et.a)),M.Y(141,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(143,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(145,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(148,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(149,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,16,{contentLabel:0}),M._16(603979776,17,{_buttons:1}),M._16(603979776,18,{_icons:1}),M.Y(153,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(155,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(156,16384,[[16,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["推流ID"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(159,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.streamId=n)&&i}return i},Je.b,Je.a)),M.Y(160,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(162,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(163,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n\n\n  "])),(e()(),M.Z(168,0,null,1,66,"ion-card",[],null,null,null,null,null)),M.Y(169,16384,null,0,It.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(171,0,null,null,2,"ion-card-header",[],null,null,null,null,null)),M.Y(172,16384,null,0,Lt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      拉流\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(175,0,null,null,58,"ion-card-content",[],null,null,null,null,null)),M.Y(176,16384,null,0,kt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(178,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(179,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,19,{contentLabel:0}),M._16(603979776,20,{_buttons:1}),M._16(603979776,21,{_icons:1}),M.Y(183,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(185,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(186,16384,[[19,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["是否拉音频"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(189,0,null,4,5,"ion-toggle",[["checked","true"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,190)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.isPullAudio=n)&&i}return i},et.b,et.a)),M.Y(190,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(192,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(194,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n\n      "])),(e()(),M.Z(197,0,null,null,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(198,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,22,{contentLabel:0}),M._16(603979776,23,{_buttons:1}),M._16(603979776,24,{_icons:1}),M.Y(202,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(204,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(205,16384,[[22,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["是否拉视频"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(208,0,null,4,5,"ion-toggle",[["checked","true"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,209)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.isPullVideo=n)&&i}return i},et.b,et.a)),M.Y(209,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(211,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(213,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n\n      "])),(e()(),M.Z(216,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(217,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,25,{contentLabel:0}),M._16(603979776,26,{_buttons:1}),M._16(603979776,27,{_icons:1}),M.Y(221,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(223,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(224,16384,[[25,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["拉流IDS(多个id请用','号隔开)"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(227,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.pullstreamId=n)&&i}return i},Je.b,Je.a)),M.Y(228,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(230,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(231,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(236,0,null,1,46,"ion-card",[],null,null,null,null,null)),M.Y(237,16384,null,0,It.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(239,0,null,null,2,"ion-card-header",[],null,null,null,null,null)),M.Y(240,16384,null,0,Lt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      鉴权\n    "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.Z(243,0,null,null,38,"ion-card-content",[],null,null,null,null,null)),M.Y(244,16384,null,0,kt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(246,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(247,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,28,{contentLabel:0}),M._16(603979776,29,{_buttons:1}),M._16(603979776,30,{_icons:1}),M.Y(251,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(253,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(254,16384,[[28,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["请输入鉴权token地址"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(257,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.authTokenUrl=n)&&i}return i},Je.b,Je.a)),M.Y(258,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(260,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(261,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(264,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(265,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,31,{contentLabel:0}),M._16(603979776,32,{_buttons:1}),M._16(603979776,33,{_icons:1}),M.Y(269,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(271,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(272,16384,[[31,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["请输入鉴权节点"])),(e()(),M._18(-1,2,["\n        "])),(e()(),M.Z(275,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.appNode=n)&&i}return i},Je.b,Je.a)),M.Y(276,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(278,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(279,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n      "])),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n\n\n  "])),(e()(),M.Z(284,0,null,1,2,"button",[["full",""],["ion-button",""],["margin-top",""],["tappable",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.openRoom()&&i}return i},rt.b,rt.a)),M.Y(285,1097728,null,0,lt.a,[[8,""],Ee.a,M.j,M.z],{full:[0,"full"]},null),(e()(),M._18(-1,0,["开始视频通话"])),(e()(),M._18(-1,1,["\n\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,4,0,"primary");e(t,53,0,n.roomId);e(t,56,0,"text");e(t,71,0,n.signUrl);e(t,74,0,"text");e(t,103,0,"true");e(t,105,0,n.isPublish);e(t,122,0,"true");e(t,124,0,n.isPublishAudio);e(t,141,0,"true");e(t,143,0,n.isPublishVideo);e(t,160,0,n.streamId);e(t,163,0,"text");e(t,190,0,"true");e(t,192,0,n.isPullAudio);e(t,209,0,"true");e(t,211,0,n.isPullVideo);e(t,228,0,n.pullstreamId);e(t,231,0,"text");e(t,258,0,n.authTokenUrl);e(t,261,0,"text");e(t,276,0,n.appNode);e(t,279,0,"text");e(t,285,0,"")},function(e,t){e(t,3,0,M._13(t,4)._sbPadding);e(t,38,0,M._13(t,39).statusbarPadding,M._13(t,39)._hasRefresher);e(t,52,0,M._13(t,55).ngClassUntouched,M._13(t,55).ngClassTouched,M._13(t,55).ngClassPristine,M._13(t,55).ngClassDirty,M._13(t,55).ngClassValid,M._13(t,55).ngClassInvalid,M._13(t,55).ngClassPending);e(t,70,0,M._13(t,73).ngClassUntouched,M._13(t,73).ngClassTouched,M._13(t,73).ngClassPristine,M._13(t,73).ngClassDirty,M._13(t,73).ngClassValid,M._13(t,73).ngClassInvalid,M._13(t,73).ngClassPending);e(t,102,0,M._13(t,103)._disabled,M._13(t,103)._value,M._13(t,103)._activated,M._13(t,107).ngClassUntouched,M._13(t,107).ngClassTouched,M._13(t,107).ngClassPristine,M._13(t,107).ngClassDirty,M._13(t,107).ngClassValid,M._13(t,107).ngClassInvalid,M._13(t,107).ngClassPending);e(t,121,0,M._13(t,122)._disabled,M._13(t,122)._value,M._13(t,122)._activated,M._13(t,126).ngClassUntouched,M._13(t,126).ngClassTouched,M._13(t,126).ngClassPristine,M._13(t,126).ngClassDirty,M._13(t,126).ngClassValid,M._13(t,126).ngClassInvalid,M._13(t,126).ngClassPending);e(t,140,0,M._13(t,141)._disabled,M._13(t,141)._value,M._13(t,141)._activated,M._13(t,145).ngClassUntouched,M._13(t,145).ngClassTouched,M._13(t,145).ngClassPristine,M._13(t,145).ngClassDirty,M._13(t,145).ngClassValid,M._13(t,145).ngClassInvalid,M._13(t,145).ngClassPending);e(t,159,0,M._13(t,162).ngClassUntouched,M._13(t,162).ngClassTouched,M._13(t,162).ngClassPristine,M._13(t,162).ngClassDirty,M._13(t,162).ngClassValid,M._13(t,162).ngClassInvalid,M._13(t,162).ngClassPending);e(t,189,0,M._13(t,190)._disabled,M._13(t,190)._value,M._13(t,190)._activated,M._13(t,194).ngClassUntouched,M._13(t,194).ngClassTouched,M._13(t,194).ngClassPristine,M._13(t,194).ngClassDirty,M._13(t,194).ngClassValid,M._13(t,194).ngClassInvalid,M._13(t,194).ngClassPending);e(t,208,0,M._13(t,209)._disabled,M._13(t,209)._value,M._13(t,209)._activated,M._13(t,213).ngClassUntouched,M._13(t,213).ngClassTouched,M._13(t,213).ngClassPristine,M._13(t,213).ngClassDirty,M._13(t,213).ngClassValid,M._13(t,213).ngClassInvalid,M._13(t,213).ngClassPending);e(t,227,0,M._13(t,230).ngClassUntouched,M._13(t,230).ngClassTouched,M._13(t,230).ngClassPristine,M._13(t,230).ngClassDirty,M._13(t,230).ngClassValid,M._13(t,230).ngClassInvalid,M._13(t,230).ngClassPending);e(t,257,0,M._13(t,260).ngClassUntouched,M._13(t,260).ngClassTouched,M._13(t,260).ngClassPristine,M._13(t,260).ngClassDirty,M._13(t,260).ngClassValid,M._13(t,260).ngClassInvalid,M._13(t,260).ngClassPending);e(t,275,0,M._13(t,278).ngClassUntouched,M._13(t,278).ngClassTouched,M._13(t,278).ngClassPristine,M._13(t,278).ngClassDirty,M._13(t,278).ngClassValid,M._13(t,278).ngClassInvalid,M._13(t,278).ngClassPending)})}function y(e){return M._19(0,[(e()(),M.Z(0,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(1,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n            "])),(e()(),M.Z(3,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(4,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(5,null,["",""])),(e()(),M._18(-1,null,["\n          "]))],function(e,t){e(t,4,0,"secondary")},function(e,t){e(t,5,0,t.parent.context.$implicit.stream_id)})}function C(e){return M._19(0,[(e()(),M.Z(0,0,[[3,0],["subVideo",1]],null,1,"video",[["autoplay",""],["muted",""],["playsinline",""]],[[8,"id",0]],null,null,null,null)),(e()(),M._18(-1,null,["\n            您的浏览器不支持 video 标签。\n          "]))],null,function(e,t){e(t,0,0,M._2(1,"",t.parent.context.$implicit.stream_id,""))})}function S(e){return M._19(0,[(e()(),M.Z(0,0,null,null,8,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(1,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,y)),M.Y(4,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.U(16777216,null,null,1,null,C)),M.Y(7,16384,null,0,it.i,[M.I,M.F],{ngIf:[0,"ngIf"]},null),(e()(),M._18(-1,null,["\n        "]))],function(e,t){e(t,4,0,t.context.index<3);e(t,7,0,t.context.index<3)},null)}function T(e){return M._19(0,[M._16(402653184,1,{localVideo1:0}),M._16(402653184,2,{localVideo2:0}),M._16(671088640,3,{subVideoList:1}),(e()(),M.Z(3,0,null,null,103,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(4,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(6,0,null,1,59,"ion-grid",[["class","topRow grid"]],null,null,null,null,null)),M.Y(7,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(9,0,null,null,55,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(10,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(12,0,null,null,33,"ion-col",[["class","col col"],["col-8",""]],null,null,null,null,null)),M.Y(13,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(15,0,null,null,6,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleCam()&&i}return i},vt.b,vt.a)),M.Y(16,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(18,0,null,0,2,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(19,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(23,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleMic()&&i}return i},vt.b,vt.a)),M.Y(24,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(26,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(27,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(30,0,null,null,5,"button",[["class","fab-in-list show"],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.toggleVolume()&&i}return i},vt.b,vt.a)),M.Y(31,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n        "])),(e()(),M.Z(33,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(34,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(37,0,null,null,7,"button",[["class","fab-in-list show"],["ion-fab",""]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.changeUseCam()&&i}return i},vt.b,vt.a)),M.Y(38,278528,null,0,it.g,[M.p,M.q,M.j,M.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),M._14(39,{cannotToggleCam:0}),M.Y(40,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(42,0,null,0,1,"ion-icon",[["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(43,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(47,0,null,null,16,"ion-col",[["class","col col"],["col-4",""]],null,null,null,null,null)),M.Y(48,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(50,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.showLogs()&&i}return i},vt.b,vt.a)),M.Y(51,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n                    "])),(e()(),M.Z(53,0,null,0,1,"span",[["class","button-inner"]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n                        日志\n                    "])),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(57,0,null,null,5,"button",[["class","fab-in-list show"],["float-start",""],["ion-fab",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.logoutRoom()&&i}return i},vt.b,vt.a)),M.Y(58,49152,null,0,_t.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M.Z(60,0,null,0,1,"ion-icon",[["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),M.Y(61,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),(e()(),M._18(-1,0,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(67,0,null,1,37,"ion-grid",[["class","subVideo grid"]],null,null,null,null,null)),M.Y(68,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(70,0,null,null,33,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(71,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(73,0,null,null,12,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(74,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(76,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(77,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(79,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(80,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(81,null,["",""])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(84,0,[[1,0],["localVideo1",1]],null,0,"video",[["autoplay",""],["muted",""],["playsinline",""]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n\n      "])),(e()(),M.Z(87,0,null,null,12,"ion-col",[["class","col"],["col-sm-4",""]],null,null,null,null,null)),M.Y(88,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(90,0,null,null,6,"ion-chip",[],null,null,null,null,null)),M.Y(91,16384,null,0,mt.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(93,0,null,null,2,"ion-label",[["color","secondary"]],null,null,null,null,null)),M.Y(94,16384,null,0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],{color:[0,"color"]},null),(e()(),M._18(95,null,["",""])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(98,0,[[2,0],["localVideo2",1]],null,0,"video",[["autoplay",""],["muted",""],["playsinline",""]],null,null,null,null,null)),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,null,["\n\n\n        "])),(e()(),M.U(16777216,null,null,1,null,S)),M.Y(102,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n  "])),(e()(),M._18(-1,1,["\n"])),(e()(),M._18(-1,null,["\n\n"])),(e()(),M.Z(108,0,null,null,9,"ion-list",[],null,null,null,null,null)),M.Y(109,16384,null,0,Ze.a,[Ee.a,M.j,M.z,Re.a,Pe.l,ke.a],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(111,0,null,null,5,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(112,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,4,{contentLabel:0}),M._16(603979776,5,{_buttons:1}),M._16(603979776,6,{_icons:1}),M.Y(116,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,19,0,n.offOnCam);e(t,27,0,n.offOnMic);e(t,34,0,n.offOnVolume);e(t,38,0,"fab-in-list show",e(t,39,0,!n.isSuportMultipCam));e(t,43,0,n.changeCam);e(t,61,0,"close");e(t,80,0,"secondary");e(t,94,0,"secondary");e(t,102,0,n.useLocalStreamList,null==n.item?null:n.item.stream_id)},function(e,t){var n=t.component;e(t,3,0,M._13(t,4).statusbarPadding,M._13(t,4)._hasRefresher);e(t,18,0,M._13(t,19)._hidden);e(t,26,0,M._13(t,27)._hidden);e(t,33,0,M._13(t,34)._hidden);e(t,37,0,!n.isSuportMultipCam);e(t,42,0,M._13(t,43)._hidden);e(t,60,0,M._13(t,61)._hidden);e(t,81,0,"me-share:"+n.publishStreamId);e(t,95,0,"me:"+n.publishStreamId)})}function E(e){return M._19(0,[(e()(),M.Z(0,0,null,null,6,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(1,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,5,{contentLabel:0}),M._16(603979776,6,{_buttons:1}),M._16(603979776,7,{_icons:1}),M.Y(5,16384,null,0,Ge.a,[],null,null),(e()(),M._18(6,2,["",""]))],null,function(e,t){e(t,6,0,t.context.$implicit)})}function R(e){return M._19(0,[(e()(),M.Z(0,0,null,null,12,null,null,null,null,null,null,null)),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(2,0,null,null,6,"ion-list-header",[["class","item"]],null,null,null,Ve.b,Ve.a)),M.Y(3,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,2,{contentLabel:0}),M._16(603979776,3,{_buttons:1}),M._16(603979776,4,{_icons:1}),M.Y(7,16384,null,0,Ot.a,[Ee.a,M.z,M.j,[8,null]],null,null),(e()(),M._18(8,2,["\n        ","\n      "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M.U(16777216,null,null,1,null,E)),M.Y(11,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"]},null),(e()(),M._18(-1,null,["\n    "]))],function(e,t){e(t,11,0,t.context.$implicit.details)},function(e,t){e(t,8,0,t.context.$implicit.version)})}function P(e){return M._19(0,[M._16(402653184,1,{navBar:0}),(e()(),M.Z(1,0,null,null,10,"ion-header",[],null,null,null,null,null)),M.Y(2,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(4,0,null,null,6,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Oe.b,Oe.a)),M.Y(5,49152,[[1,4]],0,De.a,[Te.a,[2,Ce.a],[2,Se.a],Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(7,0,null,3,2,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(8,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      sdk版本更新明细\n    "])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n"])),(e()(),M.Z(13,0,null,null,9,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(14,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n  "])),(e()(),M.Z(16,0,null,1,5,"ion-list",[],null,null,null,null,null)),M.Y(17,16384,null,0,Ze.a,[Ee.a,M.j,M.z,Re.a,Pe.l,ke.a],null,null),(e()(),M._18(-1,null,["\n\n    "])),(e()(),M.U(16777216,null,null,1,null,R)),M.Y(20,802816,null,0,it.h,[M.I,M.F,M.p],{ngForOf:[0,"ngForOf"]},null),(e()(),M._18(-1,null,["\n\n  "])),(e()(),M._18(-1,1,["\n\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){e(t,20,0,t.component.items)},function(e,t){e(t,4,0,M._13(t,5)._hidden,M._13(t,5)._sbPadding);e(t,13,0,M._13(t,14).statusbarPadding,M._13(t,14)._hasRefresher)})}function I(e){return M._19(0,[(e()(),M.Z(0,0,null,null,37,"ion-header",[],null,null,null,null,null)),M.Y(1,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n  "])),(e()(),M.Z(3,0,null,null,33,"ion-toolbar",[["class","toolbar"],["color","primary"]],[[2,"statusbar-padding",null]],null,null,ut.b,ut.a)),M.Y(4,49152,null,0,xe.a,[Ee.a,M.j,M.z],{color:[0,"color"]},null),(e()(),M._18(-1,3,["\n    "])),(e()(),M.Z(6,0,null,3,29,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(7,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n      "])),(e()(),M.Z(9,0,null,0,25,"ion-grid",[["class","grid"]],null,null,null,null,null)),M.Y(10,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(12,0,null,null,21,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(13,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(15,0,null,null,2,"ion-col",[["class","col"],["col-4",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.goback()&&i}return i},null,null)),M.Y(16,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["返回"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(19,0,null,null,3,"ion-col",[["class","col"],["col-4",""],["style","text-align: center"]],null,null,null,null,null)),M.Y(20,16384,null,0,ht.a,[],null,null),(e()(),M.Z(21,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),M._18(-1,null,["VideoTalk"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(24,0,null,null,3,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),M.Y(25,16384,null,0,ht.a,[],null,null),(e()(),M.Z(26,0,null,null,1,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,[" "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(29,0,null,null,3,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),M.Y(30,16384,null,0,ht.a,[],null,null),(e()(),M.Z(31,0,null,null,1,"h6",[],null,null,null,null,null)),(e()(),M._18(-1,null,[" "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,0,["\n    "])),(e()(),M._18(-1,3,["\n  "])),(e()(),M._18(-1,null,["\n"])),(e()(),M._18(-1,null,["\n\n\n"])),(e()(),M.Z(39,0,null,null,97,"ion-content",[["padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(40,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(42,0,null,1,16,"ion-item",[["class","roomId item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(43,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,1,{contentLabel:0}),M._16(603979776,2,{_buttons:1}),M._16(603979776,3,{_icons:1}),M.Y(47,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(49,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(50,16384,[[1,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["配置标题"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(53,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.title=n)&&i}return i},Je.b,Je.a)),M.Y(54,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(56,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(57,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(60,0,null,1,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(61,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,4,{contentLabel:0}),M._16(603979776,5,{_buttons:1}),M._16(603979776,6,{_icons:1}),M.Y(65,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(67,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(68,16384,[[4,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["appid"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(71,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.appId=n)&&i}return i},Je.b,Je.a)),M.Y(72,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(74,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(75,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(78,0,null,1,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(79,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,7,{contentLabel:0}),M._16(603979776,8,{_buttons:1}),M._16(603979776,9,{_icons:1}),M.Y(83,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(85,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(86,16384,[[7,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["appKey"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(89,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.appKey=n)&&i}return i},Je.b,Je.a)),M.Y(90,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(92,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(93,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(96,0,null,1,17,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(97,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,10,{contentLabel:0}),M._16(603979776,11,{_buttons:1}),M._16(603979776,12,{_icons:1}),M.Y(101,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(103,0,null,1,2,"ion-label",[],null,null,null,null,null)),M.Y(104,16384,[[10,4]],0,We.a,[Ee.a,M.j,M.z,[8,null],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["测试环境"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(107,0,null,4,5,"ion-toggle",[["checked","false"]],[[2,"toggle-disabled",null],[2,"toggle-checked",null],[2,"toggle-activated",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup"]],function(e,t,n){var i=!0,r=e.component;if("keyup"===t){i=!1!==M._13(e,108)._keyup(n)&&i}if("ngModelChange"===t){i=!1!==(r.testenv=n)&&i}return i},et.b,et.a)),M.Y(108,1228800,null,0,tt.a,[Be.a,Ee.a,Re.a,M.j,M.z,nt.a,[2,He.a],Pe.l,ke.a,M.u],{checked:[0,"checked"]},null),M._15(1024,null,Ke.e,function(e){return[e]},[tt.a]),M.Y(110,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[2,Ke.e]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(112,16384,null,0,Ke.g,[Ke.f],null,null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n  "])),(e()(),M.Z(115,0,null,1,16,"ion-item",[["class","item item-block"]],null,null,null,Ve.b,Ve.a)),M.Y(116,1097728,null,3,He.a,[Be.a,Ee.a,M.j,M.z,[2,Fe.a]],null,null),M._16(335544320,13,{contentLabel:0}),M._16(603979776,14,{_buttons:1}),M._16(603979776,15,{_icons:1}),M.Y(120,16384,null,0,Ge.a,[],null,null),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(122,0,null,1,2,"ion-label",[["floating",""]],null,null,null,null,null)),M.Y(123,16384,[[13,4]],0,We.a,[Ee.a,M.j,M.z,[8,""],[8,null],[8,null],[8,null]],null,null),(e()(),M._18(-1,null,["businessType"])),(e()(),M._18(-1,2,["\n    "])),(e()(),M.Z(126,0,null,3,4,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,t,n){var i=!0;if("ngModelChange"===t){i=!1!==(e.component.businessType=n)&&i}return i},Je.b,Je.a)),M.Y(127,671744,null,0,Ke.h,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),M._15(2048,null,Ke.f,null,[Ke.h]),M.Y(129,16384,null,0,Ke.g,[Ke.f],null,null),M.Y(130,5423104,null,0,Qe.a,[Ee.a,Re.a,Be.a,Te.a,M.j,M.z,[2,Ye.a],[2,He.a],[2,Ke.f],ke.a],{type:[0,"type"]},null),(e()(),M._18(-1,2,["\n  "])),(e()(),M._18(-1,1,["\n\n\n\n\n\n\n  "])),(e()(),M.Z(133,0,null,1,2,"button",[["full",""],["ion-button",""],["margin-top",""],["tappable",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.openQRCode()&&i}return i},rt.b,rt.a)),M.Y(134,1097728,null,0,lt.a,[[8,""],Ee.a,M.j,M.z],{full:[0,"full"]},null),(e()(),M._18(-1,0,["获取二维码"])),(e()(),M._18(-1,1,["\n\n"])),(e()(),M._18(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,4,0,"primary");e(t,54,0,n.title);e(t,57,0,"text");e(t,72,0,n.appId);e(t,75,0,"text");e(t,90,0,n.appKey);e(t,93,0,"text");e(t,108,0,"false");e(t,110,0,n.testenv);e(t,127,0,n.businessType);e(t,130,0,"text");e(t,134,0,"")},function(e,t){e(t,3,0,M._13(t,4)._sbPadding);e(t,39,0,M._13(t,40).statusbarPadding,M._13(t,40)._hasRefresher);e(t,53,0,M._13(t,56).ngClassUntouched,M._13(t,56).ngClassTouched,M._13(t,56).ngClassPristine,M._13(t,56).ngClassDirty,M._13(t,56).ngClassValid,M._13(t,56).ngClassInvalid,M._13(t,56).ngClassPending);e(t,71,0,M._13(t,74).ngClassUntouched,M._13(t,74).ngClassTouched,M._13(t,74).ngClassPristine,M._13(t,74).ngClassDirty,M._13(t,74).ngClassValid,M._13(t,74).ngClassInvalid,M._13(t,74).ngClassPending);e(t,89,0,M._13(t,92).ngClassUntouched,M._13(t,92).ngClassTouched,M._13(t,92).ngClassPristine,M._13(t,92).ngClassDirty,M._13(t,92).ngClassValid,M._13(t,92).ngClassInvalid,M._13(t,92).ngClassPending);e(t,107,0,M._13(t,108)._disabled,M._13(t,108)._value,M._13(t,108)._activated,M._13(t,112).ngClassUntouched,M._13(t,112).ngClassTouched,M._13(t,112).ngClassPristine,M._13(t,112).ngClassDirty,M._13(t,112).ngClassValid,M._13(t,112).ngClassInvalid,M._13(t,112).ngClassPending);e(t,126,0,M._13(t,129).ngClassUntouched,M._13(t,129).ngClassTouched,M._13(t,129).ngClassPristine,M._13(t,129).ngClassDirty,M._13(t,129).ngClassValid,M._13(t,129).ngClassInvalid,M._13(t,129).ngClassPending)})}function L(e){return M._19(0,[M._16(402653184,1,{qrData:0}),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(2,0,null,null,28,"ion-header",[],null,null,null,null,null)),M.Y(3,16384,null,0,ze.a,[Ee.a,M.j,M.z,[2,Ce.a]],null,null),(e()(),M._18(-1,null,["\n      "])),(e()(),M.Z(5,0,null,null,24,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,ut.b,ut.a)),M.Y(6,49152,null,0,xe.a,[Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,3,["\n        "])),(e()(),M.Z(8,0,null,3,2,"ion-title",[],null,null,null,Ne.b,Ne.a)),M.Y(9,49152,null,0,Ae.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),(e()(),M._18(-1,0,["\n           demo设置页面配置参数（ios，android）\n        "])),(e()(),M._18(-1,3,["\n        "])),(e()(),M.Z(12,0,null,1,16,"ion-buttons",[["start",""]],null,null,null,null,null)),M.Y(13,16384,null,1,Yt.a,[Ee.a,M.j,M.z,[2,xe.a],[2,De.a]],null,null),M._16(603979776,2,{_buttons:1}),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(16,0,null,null,11,"button",[["ion-button",""]],null,[[null,"click"]],function(e,t,n){var i=!0;if("click"===t){i=!1!==e.component.dismiss()&&i}return i},rt.b,rt.a)),M.Y(17,1097728,[[2,4]],0,lt.a,[[8,""],Ee.a,M.j,M.z],null,null),(e()(),M._18(-1,0,["\n            "])),(e()(),M.Z(19,0,null,0,3,"span",[["color","primary"],["ion-text",""],["showWhen","ios"]],[[2,"hidden-show-when",null]],null,null,null,null)),M.Y(20,147456,null,0,qt.a,[[8,"ios"],Re.a,M.u],null,null),M.Y(21,16384,null,0,Zt.a,[Ee.a,M.j,M.z],{color:[0,"color"]},null),(e()(),M._18(-1,null,["取消"])),(e()(),M._18(-1,0,["\n            "])),(e()(),M.Z(24,0,null,0,2,"ion-icon",[["name","md-close"],["role","img"],["showWhen","android, windows"]],[[2,"hide",null],[2,"hidden-show-when",null]],null,null,null,null)),M.Y(25,147456,null,0,bt.a,[Ee.a,M.j,M.z],{name:[0,"name"]},null),M.Y(26,147456,null,0,qt.a,[[8,"android, windows"],Re.a,M.u],null,null),(e()(),M._18(-1,0,["\n          "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,3,["\n      "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M._18(-1,null,["\n    "])),(e()(),M.Z(32,0,null,null,45,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,je.b,je.a)),M.Y(33,4374528,null,0,Ye.a,[Ee.a,Re.a,ke.a,M.j,M.z,Te.a,qe.a,M.u,[2,Ce.a],[2,Se.a]],null,null),(e()(),M._18(-1,1,["\n      "])),(e()(),M.Z(35,0,null,1,41,"ion-grid",[["class","grid"]],null,null,null,null,null)),M.Y(36,16384,null,0,ct.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(38,0,null,null,12,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(39,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(41,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(42,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(44,0,null,null,2,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(45,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,[" 扫一扫"])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(48,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(49,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M.Z(52,0,null,null,14,"ion-row",[["class","row"]],null,null,null,null,null)),M.Y(53,16384,null,0,dt.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(55,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(56,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(58,0,null,null,4,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(59,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n            "])),(e()(),M.Z(61,0,[[1,0],["qrData",1]],null,0,"div",[],null,null,null,null,null)),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M.Z(64,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),M.Y(65,16384,null,0,ht.a,[],null,null),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,null,["\n            "])),(e()(),M._18(-1,null,["\n            "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,null,["\n          "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n        "])),(e()(),M._18(-1,null,["\n      "])),(e()(),M._18(-1,1,["\n    \n    "])),(e()(),M._18(-1,null,["\n  "]))],function(e,t){e(t,21,0,"primary");e(t,25,0,"md-close")},function(e,t){e(t,5,0,M._13(t,6)._sbPadding);e(t,19,0,!M._13(t,20).isMatch);e(t,24,0,M._13(t,25)._hidden,!M._13(t,26).isMatch);e(t,32,0,M._13(t,33).statusbarPadding,M._13(t,33)._hasRefresher)})}Object.defineProperty(t,"__esModule",{value:!0});var k=n(50),M=n(0),w=(n(3),n(27),n(89)),U=n(90),z=n(91),O=function(){function e(){}return e.isSupportWebRtc=function(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&RTCPeerConnection)},e.isPC=function(){var e={win:!1,mac:!1,xll:!1},t=navigator.platform;return e.win=0==t.indexOf("Win"),e.mac=0==t.indexOf("Mac"),e.xll="X11"==t||0==t.indexOf("Linux"),!!(e.win||e.mac||e.xll)},e.isIphone=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("ipad")||-1!=e.indexOf("iphone os")},e.isSafari=function(){var e=navigator.userAgent;return-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version")},e.utf16to8=function(e){var t,n,i,r;for(t="",i=e.length,n=0;n<i;n++)(r=e.charCodeAt(n))>=1&&r<=127?t+=e.charAt(n):r>2047?(t+=String.fromCharCode(224|r>>12&15),t+=String.fromCharCode(128|r>>6&63),t+=String.fromCharCode(128|r>>0&63)):(t+=String.fromCharCode(192|r>>6&31),t+=String.fromCharCode(128|r>>0&63));return t},e}(),D=n(60),N=function(){function e(e){this.http=e,this.config={appId:229059616,idName:"",nickName:"",server:"",loginTokenUrl:"",loginAuthTokenUrl:"",logUrl:"",videoQuality:2,logLevel:0,audienceCreateRoom:!1,audio:!0,audioInput:null,video:!0,videoInput:null,horizontal:!0,muted:!1,signalUrl:""},this.count=0,this.audioInputList=[],this.videoInputList=[],this.init()}return e.prototype.init=function(){var e=this;void 0!==D.ZegoClient?this.initEnumDevices():setTimeout(function(){e.init()},1e3)},Object.defineProperty(e.prototype,"signalUrl",{get:function(){return this.config.signalUrl},set:function(e){this.config.signalUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return this.config.appId||229059616},set:function(e){e&&(this.config.appId=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idName",{get:function(){return this.config.idName||(this.config.idName=""+(new Date).getTime()+Math.floor(1e5*Math.random())),this.config.idName},set:function(e){this.config.idName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nickName",{get:function(){return this.config.nickName||"u"+this.idName},set:function(e){e&&(this.config.nickName=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"server",{get:function(){return this.config.server||"wss://wsliveroom"+this.appId+"-api.zego.im:8282/ws"},set:function(e){e&&(this.config.server=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginTokenUrl",{get:function(){return this.config.loginTokenUrl||"https://wsliveroom"+this.appId+"-api.zego.im:8282/token"},set:function(e){e&&(this.config.loginTokenUrl=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginAuthTokenUrl",{get:function(){return this.config.loginAuthTokenUrl},set:function(e){e&&(this.config.loginAuthTokenUrl=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logUrl",{get:function(){return this.config.logUrl||""},set:function(e){e&&(this.config.logUrl=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return this.config.logLevel},set:function(e){e&&(this.config.logLevel=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audienceCreateRoom",{get:function(){return this.config.audienceCreateRoom},set:function(e){this.config.audienceCreateRoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this.config.audio},set:function(e){this.config.audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioInput",{get:function(){return this.config.audioInput},set:function(e){e&&(this.config.audioInput=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"video",{get:function(){return this.config.video},set:function(e){this.config.video=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoInput",{get:function(){return this.config.videoInput},set:function(e){e&&(this.config.videoInput=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.config.horizontal},set:function(e){this.config.horizontal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.config.muted},set:function(e){this.config.muted=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoQuality",{get:function(){return this.config.videoQuality||2},set:function(e){e&&(this.config.videoQuality=e)},enumerable:!0,configurable:!0}),e.prototype.getParameterByName=function(e,t){t||(t=window.location.href);var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},e.prototype.getToken=function(){return this.http.get(this.loginTokenUrl,{params:{app_id:this.appId+"",id_name:this.idName},responseType:"text"})},e.prototype.getAuthToken=function(e,t,n){return this.http.get(this.loginAuthTokenUrl,{params:{app:e,stream:t,publish:n?"0":"1"}})},e.prototype.initEnumDevices=function(){var e=this;this.audioInputList=[],this.videoInputList=[];var t=0;D.ZegoClient.enumDevices(function(n){if(console.log("enumDevices"+JSON.stringify(n)),n.microphones)for(var i=0;i<n.microphones.length;i++)0===i&&(e.audioInput=n.microphones[i].deviceId),n.microphones[i].label||(n.microphones[i].label="microphone"+i),e.audioInputList.push(n.microphones[i]),console.log("microphone: "+n.microphones[i].label);if(n.cameras){O.isIphone()&&O.isSafari()&&n.cameras.length>0&&(t=n.cameras.length-1),e.videoInput=n.cameras[t].deviceId;for(i=0;i<n.cameras.length;i++)n.cameras[i].label||(n.cameras[i].label="camera"+i),e.videoInputList.push(n.cameras[i]),console.log("camera: "+n.cameras[i].label)}},function(e){console.error("enum device error: "+e)})},e.prototype.toggleVideo=function(e){return this.videoInputList&&this.videoInputList[e]?this.videoInputList[e].deviceId:1===this.videoInputList.length?this.videoInputList[0].deviceId:null},e}(),A=function(){function e(){}return e.prototype.transform=function(e,t){if(!e||e.length<1||!t)return e;for(var n=[],i=[],r=0;r<e.length;r++)i.push(e[r]),r%t!=t-1&&r!==e.length-1||(n.push(i.slice()),i=[]);return n},e}(),x=n(237),j=function(){function e(){}return e.format=function(e,t){t||(t=new Date);var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e},e}(),Y=function(){function e(e,t){var n=this;this.http=e,this.config=t,this.statck=[],this.sub=new x.BehaviorSubject("0"),this._set=new Set([]),this._reg=/#.+#/,console.log("Hello LogfigProvider Provider"),this.sub.subscribe(function(e){n.statck.length>500?n.statck.shift():n.statck.push(e)});var i=this;this.nativeConsole={log:window.console.log.bind(window),debug:window.console.debug.bind(window),warn:window.console.warn.bind(window),error:window.console.error.bind(window)};var r=function(e,t){return function(){var n=[];Array.prototype.slice.call(arguments).slice().forEach(function(t){if("string"==typeof t)n.push(t);else if("object"==typeof t)try{n.push(JSON.stringify(t))}catch(n){i.nativeConsole[e](t)}else i.nativeConsole[e](t)}),i[t](n.join(","))}};window.console.debug=r("debug","debug"),window.console.info=r("log","info"),window.console.log=r("log","info"),window.console.warn=r("warn","warning"),window.console.error=r("error","errors")}return e.prototype.sendLog=function(){return this.http.post(this.config.logUrl,this.statck.join(","))},e.prototype.debug=function(e){this.typeLog(e),100!=this.config.logLevel&&this.config.logLevel<=0&&e&&this.sub.next(j.format("hh:mm:ss S")+"|debug|"+e),this.nativeConsole.debug(e)},e.prototype.info=function(e){this.typeLog(e),100!=this.config.logLevel&&this.config.logLevel<=1&&e&&this.sub.next(j.format("hh:mm:ss S")+"|info|"+e),this.nativeConsole.log(e)},e.prototype.warning=function(e){this.typeLog(e),100!=this.config.logLevel&&this.config.logLevel<=2&&e&&this.sub.next(j.format("hh:mm:ss S")+"|warning|"+e),this.nativeConsole.warn(e)},e.prototype.errors=function(e){this.typeLog(e),100!=this.config.logLevel&&this.config.logLevel<=3&&e&&this.sub.next(j.format("hh:mm:ss S")+"|errors|"+e),this.nativeConsole.error(e)},e.prototype.typeLog=function(e){if(e&&100!=this.config.logLevel){var t=this._reg.exec(e);t&&t.length>0&&this._set.add(t[0].replace(/#/g,""))}},e}(),q=function(){function e(e,t,n,i){this.navCtrl=e,this.log=t,this.config=n,this.alertCtrl=i,this.logArray=[],this.typeArray=[],this.selectOption={},this._typeID="",this._customerKey="",this._levelID="debug",this.refreshStatus="stop",this.myInit()}return e.prototype.myInit=function(){var e=this;this.subscription=this.log.sub.subscribe(function(t){"info"===e.levelID&&t.indexOf("|debug|")>-1||"warning"===e.levelID&&(t.indexOf("|debug|")>-1||t.indexOf("|info|")>-1)||"errors"===e.levelID&&t.indexOf("|errors|")<0||(e._customerKey?t.indexOf(e._customerKey)>-1&&e.logArray.unshift(t):"###"===e.typeID?e.isOther(t)&&e.logArray.unshift(t):e.typeID?t.indexOf("#"+e.typeID+"#")>-1&&e.logArray.unshift(t):e.logArray.unshift(t))})},e.prototype.ngAfterViewInit=function(){this.logArray=this.log.statck.slice(),this.logArray.reverse(),this.typeArray=Array.from(this.log._set)},e.prototype.toggleRefresh=function(){"stop"===this.refreshStatus?(this.refreshStatus="refresh",this.subscription.unsubscribe()):(this.refreshStatus="stop",this.typeID=this._typeID,this.levelID=this._levelID,this.myInit())},Object.defineProperty(e.prototype,"typeID",{get:function(){return this._typeID},set:function(e){var t=this;this._typeID=e,this._customerKey="","###"===e?(this.logArray=this.log.statck.filter(function(e){return t.isOther(e)}),this.logArray.reverse()):e?(this.logArray=this.log.statck.filter(function(t){return t.indexOf("#"+e+"#")>-1}),this.logArray.reverse()):this.ngAfterViewInit()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelID",{get:function(){return this._levelID},set:function(e){this._levelID=e,"debug"===e?this.logArray=this.log.statck:"info"===e?this.logArray=this.log.statck.filter(function(e){return e.indexOf("|debug|")<0}):"warning"===e?this.logArray=this.log.statck.filter(function(e){return e.indexOf("|warning|")>-1||e.indexOf("|errors|")>-1}):"errors"===e&&(this.logArray=this.log.statck.filter(function(e){return e.indexOf("|errors|")>-1})),this.logArray.reverse()},enumerable:!0,configurable:!0}),e.prototype.isOther=function(e){for(var t=!0,n=0;n<this.typeArray.length;n++)if(e.indexOf("#"+this.typeArray[n]+"#")>-1){t=!1;break}return t},e.prototype.showPrompt=function(){var e=this;this.alertCtrl.create({title:"自定义过滤",inputs:[{name:"key",placeholder:"关键字",value:this._customerKey}],buttons:[{text:"取消",handler:function(e){console.log("Cancel clicked")}},{text:"确定",handler:function(t){t.key&&e._customerKey!==t.key&&(e._typeID="",e._customerKey=t.key,e.logArray=e.log.statck.filter(function(e){return e.indexOf(t.key)>-1}),e.logArray.reverse())}}]}).present()},e.prototype.showDetail=function(e){this.alertCtrl.create({message:e}).present()},e.prototype.sendLog=function(){var e=this;this.config.logUrl?this.log.sendLog().subscribe(function(t){e.logArray=[],e.log.statck=[]}):this.alertCtrl.create({title:"请先配置日志服务器",message:"",buttons:[{text:"确定",handler:function(){console.log("Disagree clicked")}}]}).present()},e.prototype.ionViewWillUnload=function(){this.subscription.unsubscribe()},e}(),Z=0,V=1,H=function(){function e(e,t,n,i,r,l){this.navCtrl=e,this.navParams=t,this.config=n,this.slide=i,this.logger=r,this.alertCtrl=l,this.useLocalStreamList=[],this.isSuportMultipCam=!1,this.offOnCam="md-videocam",this.offOnMic="md-mic",this.offOnVolume="md-volume-up",this.changeCam="md-sync",this.addedVideo=[],this.roomId=this.navParams.get("roomId")||this.config.getParameterByName("roomId"),this.publishStreamId=this.navParams.get("publishStreamId")||"s"+this.config.idName,this.roomId||(this.logger.warning("#"+this.publishStreamId+"#roomId is empty,force to go back"),this.logoutRoom())}return e.prototype.ngAfterViewInit=function(){var e=this;void 0!==D.ZegoClient?this.init():setTimeout(function(){e.ngAfterViewInit()},1e3)},e.prototype.init=function(){var e=this;this.zg=new D.ZegoClient,this.configZego(),this.isSuportMultipCam=this.config.videoInputList.length>1,this.subVideoList.changes.subscribe(function(t){if(t.length>0){t.forEach(function(t){var n;e.addedVideo.some(function(e){return t.nativeElement.id==e.stream_id})&&(t.nativeElement.muted="md-volume-off"===e.offOnVolume,(n=e.zg.startPlayingStream(t.nativeElement.id,t.nativeElement))||(e.alertCtrl.create({title:"哎呀，播放失败啦！"}).present(),t.nativeElement.style="display:none",console.error("play "+t.nativeElement.id+" return "+n))),0}),e.addedVideo=[]}});var t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)?"pagehide":"beforeunload";window.addEventListener(t,function(t){window.event.cancelBubble=!0,console.log("beafore unload"),e.loginRoom&&(e.logoutRoom(),e.loginRoom=!1)})},e.prototype.configZego=function(){if(this.roomId){var e={appid:this.config.appId,idName:this.config.idName,nickName:this.config.nickName,server:this.config.server,logLevel:this.config.logLevel,logUrl:this.config.logUrl,remoteLogLevel:0};this.logger.info("#"+this.publishStreamId+"#config param:"+JSON.stringify(e)),this.zg.config(e),this.zg.setUserStateUpdate(!0),this.login()}},e.prototype.login=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#get token start"),this.config.getToken().subscribe(function(t){e.loginToken=t,e.logger.info("#"+e.publishStreamId+"#get token success:"+t),e.logger.info("#"+e.publishStreamId+"#start login"),e.zg.login(e.roomId,2,e.loginToken,function(t){if(t.length>=4)return e.alertCtrl.create({title:"房间太拥挤，换一个吧！"}).present(),void e.logoutRoom();e.logger.info("#"+e.publishStreamId+"#login success"),e.loginRoom=!0,e.listen(),e.useLocalStreamList=e.useLocalStreamList.concat(t),e.addedVideo=e.useLocalStreamList.slice(),e.doPreviewPublish()},function(t){e.alertCtrl.create({title:"登录失败:"+t.msg}).present(),e.logger.errors("#"+e.publishStreamId+"login failed:"+t.msg)})},function(t){e.alertCtrl.create({title:"获取token失败"}).present(),e.logger.errors("#"+e.publishStreamId+"#get token failed")})},e.prototype.doPreviewPublish=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#start Preview");var t={audio:this.config.audio,audioInput:this.config.audioInput,video:this.config.video,videoInput:this.config.videoInput,videoQuality:this.config.videoQuality,horizontal:this.config.horizontal};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.zg.startPublishingStream(e.publishStreamId,e.localVideo.nativeElement),e.localVideo.nativeElement.muted=!e.config.muted;var t=0;e.config.videoInputList&&e.config.videoInputList.forEach(function(n,i){n.deviceId==e.config.videoInput&&(t=i)}),e.changeCam=0===t?"md-sync":"ios-sync-outline",e.config.initEnumDevices()},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t));e.alertCtrl.create({title:("NotAllowedError"===t?"请打开允许使用摄像头使用权限":"请检查摄像设备是否可用，再试试吧！")+"("+t+")"}).present(),e.logoutRoom()})},e.prototype.toggleCam=function(){"md-videocam"===this.offOnCam?(this.offOnCam="ios-videocam-outline",this.logger.info("#"+this.publishStreamId+"#close camera"),this.zg.enableCamera(this.localVideo.nativeElement,!1)):(this.offOnCam="md-videocam",this.logger.info("#"+this.publishStreamId+"#open camera"),this.zg.enableCamera(this.localVideo.nativeElement,!0))},e.prototype.toggleMic=function(){"md-mic"===this.offOnMic?(this.offOnMic="ios-mic-outline",this.logger.info("#"+this.publishStreamId+"#close micphone"),this.zg.enableMicrophone(this.localVideo.nativeElement,!1)):(this.offOnMic="md-mic",this.logger.info("#"+this.publishStreamId+"#open micphone"),this.zg.enableMicrophone(this.localVideo.nativeElement,!0))},e.prototype.toggleVolume=function(){"md-volume-up"===this.offOnVolume?(this.offOnVolume="md-volume-off",this.subVideoList.forEach(function(e){e.nativeElement.muted=!0})):(this.offOnVolume="md-volume-up",this.subVideoList.forEach(function(e){e.nativeElement.muted=!1}))},e.prototype.changeUseCam=function(){var e=this;this.changeCam="md-sync"===this.changeCam?"ios-sync-outline":"md-sync",this.logger.info("#"+this.publishStreamId+"#change camera"),this.zg.stopPreview(this.localVideo.nativeElement),this.zg.stopPublishingStream(this.publishStreamId);var t={audio:"md-mic"===this.offOnMic,audioInput:this.config.audioInput,video:"md-videocam"===this.offOnCam,videoInput:this.config.toggleVideo("md-sync"===this.changeCam?0:1),videoQuality:this.config.videoQuality,horizontal:this.config.horizontal};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.zg.startPublishingStream(e.publishStreamId,e.localVideo.nativeElement),e.localVideo.nativeElement.muted=!e.config.muted},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t))})},e.prototype.listen=function(){var e=this,t={onPlayStateUpdate:function(t,n,i){if(0==t)e.logger.info("#"+n+"# play  success");else if(2==t)e.logger.info("#"+n+"# play retry");else{e.logger.errors("#"+n+"# play error "+i.msg);var r=i.msg;if(i.msg.indexOf("server session closed, reason: ")>-1){var l=i.msg.replace("server session closed, reason: ","");21==l?r="音频编解码不支持(opus)":22==l?r="视频编解码不支持(H264)":20==l&&(r="sdp 解释错误")}e.alertCtrl.create({title:"拉流"+n+"失败，"+r}).present()}},onPublishStateUpdate:function(t,n,i){if(0==t)e.logger.info("#"+n+"# publish  success");else if(2==t)e.logger.info("#"+n+"# publish  retry");else{e.logger.errors("#"+n+"# publish error "+i.msg);var r=i.msg;if(i.msg.indexOf("server session closed, reason: ")>-1){var l=i.msg.replace("server session closed, reason: ","");21==l?r="音频编解码不支持(opus)":22==l?r="视频编解码不支持(H264)":20==l&&(r="sdp 解释错误")}e.alertCtrl.create({title:"推流"+n+"失败，"+r}).present()}},onPublishQualityUpdate:function(t,n){e.logger.info("#"+t+"#publish  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onPlayQualityUpdate:function(t,n){e.logger.info("#"+t+"#play  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onDisconnect:function(t){e.logger.errors("onDisconnect "+JSON.stringify(t)),e.alertCtrl.create({title:"网络连接已断开："+JSON.stringify(t)}).present(),e.logoutRoom()},onKickOut:function(t){e.logger.errors("onKickOut "+JSON.stringify(t))},onStreamExtraInfoUpdated:function(e){},onVideoSizeChanged:function(t,n,i){e.logger.info("#"+t+"#play  : "+n+"x"+i)},onStreamUpdated:function(t,n){if(t==Z)for(var i=0;i<n.length;i++)e.logger.info("#"+n[i].stream_id+"# was added"),e.useLocalStreamList.push(n[i]),e.addedVideo.push(n[i]);else if(t==V)for(var r=0;r<e.useLocalStreamList.length;r++)for(var l=0;l<n.length;l++)if(e.useLocalStreamList[r].stream_id===n[l].stream_id){e.zg.stopPlayingStream(e.useLocalStreamList[r].stream_id),e.logger.info("#"+e.useLocalStreamList[r].stream_id+"# was deleted "),e.useLocalStreamList.splice(r,1);break}},onUserStateUpdate:function(t,n){e.logger.info("onUserStateUpdate = "+t+JSON.stringify(n))}};for(var n in t)this.zg[n]=t[n]},e.prototype.ionViewWillUnload=function(){this.logger.info("beafore unload"),this.loginRoom&&(this.leaveRoom(),this.loginRoom=!1)},e.prototype.leaveRoom=function(){this.logger.info("leave room  and close stream"),this.zg.stopPreview(this.localVideo.nativeElement),this.zg.stopPublishingStream(this.publishStreamId);for(var e=0;e<this.useLocalStreamList.length;e++)this.zg.stopPlayingStream(this.useLocalStreamList[e].stream_id);this.zg.logout()},e.prototype.logoutRoom=function(){if(this.logger.info("#"+this.publishStreamId+"# logout"),this.loginRoom){try{this.leaveRoom()}catch(e){console.error(e)}this.loginRoom=!1}this.navCtrl.canGoBack()?this.navCtrl.pop():this.navCtrl.goToRoot({animate:!0})},e.prototype.showLogs=function(){this.navCtrl.push(q)},e.prototype.identify=function(e,t){return t.stream_id},e}(),B=function(){function e(e,t,n){this.navCtrl=e,this.config=t,this.alertCtrl=n,this.audioInputList=[],this.videoInputList=[],this.idName=this.config.idName,this.appId=this.config.appId,this.nickName=this.config.nickName,this.logLevel=this.config.logLevel,this.logUrl=this.config.logUrl,this.audio=this.config.audio,this.audienceCreateRoom=this.config.audienceCreateRoom,this.audioInput=this.config.audioInput,this.video=this.config.video,this.videoInput=this.config.videoInput,this.videoQuality=this.config.videoQuality,this.horizontal=this.config.horizontal,this.muted=this.config.muted}return e.prototype.ngAfterViewInit=function(){var e=this;void 0!==D.ZegoClient?(this.zg=new D.ZegoClient,this.audioInputList=this.config.audioInputList,this.videoInputList=this.config.videoInputList,this.navBar.backButtonClick=function(t){e.isChange()?e.showConfirm():e.navCtrl.pop()}):setTimeout(function(){e.ngAfterViewInit()},1e3)},e.prototype.showConfirm=function(){var e=this;this.alertCtrl.create({title:"确定修改么?",message:"",buttons:[{text:"取消",handler:function(){e.navCtrl.canGoBack()?e.navCtrl.pop():e.navCtrl.goToRoot({animate:!0})}},{text:"确定",handler:function(){e.sure()}}]}).present()},e.prototype.sure=function(){this.config.idName=this.idName,this.config.appId=this.appId,this.config.nickName=this.nickName,this.config.logLevel=this.logLevel,this.config.logUrl=this.logUrl,this.config.audienceCreateRoom=this.audienceCreateRoom,this.config.audio=this.audio,this.config.audioInput=this.audioInput,this.config.video=this.video,this.config.videoInput=this.videoInput,this.config.videoQuality=1*this.videoQuality,this.config.horizontal=this.horizontal,this.config.muted=this.muted,this.navCtrl.canGoBack()?this.navCtrl.pop():this.navCtrl.goToRoot({animate:!0})},e.prototype.isChange=function(){return this.config.idName!==this.idName||this.config.appId!==this.appId||this.config.nickName!==this.nickName||this.config.logLevel!==this.logLevel||this.config.logUrl!==this.logUrl||this.config.audienceCreateRoom!==this.audienceCreateRoom||this.config.audio!==this.audio||this.config.audioInput!==this.audioInput||this.config.video!==this.video||this.config.videoInput!==this.videoInput||this.config.videoQuality!=this.videoQuality||this.config.horizontal!==this.horizontal||this.config.muted!==this.muted},e}(),F=n(71),G=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},W=0,J=1,Q=function(){function e(e,t,n,i,r,l){this.navCtrl=e,this.navParams=t,this.config=n,this.slide=i,this.logger=r,this.alertCtrl=l,this.useLocalStreamList=[],this.isSuportMultipCam=!1,this.isPublish=!0,this.offOnCam="md-videocam",this.offOnMic="md-mic",this.offOnVolume="md-volume-up",this.changeCam="md-sync",this.addedVideo=[],this.roomId=this.navParams.get("roomId")||this.config.getParameterByName("roomId"),this.isTest=this.navParams.get("isTest"),this.signUrl=this.navParams.get("signUrl"),this.pullstreamId=this.navParams.get("pullstreamId"),this.isPublish=!1!==this.navParams.get("isPublish"),this.publishStreamId=this.navParams.get("publishStreamId")||"s-"+this.config.idName,this.roomId||(this.logger.warning("#"+this.publishStreamId+"#roomId is empty,force to go back"),this.logoutRoom())}return e.prototype.ngAfterViewInit=function(){var e=this;void 0!==D.ZegoClient?this.init():setTimeout(function(){e.ngAfterViewInit()},1e3)},e.prototype.init=function(){var e=this;this.screenshare(),this.isSuportMultipCam=this.config.videoInputList.length>1,this.subVideoList.changes.subscribe(function(t){if(t.length>0){t.forEach(function(t){var n;e.addedVideo.some(function(e){return t.nativeElement.id==e.stream_id})&&(t.nativeElement.muted="md-volume-off"===e.offOnVolume,(n=e.zg.startPlayingStream(t.nativeElement.id,t.nativeElement))||(e.alertCtrl.create({title:"哎呀，播放失败啦！"}).present(),t.nativeElement.style="display:none",console.error("play "+t.nativeElement.id+" return "+n))),0}),e.addedVideo=[]}}),window.onbeforeunload=function(){console.log("beafore unload"),e.loginRoom&&(e.leaveRoom(),e.loginRoom=!1)},window.addEventListener("message",function(t){var n=t.data;"SS_DIALOG_SUCCESS"===n.type&&e.startScreenStreamFrom(n.streamId)})},e.prototype.configZego=function(){if(this.roomId){var e={appid:this.config.appId,idName:this.config.idName,nickName:this.config.nickName,server:this.config.server,logLevel:this.config.logLevel,logUrl:this.config.logUrl,remoteLogLevel:0};this.logger.info("#"+this.publishStreamId+"#config param:"+JSON.stringify(e)),this.zg.config(e),this.login(),this.signUrl&&this.zg.setCustomSignalUrl(this.signUrl)}},e.prototype.screenshare=function(){window.extensionInstalled||this.alertCtrl.create({title:'\n        Please install the extension:\n        1. Go to chrome://extensions\n        2. Check: "Enable Developer mode\n        3. Click: "Load the unpacked extension...\n        4. Choose "extension" folder from the repository\n        5. Reload this page\n      '}).present(),window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*")},e.prototype.startScreenStreamFrom=function(e){var t=this,n={chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height},i={};i.audio=!1,i.video={mandatory:n},navigator.mediaDevices.getUserMedia(i).then(function(e){t.localVideo1.nativeElement.srcObject=e,t.zg=new D.ZegoClient,t.configZego()}).catch(console.error)},e.prototype.login=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#get token start"),this.config.getToken().subscribe(function(t){e.loginToken=t,e.logger.info("#"+e.publishStreamId+"#get token success:"+t),e.logger.info("#"+e.publishStreamId+"#start login"),e.zg.login(e.roomId,2,e.loginToken,function(t){if(e.pullstreamId&&(t=[{stream_id:e.pullstreamId}]),t.length>=4)return e.alertCtrl.create({title:"房间太拥挤，换一个吧！"}).present(),void e.logoutRoom();e.logger.info("#"+e.publishStreamId+"#login success"),e.loginRoom=!0,e.listen(),e.useLocalStreamList=e.useLocalStreamList.concat(t),e.addedVideo=e.useLocalStreamList.slice(),e.doPreviewPublish()},function(t){e.logger.errors("#"+e.publishStreamId+"login failed:err.msg")})},function(t){e.logger.errors("#"+e.publishStreamId+"#get token failed")})},e.prototype.doPreviewPublish=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#start Preview");var t={audio:this.config.audio,audioInput:this.config.audioInput,video:this.config.video,videoInput:this.config.videoInput,videoQuality:this.config.videoQuality,horizontal:this.config.horizontal,externalCapture:!0};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo1.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.isPublish&&e.zg.startPublishingStream("s"+e.publishStreamId,e.localVideo1.nativeElement),e.localVideo1.nativeElement.muted=!e.config.muted,e.config.initEnumDevices()},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t));e.alertCtrl.create({title:("NotAllowedError"===t?"请打开允许使用摄像头使用权限":"请检查摄像设备是否可用，再试试吧！")+"("+t+")"}).present(),e.logoutRoom()}),this.zg.startPreview(this.localVideo2.nativeElement,G({},t,{externalCapture:!1}),function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.isPublish&&e.zg.startPublishingStream(e.publishStreamId,e.localVideo2.nativeElement),e.localVideo2.nativeElement.muted=!e.config.muted,e.config.initEnumDevices()},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t));e.alertCtrl.create({title:("NotAllowedError"===t?"请打开允许使用摄像头使用权限":"请检查摄像设备是否可用，再试试吧！")+"("+t+")"}).present(),e.logoutRoom()})},e.prototype.toggleCam=function(){"md-videocam"===this.offOnCam?(this.offOnCam="ios-videocam-outline",this.logger.info("#"+this.publishStreamId+"#close camera"),this.zg.enableCamera(this.localVideo2.nativeElement,!1)):(this.offOnCam="md-videocam",this.logger.info("#"+this.publishStreamId+"#open camera"),this.zg.enableCamera(this.localVideo2.nativeElement,!0))},e.prototype.toggleMic=function(){"md-mic"===this.offOnMic?(this.offOnMic="ios-mic-outline",this.logger.info("#"+this.publishStreamId+"#close micphone"),this.zg.enableMicrophone(this.localVideo2.nativeElement,!1)):(this.offOnMic="md-mic",this.logger.info("#"+this.publishStreamId+"#open micphone"),this.zg.enableMicrophone(this.localVideo2.nativeElement,!0))},e.prototype.toggleVolume=function(){"md-volume-up"===this.offOnVolume?(this.offOnVolume="md-volume-off",this.subVideoList.forEach(function(e){e.nativeElement.muted=!0})):(this.offOnVolume="md-volume-up",this.subVideoList.forEach(function(e){e.nativeElement.muted=!1}))},e.prototype.changeUseCam=function(){var e=this;this.changeCam="md-sync"===this.changeCam?"ios-sync-outline":"md-sync",this.logger.info("#"+this.publishStreamId+"#change camera"),this.zg.stopPreview(this.localVideo2.nativeElement),this.zg.stopPublishingStream(this.publishStreamId);var t={audio:"md-mic"===this.offOnMic,audioInput:this.config.audioInput,video:"md-videocam"===this.offOnCam,videoInput:this.config.toggleVideo("md-sync"===this.changeCam?0:1),videoQuality:this.config.videoQuality,horizontal:this.config.horizontal};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo2.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.zg.startPublishingStream(e.publishStreamId,e.localVideo2.nativeElement),e.localVideo2.nativeElement.muted=!e.config.muted},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t))})},e.prototype.listen=function(){var e=this,t={onPlayStateUpdate:function(t,n,i){0==t?e.logger.info("#"+n+"# play  success"):2==t?e.logger.info("#"+n+"# play retry"):e.logger.errors("#"+n+"# play error "+i.msg)},onPublishStateUpdate:function(t,n,i){0==t?e.logger.info("#"+n+"# publish  success"):2==t?e.logger.info("#"+n+"# publish  retry"):(e.logger.errors("#"+n+"# publish error "+i.msg),e.alertCtrl.create({title:"推流"+n+"失败，"+i.msg}).present())},onPublishQualityUpdate:function(t,n){e.logger.info("#"+t+"#publish  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onPlayQualityUpdate:function(t,n){e.logger.info("#"+t+"#play  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onDisconnect:function(t){e.logger.errors("onDisconnect "+JSON.stringify(t))},onKickOut:function(t){e.logger.errors("onKickOut "+JSON.stringify(t))},onStreamExtraInfoUpdated:function(e){},onVideoSizeChanged:function(t,n,i){e.logger.info("#"+t+"#play  : "+n+"x"+i)},onStreamUpdated:function(t,n){if(t==W)for(var i=0;i<n.length;i++)e.logger.info("#"+n[i].stream_id+"# was added"),e.useLocalStreamList.push(n[i]),e.addedVideo.push(n[i]);else if(t==J)for(var r=0;r<e.useLocalStreamList.length;r++)for(var l=0;l<n.length;l++)if(e.useLocalStreamList[r].stream_id===n[l].stream_id){e.zg.stopPlayingStream(e.useLocalStreamList[r].stream_id),e.logger.info("#"+e.useLocalStreamList[r].stream_id+"# was deleted "),e.useLocalStreamList.splice(r,1);break}},onUserStateUpdate:function(t,n){e.logger.info("onUserStateUpdate = "+t+JSON.stringify(n))}};for(var n in t)this.zg[n]=t[n]},e.prototype.ionViewWillUnload=function(){this.logger.info("beafore unload"),this.loginRoom&&(this.leaveRoom(),this.loginRoom=!1)},e.prototype.leaveRoom=function(){this.logger.info("leave room  and close stream"),this.zg.stopPreview(this.localVideo1.nativeElement),this.zg.stopPreview(this.localVideo2.nativeElement),this.zg.stopPublishingStream(this.publishStreamId),this.zg.stopPublishingStream("s"+this.publishStreamId);for(var e=0;e<this.useLocalStreamList.length;e++)this.zg.stopPlayingStream(this.useLocalStreamList[e].stream_id);this.zg.logout()},e.prototype.logoutRoom=function(){if(this.logger.info("#"+this.publishStreamId+"# logout"),this.loginRoom){try{this.leaveRoom()}catch(e){console.error(e)}this.loginRoom=!1}this.navCtrl.canGoBack()?this.navCtrl.pop():this.navCtrl.goToRoot({animate:!0})},e.prototype.showLogs=function(){this.navCtrl.push(q)},e}(),K=function(){function e(e,t,n,i){this.navCtrl=e,this.logger=t,this.storage=n,this.alertCtr=i,this.isSupport=!0,this.roomId=""}return e.prototype.ngOnInit=function(){var e=this;D.ZegoClient.isSupportWebrtc()||(this.isSupport=!1,this.alertCtr.create({title:"哎呀，浏览器暂不支持体验webrtc哦！"}).present()),D.ZegoClient.isSupportH264(function(t){t||(e.isSupport=!1,e.alertCtr.create({title:"浏览器不支持H264编码，换一个浏览器试试吧"}).present())},function(t){e.logger.errors(t)}),this.storage.get("homepage_roomid").then(function(t){e.roomId=t})},e.prototype.openRoom=function(e){var t=this;if(void 0===e&&(e=0),this.roomId=this.roomId&&this.roomId.replace(/^\s+|\s+$/gm,""),!this.roomId)return this.logger.info("iuput roomId is empty!"),void this.alertCtr.create({title:"请输入房间号"}).present();var n="screen"===this.roomId?Q:H;n=H,this.storage.set("homepage_roomid",this.roomId).then(function(){t.navCtrl.push(n,{roomId:t.roomId,test:e},{animate:!1})},function(e){console.log(e)}).catch(function(e){console.log(e)})},e.prototype.openSetting=function(){this.navCtrl.push(B,{},{animate:!0})},e}(),X=function(){return function(e,t,n){this.rootPage=K,e.ready().then(function(){t.styleDefault(),n.hide()})}}(),$=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ee=0,te=1,ne=function(){function e(e,t,n,i,r,l){var s=this;this.navCtrl=e,this.navParams=t,this.config=n,this.slide=i,this.logger=r,this.alertCtrl=l,this.useLocalStreamList=[],this.pullstreamId=[],this.isSuportMultipCam=!1,this.isPublish=!0,this.isLogin=!0,this.status={},this.isPublishAudio=!0,this.isPublishVideo=!0,this.isPullAudio=!0,this.isPullVideo=!0,this.authTokenUrl="",this.appNode="",this.offOnCam="md-videocam",this.offOnMic="md-mic",this.offOnVolume="md-volume-up",this.changeCam="md-sync",this.addedVideo=[],this.roomId=this.navParams.get("roomId")||this.config.getParameterByName("roomId"),this.isTest=this.navParams.get("isTest"),this.signUrl=this.navParams.get("signUrl");var o=this.navParams.get("pullstreamIds");o&&o.split(",").forEach(function(e){s.pullstreamId.push({stream_id:e,anchor_id_name:"",anchor_nick_name:"",extra_info:""})}),this.isPublish=!1!==this.navParams.get("isPublish"),this.isLogin=!1!==this.navParams.get("isLogin"),this.publishStreamId=this.navParams.get("publishStreamId")||"s"+this.config.idName,this.isPublishAudio=this.navParams.get("isPublishAudio"),this.isPublishVideo=this.navParams.get("isPublishVideo"),this.isPullAudio=this.navParams.get("isPullAudio"),this.isPullVideo=this.navParams.get("isPullVideo"),this.authTokenUrl=this.navParams.get("authTokenUrl"),this.appNode=this.navParams.get("appNode"),this.roomId||(this.logger.warning("#"+this.publishStreamId+"#roomId is empty,force to go back"),this.logoutRoom())}return e.prototype.ngAfterViewInit=function(){var e=this;void 0!==D.ZegoClient?this.init():setTimeout(function(){e.ngAfterViewInit()},1e3)},e.prototype.init=function(){var e=this;this.zg=new D.ZegoClient,this.configZego(),this.isSuportMultipCam=this.config.videoInputList.length>1,this.subVideoList.changes.subscribe(function(t){if(t.length>0){t.forEach(function(t){if(e.addedVideo.some(function(e){return t.nativeElement.id==e.stream_id})){t.nativeElement.muted="md-volume-off"===e.offOnVolume;var n=null;n=e.isPullVideo?"video":n,n=e.isPullAudio?"audio":n,(n=e.isPullVideo&&e.isPullAudio?"all":n)?e.playStream(t.nativeElement.id,t.nativeElement,n):e.logger.errors("#"+t.nativeElement.id+"# do not pull")}0}),e.addedVideo=[]}});var t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)?"pagehide":"beforeunload";window.addEventListener(t,function(t){window.event.cancelBubble=!0,console.log("beafore unload"),e.loginRoom&&(e.logoutRoom(),e.loginRoom=!1)})},e.prototype.playStream=function(e,t,n){var i=this;if(this.authTokenUrl&&this.appNode)this.config.loginAuthTokenUrl=this.authTokenUrl,this.config.getAuthToken(this.appNode,e,!0).subscribe(function(r){var l=i.zg.startPlayingStream(e,t,null,{playType:n,streamParams:"zg_expired="+r.zg_expired+"&zg_nonce="+r.zg_nonce+"&zg_token="+r.zg_token});l||(i.alertCtrl.create({title:"哎呀，播放失败啦！"}).present(),t.style="display:none",console.error("play "+t.id+" return "+l))});else{var r=this.zg.startPlayingStream(e,t,null,{playType:n});r||(this.alertCtrl.create({title:"哎呀，播放失败啦！"}).present(),t.style="display:none",console.error("play "+t.id+" return "+r))}},e.prototype.configZego=function(){if(this.roomId){var e={appid:this.config.appId,idName:this.config.idName,nickName:this.config.nickName,server:this.config.server,logLevel:this.config.logLevel,logUrl:this.config.logUrl,remoteLogLevel:0,audienceCreateRoom:!0};this.logger.info("#"+this.publishStreamId+"#config param:"+JSON.stringify(e)),this.zg.config(e),this.zg.setUserStateUpdate(!0),this.signUrl&&this.zg.setCustomSignalUrl(this.signUrl),this.login()}},e.prototype.login=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#get token start"),this.status["push"+this.publishStreamId]="logging",this.status=$({},this.status),this.config.getToken().subscribe(function(t){e.loginToken=t,e.logger.info("#"+e.publishStreamId+"#get token success:"+t),e.logger.info("#"+e.publishStreamId+"#start login"),e.zg.login(e.roomId,2,e.loginToken,function(t){if(e.status["push"+e.publishStreamId]="login",e.pullstreamId.length>0&&(t=e.pullstreamId),t.length>=4)return e.alertCtrl.create({title:"房间太拥挤，换一个吧！"}).present(),void e.logoutRoom();e.logger.info("#"+e.publishStreamId+"#login success"),e.loginRoom=!0,e.listen(),e.useLocalStreamList=e.useLocalStreamList.concat(t),e.addedVideo=e.useLocalStreamList.slice(),e.useLocalStreamList.forEach(function(t){e.status["pull"+t.stream_id]="pulling"}),e.status=$({},e.status),e.isPublish&&e.doPreviewPublish(),e.isPublish||(e.offOnVolume="md-volume-off")},function(t){e.alertCtrl.create({title:"登录失败:"+t.msg}).present(),e.logger.errors("#"+e.publishStreamId+"login failed:"+t.msg)})},function(t){e.alertCtrl.create({title:"获取token失败"}).present(),e.logger.errors("#"+e.publishStreamId+"#get token failed")})},e.prototype.doPreviewPublish=function(){var e=this;this.logger.info("#"+this.publishStreamId+"#start Preview");var t={audio:this.config.audio&&this.isPublishAudio,audioInput:this.config.audioInput,video:this.config.video&&this.isPublishVideo,videoInput:this.config.videoInput,videoQuality:this.config.videoQuality,horizontal:this.config.horizontal};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.status["push"+e.publishStreamId]="previewed",e.status=$({},e.status),e.publishStream(),e.localVideo.nativeElement.muted=!e.config.muted;var t=0;e.config.videoInputList&&e.config.videoInputList.forEach(function(n,i){n.deviceId==e.config.videoInput&&(t=i)}),e.changeCam=0===t?"md-sync":"ios-sync-outline",e.config.initEnumDevices()},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t));e.alertCtrl.create({title:("NotAllowedError"===t?"请打开允许使用摄像头使用权限":"请检查摄像设备是否可用，再试试吧！")+"("+t+")"}).present(),e.logoutRoom()})},e.prototype.publishStream=function(){var e=this;if(this.authTokenUrl&&this.appNode&&this.isPublish)this.config.loginAuthTokenUrl=this.authTokenUrl,this.config.getAuthToken(this.appNode,this.publishStreamId,!1).subscribe(function(t){var n=e.zg.startPublishingStream(e.publishStreamId,e.localVideo.nativeElement,null,{streamParams:"zg_expired="+t.zg_expired+"&zg_nonce="+t.zg_nonce+"&zg_token="+t.zg_token});e.status["push"+e.publishStreamId]=n?"publishing":"publish fail"});else if(this.isPublish){var t=this.zg.startPublishingStream(this.publishStreamId,this.localVideo.nativeElement);this.status["push"+this.publishStreamId]=t?"publishing":"publish fail"}},e.prototype.toggleCam=function(){"md-videocam"===this.offOnCam?(this.offOnCam="ios-videocam-outline",this.logger.info("#"+this.publishStreamId+"#close camera"),this.zg.enableCamera(this.localVideo.nativeElement,!1)):(this.offOnCam="md-videocam",this.logger.info("#"+this.publishStreamId+"#open camera"),this.zg.enableCamera(this.localVideo.nativeElement,!0))},e.prototype.toggleMic=function(){"md-mic"===this.offOnMic?(this.offOnMic="ios-mic-outline",this.logger.info("#"+this.publishStreamId+"#close micphone"),this.zg.enableMicrophone(this.localVideo.nativeElement,!1)):(this.offOnMic="md-mic",this.logger.info("#"+this.publishStreamId+"#open micphone"),this.zg.enableMicrophone(this.localVideo.nativeElement,!0))},e.prototype.toggleVolume=function(){"md-volume-up"===this.offOnVolume?(this.offOnVolume="md-volume-off",this.subVideoList.forEach(function(e){e.nativeElement.muted=!0})):(this.offOnVolume="md-volume-up",this.subVideoList.forEach(function(e){e.nativeElement.muted=!1}))},e.prototype.changeUseCam=function(){var e=this;this.changeCam="md-sync"===this.changeCam?"ios-sync-outline":"md-sync",this.logger.info("#"+this.publishStreamId+"#change camera"),this.zg.stopPreview(this.localVideo.nativeElement),this.zg.stopPublishingStream(this.publishStreamId);var t={audio:"md-mic"===this.offOnMic,audioInput:this.config.audioInput,video:"md-videocam"===this.offOnCam,videoInput:this.config.toggleVideo("md-sync"===this.changeCam?0:1),videoQuality:this.config.videoQuality,horizontal:this.config.horizontal};this.logger.info("#"+this.publishStreamId+"#  Preview  config "+JSON.stringify(t)),this.zg.startPreview(this.localVideo.nativeElement,t,function(){e.logger.info("#"+e.publishStreamId+"#preview success"),e.publishStream(),e.localVideo.nativeElement.muted=!e.config.muted},function(t){e.logger.errors("#"+e.publishStreamId+"#Preview  error "+JSON.stringify(t))})},e.prototype.togglePullStream=function(){var e=this;this.alertCtrl.create({title:"",message:"请输入拉流ID，多个流用逗号隔开",inputs:[{name:"pullStreamIds",placeholder:"Title"}],buttons:[{text:"取消",handler:function(e){console.log("Cancel clicked")}},{text:"确定",handler:function(t){for(var n=0;n<e.useLocalStreamList.length;n++)e.zg.stopPlayingStream(e.useLocalStreamList[n].stream_id);e.useLocalStreamList=[],t.pullStreamIds.split(",").forEach(function(t){e.useLocalStreamList.push({stream_id:t})}),e.useLocalStreamList=e.useLocalStreamList.slice(),e.addedVideo=e.useLocalStreamList.slice()}}]}).present()},e.prototype.listen=function(){var e=this,t={onPlayStateUpdate:function(t,n,i){if(0==t)e.logger.info("#"+n+"# play  success"),e.status["pull"+n]="play suc";else if(2==t)e.logger.info("#"+n+"# play retry");else{e.status["pull"+n]="play err",e.logger.errors("#"+n+"# play error "+i.msg);var r=i.msg;if(i.msg&&i.msg.indexOf("server session closed, reason: ")>-1){var l=i.msg.replace("server session closed, reason: ","");21==l?r="音频编解码不支持(opus)":22==l?r="视频编解码不支持(H264)":20==l&&(r="sdp 解释错误")}e.alertCtrl.create({title:"拉流"+n+"失败，"+r}).present()}e.status=$({},e.status)},onPublishStateUpdate:function(t,n,i){if(0==t)e.status["push"+n]="publish suc",e.logger.info("#"+n+"# publish  success");else if(2==t)e.logger.info("#"+n+"# publish  retry");else{e.status["push"+n]="publish err",e.logger.errors("#"+n+"# publish error "+i.msg);var r=i.msg;if(i.msg&&i.msg.indexOf("server session closed, reason: ")>-1){var l=i.msg.replace("server session closed, reason: ","");21==l?r="音频编解码不支持(opus)":22==l?r="视频编解码不支持(H264)":20==l&&(r="sdp 解释错误")}e.alertCtrl.create({title:"推流"+n+"失败，"+r}).present()}e.status=$({},e.status)},onPublishQualityUpdate:function(t,n){e.logger.info("#"+t+"#publish  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onPlayQualityUpdate:function(t,n){e.logger.info("#"+t+"#play  audio: "+n.audioBitrate+" video: "+n.videoBitrate+" fps: "+n.videoFPS)},onDisconnect:function(t){e.logger.errors("onDisconnect "+JSON.stringify(t)),e.alertCtrl.create({title:"网络连接已断开："+JSON.stringify(t)}).present(),e.logoutRoom()},onKickOut:function(t){e.logger.errors("onKickOut "+JSON.stringify(t))},onStreamExtraInfoUpdated:function(e){},onVideoSizeChanged:function(t,n,i){e.logger.info("#"+t+"#play  : "+n+"x"+i)},onStreamUpdated:function(t,n){if(t==ee){for(var i=0;i<n.length;i++)e.logger.info("#"+n[i].stream_id+"# was added"),e.useLocalStreamList.push(n[i]),e.addedVideo.push(n[i]);e.addedVideo.forEach(function(t){e.status["pull"+t.stream_id]="pulling"}),e.status=$({},e.status)}else if(t==te)for(var r=0;r<e.useLocalStreamList.length;r++)for(var l=0;l<n.length;l++)if(e.useLocalStreamList[r].stream_id===n[l].stream_id){e.zg.stopPlayingStream(e.useLocalStreamList[r].stream_id),e.logger.info("#"+e.useLocalStreamList[r].stream_id+"# was deleted "),e.useLocalStreamList.splice(r,1);break}},onUserStateUpdate:function(t,n){e.logger.info("onUserStateUpdate = "+t+JSON.stringify(n))}};for(var n in t)this.zg[n]=t[n]},e.prototype.ionViewWillUnload=function(){this.logger.info("beafore unload"),this.loginRoom&&(this.leaveRoom(),this.loginRoom=!1)},e.prototype.leaveRoom=function(){this.logger.info("leave room  and close stream"),this.zg.stopPreview(this.localVideo.nativeElement),this.zg.stopPublishingStream(this.publishStreamId);for(var e=0;e<this.useLocalStreamList.length;e++)this.zg.stopPlayingStream(this.useLocalStreamList[e].stream_id);this.zg.logout()},e.prototype.logoutRoom=function(){if(this.logger.info("#"+this.publishStreamId+"# logout"),this.loginRoom){try{this.leaveRoom()}catch(e){console.error(e)}this.loginRoom=!1}this.navCtrl.canGoBack()?this.navCtrl.pop():this.navCtrl.goToRoot({animate:!0})},e.prototype.showLogs=function(){this.navCtrl.push(q)},e.prototype.identify=function(e,t){return t.stream_id},e}(),ie=function(){function e(e,t){this.navCtrl=e,this.alertCtrl=t,this.items=[{version:"1.1.4",details:["火狐浏览器在预览途中，退出预览；导致后续不能再退出","解决房间名称为no name问题","混流接口优化","推拉流添加鉴权","拉流创建session参数type纠正","消息category改为与native一致","预览接口兼容火狐最新版","同房间流名冲突，拉流不报错，内部直接重新拉流","gw服务重试次数5次调整为3次"]},{version:"1.1.3",details:["解决测试环境推流成功回调失败问题"]},{version:"1.1.2",details:["拉流改为offer模式"]}]}return e.prototype.ngAfterViewInit=function(){var e=this;this.navBar.backButtonClick=function(t){e.navCtrl.pop()}},e}(),re=function(){function e(e,t,n,i,r){this.navCtrl=e,this.logger=t,this.config=n,this.alertCtr=i,this.storage=r,this.roomId="",this.isPublish=!0,this.isLogin=!1,this.streamId="",this.pullstreamId="",this.signUrl="",this.authTokenUrl="",this.appNode="",this.isPublishAudio=!0,this.isPublishVideo=!0,this.isPullAudio=!0,this.isPullVideo=!0,console.log("DeveloperPage start"),this.appId=this.config.appId}return e.prototype.ngOnInit=function(){var e=this;this.storage.get("develop_setting").then(function(t){t?(e.roomId=t.roomId,e.isPublish=t.isPublish,e.isLogin=t.isLogin,e.streamId=t.publishStreamId,e.pullstreamId=t.pullstreamIds,e.signUrl=t.signUrl||"wss://webrtctest.zego.im/ws?a=webrtc-demo",e.authTokenUrl=t.authTokenUrl||"",e.appNode=t.appNode||"",e.isPublishAudio=void 0===t.isPublishAudio||t.isPublishAudio,e.isPublishVideo=void 0===t.isPublishVideo||t.isPublishVideo,e.isPullAudio=void 0===t.isPullAudio||t.isPullAudio,e.isPullVideo=void 0===t.isPullVideo||t.isPullVideo):e.signUrl="wss://webrtctest.zego.im/ws?a=webrtc-demo"})},e.prototype.openRoom=function(){var e=this,t={roomId:this.roomId,publishStreamId:this.streamId,pullstreamIds:this.pullstreamId,isPublish:this.isPublish,isLogin:this.isLogin,signUrl:this.signUrl,isTest:1,isPublishAudio:this.isPublishAudio,isPublishVideo:this.isPublishVideo,isPullAudio:this.isPullAudio,isPullVideo:this.isPullVideo,authTokenUrl:this.authTokenUrl,appNode:this.appNode};return this.roomId=this.roomId&&this.roomId.replace(/^\s+|\s+$/gm,""),this.roomId?"number"!=typeof(1*this.appId)?(this.logger.info("input appid is not number!"),void this.alertCtr.create({title:"appid只能是数字"}).present()):this.signUrl&&this.signUrl.indexOf("wss")<0?(this.logger.info("signUrl   is not correct!"),void this.alertCtr.create({title:"signUrl必须是wss开头"}).present()):(this.config.appId=1*this.appId,void this.storage.set("develop_setting",t).then(function(){t.signUrl&&(t.roomId="zego-developement"+t.roomId),e.navCtrl.push(ne,t,{animate:!1})})):(this.logger.info("input roomId is empty!"),void this.alertCtr.create({title:"请输入房间号"}).present())},e.prototype.openSetting=function(){this.navCtrl.push(B,{},{animate:!0})},e.prototype.openHistory=function(){this.navCtrl.push(ie,{},{animate:!0})},e}(),le=function(){function e(e,t){this.params=e,this.viewCtrl=t}return e.prototype.ngAfterViewInit=function(){jQuery(this.qrData.nativeElement).qrcode({text:this.params.get("text"),width:200,height:200,colorDark:"#000000",colorLight:"#ffffff"})},e.prototype.dismiss=function(){this.viewCtrl.dismiss()},e}(),se=function(){function e(e,t,n,i,r,l){this.navCtrl=e,this.logger=t,this.config=n,this.alertCtr=i,this.storage=r,this.modalCtrl=l,this.title="",this.appKey="",this.testenv=!1,console.log("ToolConfigPage start")}return e.prototype.ngOnInit=function(){var e=this;this.storage.get("toolConfig").then(function(t){t&&(e.appId=t.appid,e.appKey=t.appkey,e.testenv=t.testenv,e.businessType=t.businesstype,e.title=t.title)})},e.prototype.openQRCode=function(){var e=this,t={data:{appid:1*this.appId,businesstype:1*this.businessType,appkey:this.appKey,testenv:this.testenv,title:this.title},type:"ac"};this.storage.set("toolConfig",t.data).then(function(){var n=O.utf16to8(JSON.stringify(t));e.logger.info("toolconfig:"+n);e.modalCtrl.create(le,{text:decodeURIComponent(n)},{showBackdrop:!0,enableBackdropDismiss:!0}).present()})},e.prototype.goback=function(){this.navCtrl.canGoBack()?this.navCtrl.pop():this.navCtrl.push(K)},e}(),oe=function(){return function(){}}(),ae=n(62),ue=n(240),ce=n(241),de=n(242),he=n(243),pe=n(244),ge=n(245),fe=n(246),me=n(247),ve=n(248),_e=n(249),be=n(53),ye=n(67),Ce=n(5),Se=n(14),Te=n(6),Ee=n(1),Re=n(4),Pe=n(8),Ie=n(46),Le=n(18),ke=n(7),Me=M.X({encapsulation:2,styles:[],data:{}}),we=M.V("ng-component",X,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"ng-component",[],null,null,null,i,Me)),M.Y(1,49152,null,0,X,[Re.a,w.a,U.a],null,null)],null,null)},{},{},[]),Ue=n(68),ze=n(41),Oe=n(136),De=n(24),Ne=n(54),Ae=n(33),xe=n(26),je=n(34),Ye=n(17),qe=n(20),Ze=n(48),Ve=n(49),He=n(13),Be=n(11),Fe=n(29),Ge=n(32),We=n(25),Je=n(92),Qe=n(52),Ke=n(16),Xe=n(200),$e=n(70),et=n(137),tt=n(59),nt=n(30),it=n(10),rt=n(22),lt=n(15),st=n(28),ot=M.X({encapsulation:2,styles:[],data:{}}),at=M.V("page-setting",B,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-setting",[],null,null,null,s,ot)),M.Y(1,4243456,null,0,B,[Se.a,N,st.a],null,null)],null,null)},{},{},[]),ut=n(93),ct=n(39),dt=n(40),ht=n(38),pt=n(72),gt=M.X({encapsulation:2,styles:[],data:{}}),ft=M.V("page-home",K,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-home",[],null,null,null,o,gt)),M.Y(1,114688,null,0,K,[Se.a,Y,pt.a,st.a],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),mt=n(65),vt=n(94),_t=n(37),bt=n(31),yt=n(12),Ct=M.X({encapsulation:2,styles:[],data:{}}),St=M.V("page-room",H,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-room",[],null,null,null,d,Ct)),M.Y(1,4243456,null,0,H,[Se.a,yt.a,N,A,Y,st.a],null,null)],null,null)},{},{},[]),Tt=M.X({encapsulation:2,styles:[],data:{}}),Et=M.V("page-devroom",ne,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-devroom",[],null,null,null,f,Tt)),M.Y(1,4243456,null,0,ne,[Se.a,yt.a,N,A,Y,st.a],null,null)],null,null)},{},{},[]),Rt=M.X({encapsulation:2,styles:[],data:{}}),Pt=M.V("page-setting",q,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-setting",[],null,null,null,_,Rt)),M.Y(1,4243456,null,0,q,[Se.a,Y,N,st.a],null,null)],null,null)},{},{},[]),It=n(106),Lt=n(108),kt=n(107),Mt=M.X({encapsulation:2,styles:[],data:{}}),wt=M.V("page-developer",re,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-developer",[],null,null,null,b,Mt)),M.Y(1,114688,null,0,re,[Se.a,Y,N,st.a,pt.a],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),Ut=M.X({encapsulation:2,styles:[],data:{}}),zt=M.V("screenshare-room",Q,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"screenshare-room",[],null,null,null,T,Ut)),M.Y(1,4243456,null,0,Q,[Se.a,yt.a,N,A,Y,st.a],null,null)],null,null)},{},{},[]),Ot=n(80),Dt=M.X({encapsulation:2,styles:[],data:{}}),Nt=M.V("page-history",ie,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-history",[],null,null,null,P,Dt)),M.Y(1,4243456,null,0,ie,[Se.a,st.a],null,null)],null,null)},{},{},[]),At=n(83),xt=M.X({encapsulation:2,styles:[],data:{}}),jt=M.V("page-tool",se,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"page-tool",[],null,null,null,I,xt)),M.Y(1,114688,null,0,se,[Se.a,Y,N,st.a,pt.a,At.a],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),Yt=n(126),qt=n(120),Zt=n(127),Vt=M.X({encapsulation:0,styles:["ion-content[_ngcontent-%COMP%] {\n      background: white;\n    }\n    \n    img[_ngcontent-%COMP%] {\n      margin-top: 10%;\n    }"],data:{}}),Ht=M.V("ng-component",le,function(e){return M._19(0,[(e()(),M.Z(0,0,null,null,1,"ng-component",[],null,null,null,L,Vt)),M.Y(1,4243456,null,0,le,[yt.a,Ce.a],null,null)],null,null)},{},{},[]),Bt=n(135),Ft=n(104),Gt=n(132),Wt=n(112),Jt=n(197),Qt=n(64),Kt=n(58),Xt=n(77),$t=n(117),en=n(131),tn=n(125),nn=n(196),rn=n(133),ln=n(44),sn=n(113),on=n(134),an=M.W(oe,[ae.b],function(e){return M._10([M._11(512,M.i,M.S,[[8,[ue.a,ce.a,de.a,he.a,pe.a,ge.a,fe.a,me.a,ve.a,we,at,ft,St,Et,Pt,wt,zt,Nt,jt,Ht]],[3,M.i],M.s]),M._11(5120,M.r,M._9,[[3,M.r]]),M._11(4608,it.k,it.j,[M.r,[2,it.s]]),M._11(5120,M.b,M._0,[]),M._11(5120,M.p,M._6,[]),M._11(5120,M.q,M._7,[]),M._11(4608,k.c,k.q,[it.c]),M._11(6144,M.D,null,[k.c]),M._11(4608,k.f,Bt.a,[]),M._11(5120,k.d,function(e,t,n,i,r){return[new k.k(e,t),new k.o(n),new k.n(i,r)]},[it.c,M.u,it.c,it.c,k.f]),M._11(4608,k.e,k.e,[k.d,M.u]),M._11(135680,k.m,k.m,[it.c]),M._11(4608,k.l,k.l,[k.e,k.m]),M._11(6144,M.B,null,[k.l]),M._11(6144,k.p,null,[k.m]),M._11(4608,M.G,M.G,[M.u]),M._11(4608,k.h,k.h,[it.c]),M._11(4608,k.i,k.i,[it.c]),M._11(4608,z.h,z.m,[it.c,M.w,z.k]),M._11(4608,z.n,z.n,[z.h,z.l]),M._11(5120,z.a,function(e){return[e]},[z.n]),M._11(4608,z.j,z.j,[]),M._11(6144,z.i,null,[z.j]),M._11(4608,z.g,z.g,[z.i]),M._11(6144,z.b,null,[z.g]),M._11(5120,z.f,z.o,[z.b,[2,z.a]]),M._11(4608,z.c,z.c,[z.f]),M._11(4608,Ke.k,Ke.k,[]),M._11(4608,Ke.c,Ke.c,[]),M._11(5120,pt.a,pt.c,[pt.b]),M._11(4608,Ft.a,Ft.a,[Te.a,Ee.a]),M._11(4608,st.a,st.a,[Te.a,Ee.a]),M._11(4608,Gt.a,Gt.a,[]),M._11(4608,Be.a,Be.a,[]),M._11(4608,nt.a,nt.a,[Re.a]),M._11(4608,qe.a,qe.a,[Ee.a,Re.a,M.u,ke.a]),M._11(4608,Wt.a,Wt.a,[Te.a,Ee.a]),M._11(5120,it.f,Jt.b,[it.q,[2,it.a],Ee.a]),M._11(4608,it.e,it.e,[it.f]),M._11(5120,Qt.b,Qt.d,[Te.a,Qt.a]),M._11(5120,Le.a,Le.b,[Te.a,Qt.b,it.e,Kt.b,M.i]),M._11(4608,At.a,At.a,[Te.a,Ee.a,Le.a]),M._11(4608,Xt.a,Xt.a,[Te.a,Ee.a]),M._11(4608,$t.a,$t.a,[Te.a,Ee.a,Le.a]),M._11(4608,en.a,en.a,[Ee.a,Re.a,ke.a,Te.a,Pe.l]),M._11(4608,tn.a,tn.a,[Te.a,Ee.a]),M._11(4608,Ie.a,Ie.a,[Re.a,Ee.a]),M._11(4608,w.a,w.a,[]),M._11(4608,U.a,U.a,[]),M._11(4608,N,N,[z.c]),M._11(4608,Y,Y,[z.c,N]),M._11(4608,A,A,[]),M._11(512,it.b,it.b,[]),M._11(512,M.k,nn.a,[]),M._11(256,Ee.b,{},[]),M._11(1024,rn.a,rn.b,[]),M._11(1024,Re.a,Re.b,[k.b,rn.a,M.u]),M._11(1024,Ee.a,Ee.c,[Ee.b,Re.a]),M._11(512,ke.a,ke.a,[Re.a]),M._11(512,ln.a,ln.a,[]),M._11(512,Te.a,Te.a,[Ee.a,Re.a,[2,ln.a]]),M._11(512,Pe.l,Pe.l,[Te.a]),M._11(256,Qt.a,{links:[{component:re,name:"developer",segment:"test"},{component:se,name:"config",segment:"config"},{component:ie,name:"sdk",segment:"sdk"}]},[]),M._11(512,M.h,M.h,[]),M._11(512,sn.a,sn.a,[M.h]),M._11(1024,Kt.b,Kt.c,[sn.a,M.o]),M._11(1024,M.c,function(e,t,n,i,r,l,s,o,a,u,c,d,h){return[k.s(e),on.a(t),Gt.b(n,i),en.b(r,l,s,o,a),Kt.d(u,c,d,h)]},[[2,M.t],Ee.a,Re.a,ke.a,Ee.a,Re.a,ke.a,Te.a,Pe.l,Ee.a,Qt.a,Kt.b,M.u]),M._11(512,M.d,M.d,[[2,M.c]]),M._11(131584,M.f,M.f,[M.u,M.T,M.o,M.k,M.i,M.d]),M._11(512,M.e,M.e,[M.f]),M._11(512,k.a,k.a,[[3,k.a]]),M._11(512,z.e,z.e,[]),M._11(512,z.d,z.d,[]),M._11(512,F.a,F.a,[]),M._11(512,Ke.j,Ke.j,[]),M._11(512,Ke.d,Ke.d,[]),M._11(512,Ke.i,Ke.i,[]),M._11(512,Jt.a,Jt.a,[]),M._11(512,oe,oe,[]),M._11(256,z.k,"XSRF-TOKEN",[]),M._11(256,z.l,"X-XSRF-TOKEN",[]),M._11(256,pt.b,null,[]),M._11(256,ae.a,X,[]),M._11(256,it.a,"/",[])])});Object(M.M)(),Object(k.j)().bootstrapModuleFactory(an)},60:function(e,t,n){!function(t,n){e.exports=n()}("undefined"!=typeof self&&self,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=25)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROTO_VERSION="1.1.5",function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.report=99]="report",e[e.disable=100]="disable"}(t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={})),function(e){e[e.disable=0]="disable",e[e.websocket=1]="websocket",e[e.https=2]="https"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}));var i=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._id=null,this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=i;var r=function(){function e(){this.start=new i,this.end=new i,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var n=new i(this._idCounter,t);return n.next=e,n.prev=e.prev,e.prev.next=n,e.prev=n,++this._idCounter,++this._numNodes,n},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,n=this.start.next;if(e>=0)for(;t<e&&null!==n;)n=n.next,++t;else n=null;if(null===n)throw"Index out of bounds.";return n},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev.next=e.next,e.next.prev=e.prev,--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,n=!1,i=null;t.hasNext()&&!n;)e(t=t.next)&&(i=t,n=!0);return i},e.prototype.map=function(e){for(var t=this.start,n=[];t.hasNext();)e(t=t.next)&&n.push(t);return n},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this.insertBefore(this._numNodes>0?this.start.next:this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=r,t.sdkErrorList={SUCCESS:{code:"ZegoClient.Success",msg:"success."},PARAM:{code:"ZegoClient.Error.Param",msg:"input error."},HEARTBEAT_TIMEOUT:{code:"ZegoClient.Error.Timeout",msg:"heartbeat timeout."},LOGIN_TIMEOUT:{code:"ZegoClient.Error.Timeout",msg:"login timeout."},SEND_MSG_TIMEOUT:{code:"ZegoClient.Error.Timeout",msg:"send customsg timeout."},RESET_QUEUE:{code:"ZegoClient.Error.Timeout",msg:"msg waiting ack is clear when reset."},LOGIN_DISCONNECT:{code:"ZegoClient.Error.Network",msg:"network is broken and login fail."},KICK_OUT:{code:"ZegoClient.Error.Kickout",msg:"kickout reason="},UNKNOWN:{code:"ZegoClient.Error.Unknown",msg:"unknown error."},FREQ_LIMITED:{code:"ZegoClient.Error.requencyLimited",msg:"Frequency Limited."}},function(e){e[e.disconnected=0]="disconnected",e[e.connecting=1]="connecting",e[e.connected=2]="connected"}(t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={})),t.ENUM_RESOLUTION_TYPE={LOW:{width:240,height:320,frameRate:15,bitRate:300},MEDIUM:{width:480,height:640,frameRate:15,bitRate:800},HIGH:{width:720,height:1280,frameRate:20,bitRate:1500}},t.ENUM_RETRY_STATE={didNotStart:0,retrying:1,finished:2},t.ENUM_PUBLISH_STATE={start:0,waitingSessionRsp:1,waitingOffserRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,publishing:6,stop:7,didNotStart:8},t.ENUM_PLAY_STATE={start:0,waitingSessionRsp:1,waitingOffserRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,playing:6,stop:7,didNotStart:8},t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.MAX_TRY_CONNECT_COUNT=3,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5},t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_UPDATE_TYPE={added:0,deleted:1},function(e){e[e.logout=0]="logout",e[e.trylogin=1]="trylogin",e[e.login=2]="login"}(t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={})),t.ENUM_PUBLISH_STATE_UPDATE={start:0,error:1,retry:2},t.ENUM_PLAY_STATE_UPDATE={start:0,error:1,retry:2},t.MAX_TRY_LOGIN_COUNT=5,t.TRY_LOGIN_INTERVAL=[2e3,2e3,3e3,3e3,4e3],t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.SERVER_ERROR_CODE=1e4,t.MIXSTREAM_ERROR_CODE=1e4,function(e){e[e.low=1]="low",e[e.stantard=2]="stantard",e[e.hight=3]="hight",e[e.custome=4]="custome"}(t.QUALITYLEVEL||(t.QUALITYLEVEL={})),t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004},t.ENUM_PLAY_SOURCE_TYPE={auto:0,ultra:1},t.ENUM_DISPATCH_TYPE={cdn:0,ultra:1,customUrl:2},function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallPragram=2]="ClientType_SmallPragram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.checkConfigParam=function(e,t){return e.appid?e.server?(e.idName||t.error("ccp.0 idName must be string and not empty"),!0):(t.error("ccp.0 server must be string and not empty"),!1):(t.error("ccp.0 appid must be number"),!1)},e.checkLoginParam=function(e,t){return!0},e.registerCallback=function(e,t,n){var i,r;t.success&&(i=t.success),t.error&&(r=t.error),n[e+"SuccessCallback"]=i,n[e+"ErrorCallback"]=r},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.getServerError=function(e){var t={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",2002:"biz channel error",1e9:"liveroom cmd error, result="};if(0===e)return{code:"ZegoClient.Success",msg:"success"};var n={code:"ZegoClient.Error.Server",msg:""};return n.msg=e>1e9?t[1e9]+e:t[e]?"unknown error code:"+e:t[e],n},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeStreamList=function(e,t,n,i,r){e.debug("msl.0 call");for(var l,s=[],o=[],a=[],u=0;u<i.length;u++)if(i[u].anchor_id_name!=t){l=!1;for(var c=0;c<n.length;c++)if(i[u].stream_id===n[c].stream_id){i[u].extra_info!==n[c].extra_info&&a.push(i[u]),l=!0;break}l||s.push(i[u])}else e.debug("msl.0 have self stream added");for(var d=0;d<n.length;d++){l=!1;for(var h=0;h<i.length;h++)if(i[h].anchor_id_name!=t){if(n[d].stream_id===i[h].stream_id){l=!0;break}}else e.debug("msl.0 have self stream deleted");l||o.push(n[d])}n=i,r(s,o,a),e.debug("msl.0 call success")},e.checkCustomCommandParam=function(e){return!0},e.generateRandumNumber=function(e){return parseInt(Math.random()*(e+1)+"",10)},e.isSupportWebrtc=function(){var e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,n=window.WebSocket;return!!e&&!!t&&!!n},e.isSupportH264=function(e,t){new RTCPeerConnection(null).createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1}).then(function(t){if(t&&t.sdp){var n=t.sdp.split("\r\n").some(function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H264/")>-1});e(n)}},function(e){t(e)})},e}();t.ClientUtil=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.playErrorList={DISPATCH_ERROR:{code:"ZegoPlayWeb.Error.Dispatch",msg:"dispatch request error"},DISPATCH_TIMEOUT:{code:"ZegoPlayWeb.Timeout.Dispatch",msg:"dispatch request timeout"},TOKEN_ERROR:{code:"ZegoPlayWeb.Error.Token",msg:"login token error"},SEND_SESSION_TIMEOUT:{code:"ZegoPlayWeb.Timeout.Session",msg:"send session request timeout"},CREATE_SESSION_ERROR:{code:"ZegoPlayWeb.Error.Session",msg:"create session error"},CREATE_OFFER_ERROR:{code:"ZegoPublish.Error.CreateOffer",msg:"create offer error"},SERVER_MEDIA_DESC_TIMEOUT:{code:"ZegoPlayWeb.Timeout.RemoteOffer",msg:"wating server mediaDesc timeout"},SET_REMOTE_DESC_ERROR:{code:"ZegoPlayWeb.Error.RemoteOffer",msg:"other side offer error"},CREATE_ANSWER_ERROR:{code:"ZegoPlayWeb.Error.CreateAnswer",msg:"create offer error"},SET_LOCAL_DESC_ERROR:{code:"ZegoPlayWeb.Error.LocalDesc",msg:"setLocalDescription error"},SEND_MEDIA_DESC_TIMEOUT:{code:"ZegoPlayWeb.Timeout.Desc",msg:"send mediaDesc timeout"},SEND_CANDIDATE_ERROR:{code:"ZegoPlayWeb.Error.Candidate",msg:"send candidate error"},SEND_CANDIDATE_TIMEOUT:{code:"ZegoPlayWeb.Timeout.Candidate",msg:"send candidate timeout"},SERVER_CANDIDATE_TIMEOUT:{code:"ZegoPlayWeb.Timeout.ServerCandidate",msg:"waiting candidate timeout"},SERVER_CANDIDATE_ERROR:{code:"ZegoPlayWeb.Error.ServerCandidate",msg:"recv candidate error"},MEDIA_CONNECTION_FAILED:{code:"ZegoPlayWeb.Error.ConnectionFailed",msg:"ice Connection state failed"},MEDIA_CONNECTION_CLOSED:{code:"ZegoPlayWeb.Error.ConnectionClosed",msg:"ice connection state closed"},SESSION_CLOSED:{code:"ZegoPlayWeb.Error.SessionClosed",msg:"server session closed"},WEBSOCKET_ERROR:{code:"ZegoPlayWeb.Error.SocketError",msg:"network error"}},t.publishErrorList={DISPATCH_ERROR:{code:"ZegoPublish.Error.Dispatch",msg:"dispatch request error"},DISPATCH_TIMEOUT:{code:"ZegoPublish.Timeout.Dispatch",msg:"dispatch request timeout"},TOKEN_ERROR:{code:"ZegoPublish.Error.Token",msg:"login token error"},SEND_SESSION_TIMEOUT:{code:"ZegoPublish.Timeout.Session",msg:"send session request timeout"},CREATE_SESSION_ERROR:{code:"ZegoPublish.Error.Session",msg:"create session error"},CREATE_OFFER_ERROR:{code:"ZegoPublish.Error.CreateOffer",msg:"create offer error"},SET_LOCAL_DESC_ERROR:{code:"ZegoPublish.Error.LocalDesc",msg:"setLocalDescription error"},SEND_MEDIA_DESC_TIMEOUT:{code:"ZegoPublish.Timeout.Desc",msg:"send mediaDesc timeout"},SERVER_MEDIA_DESC_TIMEOUT:{code:"ZegoPublish.Timeout.ServerAnswer",msg:"waiting server mediaDesc timeout"},SERVER_MEDIA_DESC_ERROR:{code:"ZegoPublish.Error.ServerAnswer",msg:"server mediaDesc type error"},SET_REMOTE_DESC_ERROR:{code:"ZegoPublish.Error.RemoteDesc",msg:"other side offer error"},SEND_CANDIDATE_TIMEOUT:{code:"ZegoPublish.Timeout.Candidate",msg:"sendIceCandidate error"},SERVER_CANDIDATE_TIMEOUT:{code:"ZegoPublish.Timeout.ServerCandidate",msg:"waiting candidate timeout"},SERVER_CANDIDATE_ERROR:{code:"ZegoPublish.Error.ServerCandidate",msg:"recv candidate error"},SESSION_CLOSED:{code:"ZegoPublish.Error.SessionClosed",msg:"server session closed"},MEDIA_CONNECTION_FAILED:{code:"ZegoPublish.Error.IConnectionFailed",msg:"Iice Connection state failed"},MEDIA_CONNECTION_CLOSED:{code:"ZegoPublish.Error.ConnectionClosed",msg:"ice connection state closed"},WEBSOCKET_ERROR:{code:"ZegoPublish.Error.SocketError",msg:"network error"}},t.ENUM_PUBLISH_STATE_UPDATE={start:0,error:1,retry:2},t.ENUM_PLAY_STATE_UPDATE={start:0,error:1,retry:2,stop:3},t.ENUM_RETRY_STATE={didNotStart:0,retrying:1,finished:2},t.getSeq=(i=1,function(){return i++})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.zegoSdp=function(e){var t=e.split("\r\n"),n=[],i=[];t.forEach(function(e){var t=e.match(/a=rtpmap:(\d+)\s+((H264\/90000)|(opus\/48000\/2))/);t&&t[1]&&t[2]&&("H264/90000"===t[2]&&n.push(t[1]),"opus/48000/2"===t[2]&&i.push(t[1]))});var r=[];return t.map(function(e){var t=!0,l=e.match(/((a=rtcp-fb:)|(a=rtpmap:)|(a=fmtp:))(\d+)/);if(l&&l[5]&&(n.concat(i).some(function(e){return e==l[5]})||(t=!1)),e.indexOf("m=video")>-1)e=[(s=e.split(" "))[0],s[1],s[2]].concat(n).join(" ");else if(e.indexOf("m=audio")>-1){var s;e=[(s=e.split(" "))[0],s[1],s[2]].concat(i).join(" ")}t&&r.push(e)}),r.join("\r\n")},e}();t.sdpUtil=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this;this.instant=0,this.slow=0,this.clip=0;var t=new AudioContext||new webkitAudioContext;this.context=t,this.script=t.createScriptProcessor(2048,1,1),this.script.addEventListener("audioprocess",function(t){var n,i=t.inputBuffer.getChannelData(0),r=0,l=0;for(n=0;n<i.length;++n)r+=i[n]*i[n],Math.abs(i[n])>.99&&(l+=1);e.instant=Math.sqrt(r/i.length),e.slow=.95*e.slow+.05*e.instant,e.clip=l/i.length})}return e.prototype.connectToSource=function(e,t){console.log("SoundMeter connecting");try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==t&&t(null)}catch(e){console.error(e),void 0!==t&&t(e)}return this},e.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},e}();t.SoundMeter=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2),l=function(){function e(){this.testEnvironment=!1,this.configOK=!1,this.roomCreateFlag=1,this.runState=i.ENUM_RUN_STATE.logout,this.lastRunState=i.ENUM_RUN_STATE.logout,this.callbackList={},this.streamList=[],this.publishStreamList={},this.userQuerying=!1,this.userTempList=[],this.userSeq=0,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""},this.sendCommandMap={},this.sendCommandList=new i.LinkedList,this.sendDataMap={},this.sendDataList=new i.LinkedList,this.joinLiveCallbackMap={},this.joinLiveRequestMap={},this.streamUrlMap={},this.cmdCallback={},this.transSeqMap={},this.realyMessageList=[],this.relayTimer=null,this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImCallbackMap={},this.bigImTimer=null,this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0,this.bigImMessageList=[],this.tryLoginCount=0,this.tryLoginTimer=null,this.heartbeatTimer=null,this.sendDataCheckTimer=null,this.sendDataCheckInterval=2e3,this.sendDataTimeout=5e3,this.sendDataDropTimeout=1e4,this.sendDataCheckOnceCount=100,this.sendRoomMsgTime=0,this.SendRoomMsgInterval=500,this.cmdSeq=0}return e.prototype.isLogin=function(){return this.runState===i.ENUM_RUN_STATE.login},e.prototype.getRequestId=function(){return this.idName+"-"+r.getSeq()},e.prototype.getSignalCmdContent=function(e,t,n){var i={request_id:e,room_id:this.roomid,from_userid:this.idName,from_username:this.nickName,to_userid:t};return void 0!=n&&(i.result=n),JSON.stringify(i)},e}();t.StateCenter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e,t,n){this.logger=e,this.socketCenter=n,this.stateCenter=t}return e.prototype.requestJoinLive=function(e,t,n,r){this.logger.debug("zb.lh.rjl call");var l=this.stateCenter.getRequestId(),s=this.stateCenter.getSignalCmdContent(l,e);return void 0!=r&&(this.stateCenter.joinLiveCallbackMap[l]=r,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveRequest,s,e,t,n),!0)},e.prototype.inviteJoinLive=function(e,t,n,r){this.logger.debug("zb.lh.ijl call");var l=this.stateCenter.getRequestId(),s=this.stateCenter.getSignalCmdContent(l,e);return void 0!=r&&(this.stateCenter.joinLiveCallbackMap[l]=r,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveInvite,s,e,t,n),!0)},e.prototype.endJoinLive=function(e,t,n){this.logger.debug("zb.lh.ejl call");var r=this.stateCenter.getRequestId(),l=this.stateCenter.getSignalCmdContent(r,e);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveStop,l,e,t,n),!0},e.prototype.respondJoinLive=function(e,t,n,r){this.logger.debug("zb.lh.rpjl call");var l=this.stateCenter.joinLiveRequestMap[e];if(!l)return this.logger.info("zb.lh.rpjl no dest id name"),!1;var s=0;!0===t&&(s=1);var o=this.stateCenter.getSignalCmdContent(e,l,s);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveResult,o,l,n,r),delete this.stateCenter.joinLiveRequestMap[e],!0},e.prototype.sendSignalCmd=function(e,t,n,i,r){if(this.logger.debug("zb.lh.ssc call"),this.stateCenter.isLogin()){this.logger.debug("zb.lh.ssc send signal cmd "+e);this.socketCenter.sendMessage("signal",{sub_cmd:e,signal_msg:t,dest_id_name:[n]},i,r),this.logger.info("zb.lh.ssc call success")}else this.logger.error("zb.lh.ssc state error")},e.prototype.handlePushSignalMsg=function(e){if(this.stateCenter.isLogin()){var t=JSON.parse(e.body.signal_msg);switch(this.logger.debug("zb.lh.hpcm hpsm= ",t),e.body.sub_cmd){case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveRequest:this.handlePushJoinLiveRequestMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveResult:this.handlePushJoinLiveResultMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveInvite:this.handlePushJoinLiveInviteMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveStop:this.handlePushJoinLiveStopMsg(t)}this.logger.debug("zb.lh.hpsm call end")}else this.logger.warn("zb.lh.hpsm not login")},e.prototype.handlePushJoinLiveRequestMsg=function(e){var t=e.request_id;if("string"==typeof t){var n=e.from_userid;"string"==typeof n?(this.stateCenter.joinLiveRequestMap[t]=n,this.logger.info("zb.lh.hpjlrm onRecvJoinLiveRequest "+n),this.onRecvJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id)):this.logger.error("zb.lh.hpjlrm no from user")}else this.logger.error("zb.lh.hpjlrm no requestId")},e.prototype.onRecvJoinLiveRequest=function(e,t,n,i){},e.prototype.handlePushJoinLiveInviteMsg=function(e){var t=e.request_id;if("string"==typeof t){var n=e.from_userid;"string"==typeof n?(this.stateCenter.joinLiveRequestMap[t]=n,this.logger.info("zb.lh.hpjlim onRecvInviteJoinLiveRequest "+n),this.onRecvInviteJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id)):this.logger.error("zb.lh.hpjlim no from user")}else this.logger.error("zb.lh.hpjlim no requestId")},e.prototype.onRecvInviteJoinLiveRequest=function(e,t,n,i){},e.prototype.handlePushJoinLiveResultMsg=function(e){var t=e.request_id;if("string"==typeof t){var n=e.result;if(void 0!=n){var i=1==n;if(this.stateCenter.joinLiveCallbackMap[t]){var r=this.stateCenter.joinLiveCallbackMap[t];if(!r)return void this.logger.info("hpjlrm.o no callback");this.logger.info("zb.lh.hpjlrm joinLiveRequest/invite result "+i),delete this.stateCenter.joinLiveCallbackMap[t],r(i,e.from_userid,e.from_username)}}else this.logger.info("zb.lh.hpjlrm no result")}else this.logger.error("zb.lh.hpjlrm no requestId")},e.prototype.handlePushJoinLiveStopMsg=function(e){var t=e.request_id;"string"==typeof t?(this.logger.info("zb.lh.hpjlsm onRecvEndJoinLiveCommand "+e.from_userid),this.onRecvEndJoinLiveCommand(t,e.from_userid,e.from_username,e.room_id)):this.logger.error("zb.lh.hpjlsm no requestId")},e.prototype.onRecvEndJoinLiveCommand=function(e,t,n,i){},e}();t.LiveHandler=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),l=function(){function e(e,t,n){this.logger=e,this.socketCenter=n,this.stateCenter=t}return e.prototype.sendCustomCommand=function(e,t,n,i){var l=this;if(this.logger.debug("zb.mh.scc call"),!this.stateCenter.isLogin())return this.logger.error("zb.mh.scc state error"),!1;if(!e||0==e.length)return this.logger.error("zb.mh.scc dstMembers error"),!1;var s={from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,request_id:this.stateCenter.getRequestId(),custom_content:t||"",room_id:this.stateCenter.roomid},o={dest_id_name:e,custom_msg:JSON.stringify(s)};return r.ClientUtil.checkCustomCommandParam(o)?(this.socketCenter.registerRouter("custommsg",function(e){l.handleSendCustomMsgRsp(e)}),this.socketCenter.sendCustomMessage("custommsg",o,n,i),this.logger.info("zb.mh.scc call success"),!0):(this.logger.info("zb.mh.scc param error"),!1)},e.prototype.handleSendCustomMsgRsp=function(e){this.logger.debug("zb.mh.hscmrcall");var t,n=this.stateCenter.sendDataMap[e.header.seq];null!=n?("custommsg"!=(t=n._data).data.header.cmd?this.logger.error("zb.mh.hscmrcmd wrong"+t.data.header.cmd):0===e.body.err_code?null!=t.success&&t.success(e.header.seq,t.data.body.custom_msg):null!=t.error&&t.error(r.ClientUtil.getServerError(e.body.err_code),e.header.seq,t.data.body.custom_msg),delete this.stateCenter.sendDataMap[e.header.seq],this.stateCenter.sendDataList.remove(n)):this.logger.error("zb.mh.hscmrno found seq="+e.header.seq),this.logger.debug("zb.mh.hscmr  call success")},e.prototype.handlePushCustomMsg=function(e){var t=JSON.parse(e.body.custommsg);this.logger.debug("zb.mh.hpcm submsg=",t),this.onRecvCustomCommand(t.from_userid,t.from_username,t.custom_content)},e.prototype.onRecvCustomCommand=function(e,t,n){},e.prototype.sendRoomMsg=function(e,t,n,r,l){var s=this;if(this.logger.debug("zb.mh.srm call"),this.stateCenter.isLogin()){var o=Date.parse(new Date+"");if(this.stateCenter.sendRoomMsgTime>0&&this.stateCenter.sendRoomMsgTime+this.stateCenter.SendRoomMsgInterval>o)return this.logger.info("zb.mh.srm freq error"),void(l&&l(i.sdkErrorList.FREQ_LIMITED,0,e,t,n));this.stateCenter.sendRoomMsgTime=o,this.logger.debug("zb.mh.srm send fetch request");var a={msg_category:e,msg_type:t,msg_content:n};this.socketCenter.registerRouter("im_chat",function(e){s.handleSendRoomMsgRsp(e)}),this.socketCenter.sendCustomMessage("im_chat",a,r,l),this.logger.info("zb.mh.srm call success")}else this.logger.error("zb.mh.srm state error")},e.prototype.handleSendRoomMsgRsp=function(e){this.logger.debug("zb.mh.hsrmr call");var t,n=this.stateCenter.sendDataMap[e.header.seq];null!=n?("im_chat"!=(t=n._data).data.header.cmd?this.logger.error("zb.mh.hsrmr cmd wrong"+t.data.header.cmd):0===e.body.err_code?t.success&&t.success(e.header.seq,e.body.msg_id,t.data.body.msg_category,t.data.body.msg_type,t.data.body.msg_content):t.error&&t.error(r.ClientUtil.getServerError(e.body.err_code),e.header.seq,t.data.body.msg_category,t.data.body.msg_type,t.data.body.msg_content),delete this.stateCenter.sendDataMap[e.header.seq],this.stateCenter.sendDataList.remove(n)):this.logger.error("hzb.mh.hsrmr no found seq="+e.header.seq),this.logger.info("zb.mh.hsrmr call success")},e.prototype.onRecvRoomMsg=function(e,t,n){},e.prototype.sendReliableMessage=function(e,t,n,i){this.logger.debug("zb.mh.srirm call"),this.stateCenter.transSeqMap[e]&&delete this.stateCenter.transSeqMap[e],this.stateCenter.transSeqMap[e]={seq:0};this.socketCenter.sendMessage("trans",{trans_type:e,trans_data:t},n,i)},e.prototype.sendBigRoomMessage=function(e,t,n,i,r){var l=this;this.logger.debug("zb.mh.sbim call");var s=this.stateCenter.bigimTimeWindow,o=this.stateCenter.serverTimeOffset,a=(new Date).getTime()+o,u=(++this.stateCenter.cmdSeq).toString();if(void 0==i&&(i=null),void 0==r&&(r=null),this.stateCenter.bigImCallbackMap[u]={success:i,error:r},0==s){var c={msg_category:e,msg_type:t,msg_content:n,bigmsg_client_id:u};this.logger.debug("zb.mh.sbim no time window"),this.sendBigRoomMessageInternal([c],function(e){l.handleBigImMsgRsp(e)},r)}else{var d=Math.floor(a/s);if(this.logger.debug("currentIndex "+d+" lastTimeIndex "+this.stateCenter.bigImLastTimeIndex),this.stateCenter.bigImLastTimeIndex<d&&0==this.stateCenter.bigImMessageList.length){this.stateCenter.bigImLastTimeIndex=d;this.sendBigRoomMessageInternal([{msg_category:e,msg_type:t,msg_content:n,bigmsg_client_id:u}],function(e){l.handleBigImMsgRsp(e)},r)}else this.stateCenter.bigImMessageList.push({msg_category:e,msg_type:t,msg_content:n,bigmsg_client_id:u}),1==this.stateCenter.bigImMessageList.length&&this.setBigImTimer(o,s)}},e.prototype.handlePushMergeMsg=function(e){if(this.stateCenter.isLogin()){for(var t=0;t<e.body.messages.length;t++)14001===e.body.messages[t].sub_cmd&&this.handlePushBigRooMsg(e.body.messages[t].msg_body);this.logger.debug("zb.mh.hpmm call success")}else this.logger.error("zb.mh.hpmmnot login")},e.prototype.handlePushBigRooMsg=function(e){var t;try{t=JSON.parse(e)}catch(e){return void this.logger.warn("zb.mh.hpbrm parse json error")}if(t){for(var n=t.room_id,i=[],r=0;r<t.msg_data.length;r++){var l=t.msg_data[r];l.id_name!=this.stateCenter.idName?i.push({idName:l.id_name,nickName:l.nick_name,messageId:l.bigmsg_id,category:l.msg_category,type:l.msg_type,content:l.msg_content,time:l.send_time}):this.logger.debug("zb.mh.hpbrm self message")}0==i.length?this.logger.debug("zb.mh.hpbrm no other pushData except self"):this.onRecvBigRoomMessage(i,n),this.logger.debug("zb.mh.hpbrm call success")}else this.logger.warn("zb.mh.hpbrm cann't find message body")},e.prototype.onRecvBigRoomMessage=function(e,t){},e.prototype.sendBigRoomMessageInternal=function(e,t,n){this.logger.debug("zb.mh.sbim call");this.socketCenter.sendMessage("bigim_chat",{msgs:e},t,n)},e.prototype.handleBigImMsgRsp=function(e){if(this.stateCenter.isLogin()){this.stateCenter.bigimTimeWindow!=e.body.bigim_time_window&&(this.stateCenter.bigimTimeWindow=e.body.bigim_time_window);for(var t=0;t<e.body.msgs.length;t++){var n=e.body.msgs[t].bigmsg_client_id;if(this.stateCenter.bigImCallbackMap[n]){var i=this.stateCenter.bigImCallbackMap[n].success;null!=i&&i(e.header.seq,e.body.msgs[t].bigmsg_id),delete this.stateCenter.bigImCallbackMap[n]}}}else this.logger.info("zb.mh.hbmr not login")},e.prototype.setBigImTimer=function(e,t){var n=this,i=t-((new Date).getTime()+e)%t,l=r.ClientUtil.generateRandumNumber(t)+i;this.logger.info("zb.mh.sbt setTimer "+l),this.stateCenter.bigImTimer=setTimeout(function(){n.onBigImTimer()},l)},e.prototype.onBigImTimer=function(){var e=this,t=(new Date).getTime()+this.stateCenter.serverTimeOffset;this.stateCenter.bigImLastTimeIndex=Math.floor(t/this.stateCenter.bigimTimeWindow);for(var n=[],i=[],r=0;r<this.stateCenter.bigImMessageList.length&&!(r>=20);r++){var l=this.stateCenter.bigImMessageList[r];n.push({msg_category:l.msg_category,msg_type:l.msg_type,msg_content:l.msg_content,bigmsg_client_id:l.bigmsg_client_id}),i.push(l.bigmsg_client_id)}this.stateCenter.bigImMessageList.length>20?this.stateCenter.bigImMessageList.splice(0,20):this.stateCenter.bigImMessageList=[],this.sendBigRoomMessageInternal(n,function(t){e.handleBigImMsgRsp(t)},function(t,n){for(var r=0;r<i.length;r++){var l=i[r],s=e.stateCenter.bigImCallbackMap[l];s&&(null!=s.error&&s.error(t,n),delete e.stateCenter.bigImCallbackMap[l])}}),clearTimeout(this.stateCenter.bigImTimer),this.stateCenter.bigImTimer=null,this.stateCenter.bigImMessageList.length>0&&this.setBigImTimer(this.stateCenter.serverTimeOffset,this.stateCenter.bigimTimeWindow)},e.prototype.sendRelayMessage=function(e,t,n,i){this.logger.debug("zb.mh.srm call");var r=this.stateCenter.datiTimeWindow,l=this.stateCenter.serverTimeOffset;r>0?(this.stateCenter.realyMessageList.push({type:e,data:t,success:n,error:i}),1==this.stateCenter.realyMessageList.length&&this.setRelayTimer(l,r)):this.sendRelayMessageInternal(e,t,n,i)},e.prototype.sendRelayMessageInternal=function(e,t,n,i){this.logger.debug("zb.mh.srmi call");this.socketCenter.sendMessage("relay",{relay_type:e,relay_data:t},n,i)},e.prototype.setRelayTimer=function(e,t){var n=this,i=2*t-((new Date).getTime()+e)%t,l=r.ClientUtil.generateRandumNumber(i);this.logger.info("zb.mh.srt setTimer "+l),this.stateCenter.relayTimer=setTimeout(function(){n.onRelayTimer()},l)},e.prototype.onRelayTimer=function(){if(0!=this.stateCenter.realyMessageList.length){var e=this.stateCenter.realyMessageList[0];this.sendRelayMessageInternal(e.type,e.data,e.success,e.error),clearTimeout(this.stateCenter.relayTimer),this.stateCenter.relayTimer=null,this.stateCenter.realyMessageList.splice(0,1),this.stateCenter.realyMessageList.length>0&&this.setRelayTimer(this.stateCenter.serverTimeOffset,this.stateCenter.datiTimeWindow)}else this.logger.info("zb.mh.ort no relay data")},e.prototype.handlePushTransMsg=function(e){if(this.stateCenter.isLogin()){var t=e.body.trans_type,n=e.body.trans_seq;this.stateCenter.transSeqMap[t]?this.stateCenter.transSeqMap[t].seq=n:this.stateCenter.transSeqMap[t]={seq:n},e.body.trans_user_idname!=this.stateCenter.idName?this.onRecvReliableMessage(t,n,e.body.trans_data):this.logger.debug("zb.mh.hptr receive self trans message"),this.logger.info("zb.mh.hptr trans "+t+" seq "+n)}else this.logger.error("zb.mh.hptr not login")},e.prototype.onRecvReliableMessage=function(e,t,n){},e}();t.MessageHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),l=function(){function e(e,t,n){this.logger=e,this.socketCenter=n,this.stateCenter=t}return e.prototype.resetHeartbeat=function(){this.logger.debug("zb.hb.rht call"),clearTimeout(this.stateCenter.heartbeatTimer),this.stateCenter.heartbeatTimer=null,this.stateCenter.tryHeartbeatCount=0,this.logger.debug("zb.hb.rht call success")},e.prototype.hbLogout=function(e){},e.prototype.start=function(e){var t=this;if(this.logger.debug("zb.hb.sht call"),this.stateCenter.isLogin()){if(++this.stateCenter.tryHeartbeatCount>3)return this.logger.error("zb.hb.sht come to try limit"),void this.hbLogout(i.sdkErrorList.HEARTBEAT_TIMEOUT);this.logger.debug("zb.hb.sht send packet"),this.socketCenter.registerRouter("hb",function(e){t.handleHeartbeatRsp(e)}),this.socketCenter.sendMessage("hb",{reserve:0}),this.logger.debug("zb.hb.sht call success"),this.stateCenter.heartbeatInterval=e,this.stateCenter.heartbeatTimer=setTimeout(function(){t.start(t.stateCenter.heartbeatInterval)},this.stateCenter.heartbeatInterval)}else this.logger.error("zb.hb.sht state error")},e.prototype.handleHeartbeatRsp=function(e){if(this.logger.debug("zb.hb.hhbr call"),0!==e.body.err_code)return this.logger.error("zb.hb.hhbr call disconnect, server error=",e.body.err_code),void this.hbLogout(r.ClientUtil.getServerError(e.body.err_code));for(var t in this.stateCenter.tryHeartbeatCount=0,this.stateCenter.heartbeatInterval=e.body.hearbeat_interval,this.stateCenter.heartbeatInterval<i.MINIUM_HEARTBEAT_INTERVAL&&(this.stateCenter.heartbeatInterval=i.MINIUM_HEARTBEAT_INTERVAL),e.body.bigim_time_window&&"number"==typeof e.body.bigim_time_window&&(this.stateCenter.bigimTimeWindow=e.body.bigim_time_window),e.body.dati_time_window&&"number"==typeof e.body.dati_time_window&&(this.stateCenter.datiTimeWindow=e.body.dati_time_window),this.ReliableMessageHandler(e),this.fetchStreamList(e),e.body.server_user_seq!==this.stateCenter.userSeq&&this.stateCenter.userStateUpdate&&(this.logger.info("zb.hb.hhbr call update user "+e.body.server_user_seq,this.stateCenter.userSeq),this.fetchUserList()),this.stateCenter.publishStreamList)this.stateCenter.publishStreamList[t].state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(this.logger.info("zb.hb.hhbr try to update stream info"),this.updateStreamInfo(t,i.ENUM_STREAM_SUB_CMD.liveBegin,this.stateCenter.publishStreamList[t].extra_info));void 0!=e.body.online_count&&0!=e.body.online_count&&this.onUpdateOnlineCount(this.stateCenter.roomid,e.body.online_count),this.logger.debug("zb.hb.hhbr call success")},e.prototype.ReliableMessageHandler=function(e){if(e.body.trans_seqs)for(var t=0;t<e.body.trans_seqs.length;t++){var n=e.body.trans_seqs[t].trans_type,i=e.body.trans_seqs[t].trans_seq;if(!this.stateCenter.transSeqMap[n]||this.stateCenter.transSeqMap[n].seq!==i){var r=0;this.stateCenter.transSeqMap[n]?(r=this.stateCenter.transSeqMap[n].seq,this.logger.debug("zb.hb.rmh type "+n+" old seq "+this.stateCenter.transSeqMap[n].seq+" server seq "+i)):(r=0,this.logger.debug("zb.hb.rmh type "+n+" server seq "+i)),this.fetchReliableMessage(n,r)}}},e.prototype.fetchReliableMessage=function(e,t){var n=this;this.logger.debug("zb.hb.frm call");var i={trans_type:e,trans_local_seq:t};this.socketCenter.registerRouter("trans_fetch",function(e){n.handleFetchTransRsp(e)}),this.socketCenter.sendMessage("trans_fetch",i),this.logger.debug("zb.hb.frm call success")},e.prototype.handleFetchTransRsp=function(e){if(this.stateCenter.isLogin())if(0==e.body.err_code){var t=e.body.trans_type,n=e.body.trans_seq;this.stateCenter.transSeqMap[t]={seq:n},e.body.trans_user_idname!=this.stateCenter.idName&&this.onRecvReliableMessage(t,n,e.body.trans_data),this.logger.debug("zb.hb.hftr trans "+t+" seq "+n)}else this.logger.error("zb.hb.hftr trans send error "+e.body.err_code);else this.logger.error("zb.hb.hftr not login")},e.prototype.fetchStreamList=function(e){var t=this;e.body.stream_seq!==this.stateCenter.streamSeq&&(this.logger.debug("zb.hb.fsl current seq "+this.stateCenter.streamSeq+" server Seq "+e.body.stream_seq),this.logger.debug("zb.hb.fsl call"),this.stateCenter.isLogin()?this.stateCenter.streamQuerying?this.logger.warn("zb.hb.fsl already doing"):(this.stateCenter.streamQuerying=!0,this.logger.debug("zb.hb.fsl send fetch request"),this.socketCenter.registerRouter("stream_info",function(e){t.handleFetchStreamListRsp(e)}),this.socketCenter.sendMessage("stream_info",{reserve:0}),this.logger.debug("zb.hb.fsl call success")):this.logger.error("zb.hb.fsl state error"))},e.prototype.handleFetchStreamListRsp=function(e){},e.prototype.fetchUserList=function(){},e.prototype.updateStreamInfo=function(e,t,n,i){void 0===n&&(n="")},e.prototype.onUpdateOnlineCount=function(e,t){},e.prototype.onRecvReliableMessage=function(e,t,n){},e.prototype.resetCheckMessage=function(){this.logger.debug("zb.hb.rcm call"),clearTimeout(this.stateCenter.sendDataCheckTimer),this.stateCenter.sendDataCheckTimer=null,this.checkSendMessageList(this.stateCenter.sendDataList),this.checkSendMessageList(this.stateCenter.sendCommandList),this.stateCenter.sendDataMap={},this.stateCenter.sendCommandMap={},this.logger.debug("zb.hb.rcm call success")},e.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)e.remove(t),t._data.error&&(t._data.data.body.custom_msg?t._data.error(i.sdkErrorList.SEND_MSG_TIMEOUT,t._data.data.header.seq,t._data.data.body.custom_msg):t._data.error(i.sdkErrorList.SEND_MSG_TIMEOUT,t._data.data.header.seq)),t=e.getFirst()},e.prototype.checkMessageListTimeout=function(e,t){for(var n=e.getFirst(),r=Date.parse(new Date+""),l=0,s=0,o=0;!(null==n||n._data.time+this.stateCenter.sendDataTimeout>r||(delete t[n._data.data.header.seq],e.remove(n),++s,null==n._data.error||this.stateCenter.sendDataDropTimeout>0&&n._data.time+this.stateCenter.sendDataDropTimeout<r?++o:n._data.data.body.custom_msg?n._data.error(i.sdkErrorList.SEND_MSG_TIMEOUT,n._data.data.header.seq,n._data.data.body.custom_msg):n._data.error(i.sdkErrorList.SEND_MSG_TIMEOUT,n._data.data.header.seq),++l>=this.stateCenter.sendDataCheckOnceCount));)n=e.getFirst();0==s&&0==o||this.logger.debug("zb.hb.cmt call success, stat: timeout=",s,"drop=",o)},e.prototype.startCheckMessageTimeout=function(){var e=this;this.stateCenter.isLogin()?(this.checkMessageListTimeout(this.stateCenter.sendDataList,this.stateCenter.sendDataMap),this.checkMessageListTimeout(this.stateCenter.sendCommandList,this.stateCenter.sendCommandMap),this.stateCenter.sendDataCheckTimer=setTimeout(function(){e.startCheckMessageTimeout()},this.stateCenter.sendDataCheckInterval)):this.logger.error("zb.hb.scmt state error")},e}();t.HeartBeatHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),l=function(){function e(e,t,n){this.logger=e,this.socketCenter=n,this.stateCenter=t}return e.prototype.setCDNInfo=function(e,t){},e.prototype.onStreamUpdated=function(e,t){},e.prototype.onStreamExtraInfoUpdated=function(e){},e.prototype.handleStreamStart=function(e,t){var n=this;if(this.stateCenter.streamQuerying=!1,this.socketCenter.registerRouter("stream",function(e){n.handleStreamUpdateRsp(e)}),this.socketCenter.registerRouter("push_stream_update",function(e){n.handlePushStreamUpdateMsg(e)}),e==i.ENUM_RUN_STATE.login)this.logger.info("zb.sh.hss recover from disconnect so call streamupdate"),this.handleFullUpdateStream(t.body.stream_seq,t.body.stream_info||[]);else{this.logger.info("zb.sh.hss success callback user"),this.stateCenter.streamList=t.body.stream_info||[],this.stateCenter.streamSeq=t.body.stream_seq;for(var l=0;l<this.stateCenter.streamList.length;l++)this.stateCenter.streamList[l].anchor_id_name==this.stateCenter.idName&&(this.updateStreamInfo(this.stateCenter.streamList[l].stream_id,i.ENUM_STREAM_SUB_CMD.liveEnd),this.stateCenter.streamList.splice(l,1));var s=this.makeCallbackStreamList(this.stateCenter.streamList);r.ClientUtil.actionSuccessCallback("login",this.stateCenter.callbackList)(s)}},e.prototype.onPublishStateUpdate=function(e,t,n){},e.prototype.updateStreamInfo=function(e,t,n,i){var r=this;void 0===n&&(n=""),this.logger.debug("zb.sh.usi call");var l={stream_id:e,extra_info:n},s={sub_cmd:t,stream_msg:JSON.stringify(l)};this.socketCenter.registerRouter("stream",function(e){r.handleStreamUpdateRsp(e)}),this.socketCenter.sendMessage("stream",s,void 0,i),this.logger.info("zb.sh.usi call success cmd "+t)},e.prototype.handleStreamUpdateRsp=function(e){if(this.stateCenter.isLogin())if(0==e.body.err_code){this.logger.info("zb.sh.hsur stream seq "+this.stateCenter.streamSeq+" server seq "+e.body.stream_seq),this.stateCenter.streamSeq=e.body.stream_seq;for(var t=0;t<e.body.stream_info.length;t++){var n=e.body.stream_info[t].stream_id;if(!this.stateCenter.publishStreamList[n])return void this.logger.info("hsur.0 stream is not exist");this.stateCenter.publishStreamList[n].state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(this.stateCenter.publishStreamList[n].state=i.ENUM_PUBLISH_STREAM_STATE.publishing,this.onPublishStateUpdate(0,n,0))}}else this.logger.error("zb.sh.hsur stream update error "+e.body.err_code);else this.logger.error("zb.sh.hsur not login")},e.prototype.handleFetchStreamListRsp=function(e){this.logger.info("zb.sh.hfslr call"),this.stateCenter.streamQuerying=!1,0===e.body.err_code?this.stateCenter.streamSeq!==e.body.stream_seq?(this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info),this.logger.debug("zb.sh.hfslr call success")):this.logger.info("zb.sh.hfslr same seq"):this.logger.info("zb.sh.hfslr server error=",e.body.err_code)},e.prototype.handleFullUpdateStream=function(e,t){var n=this;this.logger.debug("zb.sh.hfus call"),this.stateCenter.streamSeq=e,this.logger.debug("zb.sh.hfus server seq "+this.stateCenter.streamSeq),r.ClientUtil.mergeStreamList(this.logger,this.stateCenter.idName,this.stateCenter.streamList,t,function(e,t,r){0!==e.length&&(n.logger.debug("zb.sh.hfus callback addstream"),n.onStreamUpdated(i.ENUM_STREAM_UPDATE_TYPE.added,n.makeCallbackStreamList(e))),0!==t.length&&(n.logger.debug("zb.sh.hfus callback delstream"),n.onStreamUpdated(i.ENUM_STREAM_UPDATE_TYPE.deleted,n.makeCallbackStreamList(t))),0!==r.length&&(n.logger.debug("zb.sh.hfus callback updatestream"),n.onStreamExtraInfoUpdated(n.makeCallbackStreamList(r)))}),this.logger.info("zb.sh.hfus call success")},e.prototype.handlePushStreamUpdateMsg=function(e){if(this.logger.info("zb.sh.hpsum call"),e.body.stream_info&&0!==e.body.stream_info.length){if(e.body.stream_info.length+this.stateCenter.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.fetchStreamList();switch(this.stateCenter.streamSeq=e.body.stream_seq,e.body.stream_cmd){case i.ENUM_STREAM_UPDATE_CMD.added:this.handleAddedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.deleted:this.handleDeletedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.updated:this.handleUpdatedStreamList(e.body.stream_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handleAddedStreamList=function(e){this.logger.debug("zb.sh.hasl call");for(var t,n=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName){t=!1;for(var l=0;l<this.stateCenter.streamList.length;l++)if(e[r].stream_id===this.stateCenter.streamList[l].stream_id){t=!0;break}t||n.push(e[r])}else this.logger.debug("hdsl.0 have self stream added");if(0!==n.length){this.logger.debug("zb.sh.hasl callback addstream");for(var s=0;s<n.length;s++)this.stateCenter.streamList.push(n[s]);this.onStreamUpdated(i.ENUM_STREAM_UPDATE_TYPE.added,this.makeCallbackStreamList(n))}this.logger.info("zb.sh.hasl call success")},e.prototype.handleDeletedStreamList=function(e){this.logger.debug("zb.sh.hdsl call");for(var t=[],n=0;n<e.length;n++)if(e[n].anchor_id_name!=this.stateCenter.idName){for(var r=this.stateCenter.streamList.length-1;r>=0;r--)if(e[n].stream_id===this.stateCenter.streamList[r].stream_id){this.stateCenter.streamList.splice(r,1),t.push(e[n]);break}}else this.logger.debug("zb.sh.hdsl have self stream deleted");0!==t.length&&(this.logger.debug("zb.sh.hdsl callback delstream"),this.onStreamUpdated(i.ENUM_STREAM_UPDATE_TYPE.deleted,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.hdsl call")},e.prototype.handleUpdatedStreamList=function(e){this.logger.debug("zb.sh.husl call");for(var t=[],n=0;n<e.length;n++)if(e[n].anchor_id_name!=this.stateCenter.idName){for(var i=0;i<this.stateCenter.streamList.length;i++)if(e[n].stream_id===this.stateCenter.streamList[i].stream_id){e[n].extra_info!==this.stateCenter.streamList[i].extra_info&&(this.stateCenter.streamList[i]=e[n],t.push(e[n]));break}}else this.logger.debug("hsul.0 have self stream updated");0!==t.length&&(this.logger.debug("zb.sh.husl callback updatestream"),this.onStreamExtraInfoUpdated(this.makeCallbackStreamList(t))),this.logger.info("zb.sh.husl call success")},e.prototype.fetchStreamList=function(){this.logger.info("zb.sh.fsl call"),this.stateCenter.isLogin()?this.logger.info("zb.sh.fsl state error"):this.stateCenter.streamQuerying?this.logger.info("zb.sh.fsl already doing"):(this.stateCenter.streamQuerying=!0,this.logger.debug("zb.sh.fsl send fetch request"),this.socketCenter.registerRouter("stream_info",this.handleFetchStreamListRsp),this.socketCenter.sendMessage("stream_info",{reserve:0}),this.logger.debug("zb.sh.fsl call success"))},e.prototype.makeCallbackStreamList=function(e){var t=[];if(e&&e.length>0)for(var n=0;n<e.length;n++){var i={anchor_id_name:e[n].anchor_id_name,stream_gid:e[n].stream_gid,anchor_nick_name:e[n].anchor_nick_name,extra_info:e[n].extra_info,stream_id:e[n].stream_id,urls_flv:"",urls_rtmp:"",urls_hls:"",urls_https_flv:"",urls_https_hls:""};this.setCDNInfo(i,e[n]),t.push(i)}return t},e.prototype.updateMixStream=function(e,t,n){var l=this;if(this.logger.info("zb.sh.ums call"),void 0==e.outputStreamId&&void 0==e.outputUrl)return this.logger.error("zb.sh.ums no mix stream info"),!1;if(0==e.streamList.length)return this.logger.error("zb.sh.ums no input stream"),!1;var s={id_name:this.stateCenter.idName,live_channel:this.stateCenter.roomid,appid:this.stateCenter.appid,version:i.PROTO_VERSION};"string"==typeof e.userData&&e.userData.length<=1e4&&(s.UserData=e.userData);for(var o=[],a=0;a<e.streamList.length;a++){var u=e.streamList[a],c=u.streamId;this.stateCenter.testEnvironment&&(c="zegotest-"+this.stateCenter.appid+"-"+u.streamId),o.push({stream_id:c,rect:{layer:a,top:u.top,left:u.left,bottom:u.bottom,right:u.right}})}s.MixInput=o;var d={};if(void 0!=e.outputStreamId?d.stream_id=this.stateCenter.testEnvironment?"zegotest-"+this.stateCenter.appid+"-"+e.outputStreamId:e.outputStreamId:void 0!=e.outputUrl&&(d.mixurl=e.outputUrl),!e.outputBitrate)return this.logger.error("zb.sh.ums no bitrate param"),!1;if(d.bitrate=e.outputBitrate,!e.outputFps)return this.logger.error("zb.sh.ums no fps param"),!1;if(d.fps=e.outputFps,!e.outputWidth)return this.logger.error("zb.sh.ums no width param"),!1;if(d.width=e.outputWidth,!e.outputHeight)return this.logger.error("zb.sh.ums no height param"),!1;d.height=e.outputHeight,e.outputAudioConfig&&(d.audio_enc_id=e.outputAudioConfig),e.outputAudioBitrate&&(d.audio_bitrate=e.outputAudioBitrate),e.outputAudioChannels&&(d.audio_channel_cnt=e.outputAudioChannels),e.outputBgColor&&(d.output_bg_color=e.outputBgColor),e.outputBgImage&&(d.output_bg_image=e.outputBgImage),d.testenv=this.stateCenter.testEnvironment?1:0,s.MixOutput=[d];var h={channel:"zeus",cmd:"start_mix",req_body:JSON.stringify(s)};return this.logger.debug("zb.sh.ums send command"),this.socketCenter.sendMessage("biz_channel",h,function(s,o,a){l.logger.debug("zb.sh.ums receive message");var u="zegotest-"+l.stateCenter.appid+"-";if(0!=a.length){for(var c=JSON.parse(a),d=[],h=e.outputStreamId,p=0;p<c.play.length;p++){var g={rtmpUrls:null,hlsUrls:null,flvUrls:null};l.stateCenter.testEnvironment&&h.startsWith(u)&&(h=h.slice(u.length)),c.play[p].rtmp_url&&c.play[p].rtmp_url.length>0&&(g.rtmpUrls=[c.play[p].rtmp_url]),c.play[p].hls_url&&c.play[p].hls_url.length>0&&(g.hlsUrls=[c.play[p].hls_url]),c.play[p].hdl_url&&c.play[p].hdl_url.length>0&&(g.flvUrls=[c.play[p].hdl_url]),d.push(g)}t&&t(h,d)}else n&&n(r.ClientUtil.getServerError(i.MIXSTREAM_ERROR_CODE+1))},function(e,t,s){if("number"==typeof e){l.logger.debug("zb.sh.ums error: "+e);var o=[];if(1000000150==e&&0!=s.length)for(var a=JSON.parse(s),u="zegotest-"+l.stateCenter.appid+"-",c=0;c<a.non_exist_streams.length;c++){var d=a.non_exist_streams[c];l.stateCenter.testEnvironment&&d.startsWith(u)?o.push(d.slice(u.length)):o.push(d)}n&&n(r.ClientUtil.getServerError(i.MIXSTREAM_ERROR_CODE+e),o)}else l.logger.debug("zb.sh.ums error code "+e.code),n&&n(e)}),!0},e.prototype.stopMixStream=function(e,t,n){if(this.logger.info("zb.sh.sms call"),void 0==e.outputStreamId&&void 0==e.outputUrl)return this.logger.error("zb.sh.sms no mix stream info"),!1;var l={id_name:this.stateCenter.idName,live_channel:this.stateCenter.roomid,appid:this.stateCenter.appid,version:i.PROTO_VERSION};void 0!=e.outputStreamId?l.stream_id=this.stateCenter.testEnvironment?"zegotest-"+this.stateCenter.appid+"-"+e.outputStreamId:e.outputStreamId:void 0!=e.outputUrl&&(l.mixurl=e.outputUrl);var s={channel:"zeus",cmd:"stop_mix",req_body:JSON.stringify(l)};return this.socketCenter.sendMessage("biz_channel",s,function(e,n){t&&t()},function(e,t){"number"==typeof e?n&&n(r.ClientUtil.getServerError(i.MIXSTREAM_ERROR_CODE+e)):n&&n(e)}),!0},e.prototype.updateStreamExtraInfo=function(e,t){return this.logger.info("zb.sh.usei call"),e?"string"==typeof t&&(this.stateCenter.publishStreamList[e]&&(this.stateCenter.publishStreamList[e].extra_info=t,this.stateCenter.publishStreamList[e].state>=i.ENUM_PUBLISH_STREAM_STATE.update_info&&this.updateStreamInfo(e,i.ENUM_STREAM_SUB_CMD.liveUpdate,t)),!0):(this.logger.error("zb.sh.usei param error"),!1)},e}();t.StreamHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),l=function(){function e(e,t,n){this.logger=e,this.socketCenter=n,this.stateCenter=t}return e.prototype.setRunState=function(e){this.logger.debug("zb.rh.srs old="+this.stateCenter.runState+", new="+e),this.stateCenter.lastRunState=this.stateCenter.runState,this.stateCenter.runState=e},e.prototype.resetTryLogin=function(){this.logger.debug("zb.rh.rtl call"),clearTimeout(this.stateCenter.tryLoginTimer),this.stateCenter.tryLoginTimer=null,this.stateCenter.tryLoginCount=0,this.logger.debug("zb.rh.rtl call success")},e.prototype.resetBigRoomInfo=function(){this.stateCenter.transSeqMap={},this.stateCenter.realyMessageList=[],this.stateCenter.relayTimer&&(clearTimeout(this.stateCenter.relayTimer),this.stateCenter.relayTimer=null),this.stateCenter.bigImLastTimeIndex=0,this.stateCenter.bigIMmessageList=[],this.stateCenter.bigImCallbackMap={},this.stateCenter.bigImTimer&&(clearTimeout(this.stateCenter.bigImTimer),this.stateCenter.bigImTimer=null),this.stateCenter.serverTimeOffset=0,this.stateCenter.datiTimeWindow=0,this.stateCenter.bigimTimeWindow=0},e.prototype.resetRoom=function(){var e=this;this.logger.debug("zb.rh.rr call"),this.resetTryLogin(),this.resetRoomCallBack(),this.stateCenter.streamList=[],this.stateCenter.streamQuerying=!1,this.stateCenter.publishStreamList={},this.stateCenter.joinLiveCallbackMap={},this.stateCenter.joinLiveRequestMap={},this.stateCenter.streamUrlMap={},this.resetBigRoomInfo(),this.stateCenter.cmdCallback={},this.logger.debug("zb.rh.rr call send logout=",this.stateCenter.sessionid),"0"!==this.stateCenter.sessionid&&(this.socketCenter.registerRouter("logout",function(t){e.handleLogoutRsp(t)}),this.socketCenter.sendMessage("logout",{reserve:0})),this.socketCenter.closeSocket(),this.stateCenter.userid="",this.stateCenter.sessionid="",this.logger.setSessionInfo(this.stateCenter.appid,this.stateCenter.roomid,this.stateCenter.userid,this.stateCenter.idName,this.stateCenter.sessionid,i.PROTO_VERSION),this.logger.debug("zb.rh.rr call success")},e.prototype.resetRoomCallBack=function(){},e.prototype.onDisconnect=function(e){},e.prototype.loginSuccessCallBack=function(e,t){},e.prototype.onGetTotalUserList=function(e,t){},e.prototype.login=function(e,t,n,l,s){if(this.logger.setSessionInfo(this.stateCenter.appid,e,"",this.stateCenter.idName,"",i.PROTO_VERSION),this.logger.info("zb.rh.lg call:",e,n),!this.stateCenter.configOK||!r.ClientUtil.checkLoginParam(e,n))return this.logger.error("zb.rh.lg param error"),void s({code:"",msg:"param error"});this.stateCenter.runState!==i.ENUM_RUN_STATE.logout&&(this.logger.debug("zb.rh.lg reset"),this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom()),this.logger.debug("zb.rh.lg begin"),this.setRunState(i.ENUM_RUN_STATE.trylogin),this.stateCenter.roomid=e,this.stateCenter.token=n,this.stateCenter.role=t,r.ClientUtil.registerCallback("login",{success:l,error:s},this.stateCenter.callbackList),this.resetTryLogin(),this.tryLogin(),this.logger.info("zb.rh.lg call success")},e.prototype.loginBodyData=function(){return null},e.prototype.tryLogin=function(){var e=this;if(this.logger.debug("zb.rh.tl call"),this.stateCenter.runState===i.ENUM_RUN_STATE.trylogin){if(++this.stateCenter.tryLoginCount>i.MAX_TRY_LOGIN_COUNT){this.logger.error("zb.rh.tl fail times limit");var t=this.stateCenter.lastRunState;return this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom(),void(t==i.ENUM_RUN_STATE.login?(this.logger.error("zb.rh.tl fail and disconnect"),this.onDisconnect(i.sdkErrorList.LOGIN_DISCONNECT)):(this.logger.info("zb.rh.tl fail and callback user"),r.ClientUtil.actionErrorCallback("login",this.stateCenter.callbackList)(i.sdkErrorList.LOGIN_TIMEOUT)))}if(this.socketCenter.isDisConnect()){this.logger.debug("zb.rh.tl need new websocket");try{this.socketCenter.closeSocket(),this.logger.debug("zb.rh.tl new websocket"),this.socketCenter.createSocket(this.stateCenter.server),this.socketCenter.registerRouter("login",function(t,n){e.handleLoginRsp(t,n)}),this.socketCenter.closeHandler(function(t){e.closeHandler(t)}),this.socketCenter.openHandler(function(){e.openHandler()})}catch(e){this.logger.error("zb.rh.tl websocket err:"+e)}}else{var n=this.loginBodyData();this.logger.info("zb.rh.tl use current websocket and sent login"),this.socketCenter.sendMessage("login",n)}this.stateCenter.tryLoginTimer=setTimeout(function(){e.tryLogin()},i.TRY_LOGIN_INTERVAL[this.stateCenter.tryLoginCount%i.MAX_TRY_LOGIN_COUNT]),this.logger.info("zb.rh.tl call success")}else this.logger.error("zb.rh.tl state error")},e.prototype.handleLoginRsp=function(e,t){if(this.logger.debug("zb.rh.hlr call"),this.stateCenter.runState===i.ENUM_RUN_STATE.trylogin){if(e.header.seq===t)return 0!==e.body.err_code?(this.handleLoginFail(e),void this.logger.error("zb.rh.hlr server error=",e.body.err_code)):(this.handleLoginSuccess(e),void this.logger.info("zb.rh.hlr call success."));this.logger.error("zb.rh.hlr in wrong seq, local=",t,",recv=",e.header.seq)}else this.logger.error("zb.rh.hlr state error")},e.prototype.handleLoginFail=function(e){if(this.logger.debug("zb.rh.hlf call"),r.ClientUtil.isKeepTryLogin(e.body.err_code))this.logger.warn("zb.rh.hlf KeepTry true");else{var t=this.stateCenter.lastRunState;this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom();var n=r.ClientUtil.getServerError(e.body.err_code);t===i.ENUM_RUN_STATE.login?(this.logger.info("zb.rh.hlf callback disconnect"),this.onDisconnect(n)):(this.logger.info("zb.rh.hlf callback error"),r.ClientUtil.actionErrorCallback("login",this.stateCenter.callbackList)(n)),this.logger.debug("zb.rh.hlf call success")}},e.prototype.handleLoginSuccess=function(e){this.logger.info("zb.rh.hls call");var t=this.stateCenter.lastRunState;if(this.setRunState(i.ENUM_RUN_STATE.login),this.stateCenter.userid=e.body.user_id,this.stateCenter.sessionid=e.body.session_id,this.stateCenter.anchor_info=e.body.anchor_info||this.stateCenter.anchor_info,this.logger.setSessionInfo(this.stateCenter.appid,this.stateCenter.roomid,this.stateCenter.userid,this.stateCenter.idName,this.stateCenter.sessionid,i.PROTO_VERSION),e.body.config_info&&(this.logger.setRemoteLogLevel(e.body.config_info.log_level),""!=e.body.config_info.log_url&&this.logger.openLogServer(e.body.config_info.log_url)),void 0!=e.body.ret_timestamp&&"string"==typeof e.body.ret_timestamp){var n=parseFloat(e.body.ret_timestamp);this.stateCenter.serverTimeOffset=0==n?0:e.body.ret_timestamp-(new Date).getTime()}e.body.bigim_time_window&&"number"==typeof e.body.bigim_time_window&&(this.stateCenter.bigimTimeWindow=e.body.bigim_time_window),e.body.dati_time_window&&"number"==typeof e.body.dati_time_window&&(this.stateCenter.datiTimeWindow=e.body.dati_time_window),this.resetTryLogin(),this.loginSuccessCallBack(t,e)},e.prototype.openHandler=function(){this.logger.info("zb.rh.oh websocket.onpen call"),this.socketCenter.responseHandler();var e=this.loginBodyData();this.logger.info("zb.rh.oh websocket.onpen send login"),this.socketCenter.sendMessage("login",e),this.logger.debug("zb.rh.oh websocket.onpen call success")},e.prototype.closeHandler=function(e){this.logger.info("zb.rh.ws.oc msg="+JSON.stringify(e)),this.stateCenter.runState!==i.ENUM_RUN_STATE.logout?this.stateCenter.runState===i.ENUM_RUN_STATE.trylogin&&this.stateCenter.tryLoginCount<=i.MAX_TRY_LOGIN_COUNT?this.logger.info("zb.rh.ws.oc is called because of try login"):this.stateCenter.runState===i.ENUM_RUN_STATE.login?(this.logger.info("zb.rh.ws.oc is called because of network broken, try again"),this.setRunState(i.ENUM_RUN_STATE.trylogin),this.resetTryLogin(),this.tryLogin()):(this.logger.error("zb.rh.ws.oc out of think!!!"),this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom(),this.onDisconnect(i.sdkErrorList.UNKNOWN)):this.logger.info("zb.rh.ws.oc onclose logout flow call websocket.close")},e.prototype.logout=function(){return this.logger.debug("zb.rh.lo call"),this.stateCenter.runState===i.ENUM_RUN_STATE.logout?(this.logger.warn("zb.rh.lo at logout"),!1):(this.setRunState(i.ENUM_RUN_STATE.logout),this.resetRoom(),this.logger.info("zb.rh.lo call success"),!0)},e.prototype.setUserStateUpdate=function(e){return this.logger.debug("zb.rh.su call"),"boolean"!=typeof e?(this.logger.info("zb.rh.su param error"),!1):(this.stateCenter.userStateUpdate=e,this.logger.info("zb.rh.su call success "+e),!0)},e.prototype.fetchUserList=function(){this.logger.debug("zb.rh.ful call"),this.stateCenter.userQuerying?this.logger.warn("zb.rh.ful is already querying"):(this.stateCenter.userQuerying=!0,this.stateCenter.userTempList=[],this.fetchUserListWithPage(0),this.logger.info("zb.rh.ful the first time call"))},e.prototype.fetchUserListWithPage=function(e){var t=this;this.logger.debug("zb.rh.fulwp call"),this.socketCenter.registerRouter("user_list_v2",function(n){t.handleFetchUserListRsp(e,n)}),this.socketCenter.sendMessage("user_list_v2",{marker:0===e?"":e+"",mode:0,limit:100}),this.logger.info("zb.rh.fulwp call success")},e.prototype.handleFetchUserListRsp=function(e,t){if(this.logger.debug("zb.rh.hfulr call"),0!=t.body.err_code)return this.stateCenter.userQuerying=!1,void this.logger.info("zb.rh.hfulr fetch error "+t.body.err_code);if(this.stateCenter.userStateUpdate){if(this.stateCenter.userTempList=this.stateCenter.userTempList.concat(t.body.user_baseinfos),e!=t.body.marker)return this.logger.warn("zb.rh.hfulr fetch another page"),void this.fetchUserListWithPage(e+1);this.stateCenter.userSeq=t.body.server_user_seq,this.logger.info("zb.rh.hfulr set user Seq "+this.stateCenter.userSeq);for(var n=[],i=0;i<this.stateCenter.userTempList.length;i++){n.push({idName:this.stateCenter.userTempList[i].id_name,nickName:this.stateCenter.userTempList[i].nick_name,role:this.stateCenter.userTempList[i].role})}this.stateCenter.userQuerying=!1,this.onGetTotalUserList(this.stateCenter.roomid,n),this.stateCenter.userTempList=[],this.logger.info("zb.rh.hfulr call success user_list "+n+" count "+n.length)}},e.prototype.handleLogoutRsp=function(e){this.logger.debug("zb.rh.hlor result=",e.body.err_code)},e.prototype.handlePushUserStateUpdateMsg=function(e){if(this.logger.info("zb.rh.hpus call"),this.stateCenter.isLogin())if(this.stateCenter.userStateUpdate){if(this.stateCenter.userSeq+e.body.user_actions.length!==e.body.user_list_seq)return this.logger.warn("zb.rh.hpus fetch new userlist "+this.stateCenter.userSeq,NaN+e.body.user_list_seq),void this.fetchUserList();this.stateCenter.userSeq=e.body.user_list_seq,this.logger.debug("zb.rh.hpus push userSeq "+this.stateCenter.userSeq);for(var t=[],n=0;n<e.body.user_actions.length;n++){t.push({action:e.body.user_actions[n].Action,idName:e.body.user_actions[n].IdName,nickName:e.body.user_actions[n].NickName,role:e.body.user_actions[n].Role,loginTime:e.body.user_actions[n].LoginTime})}this.onUserStateUpdate(e.body.room_id,t),this.logger.info("zb.rh.hpus call success")}else this.logger.error("zb.rh.hpus no userStateUpdate flag");else this.logger.error("zb.rh.hpus not login")},e.prototype.onUserStateUpdate=function(e,t){},e}();t.RoomHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(1),l=function(){function e(e,t){var n=this;this.cmdSeq=0,this.responseRouters={},this.logger=e,this.stateCenter=t,this.responseRouters={push_kickout:function(e){n.handlePushKickout(e)},push_custommsg:function(e){n.handlePushCustomMsg(e)},push_im_chat:function(e){n.handlePushRoomMsg(e)},push_userlist_update:function(e){n.handlePushUserStateUpdateMsg(e)},push_merge_message:function(e){n.handlePushMergeMsg(e)},trans:function(e){n.handleTransRsp(e)},push_trans:function(e){n.handlePushTransMsg(e)}}}return e.prototype.handlePushKickout=function(e){},e.prototype.handlePushCustomMsg=function(e){},e.prototype.handlePushRoomMsg=function(e){},e.prototype.handlePushUserStateUpdateMsg=function(e){},e.prototype.handlePushMergeMsg=function(e){},e.prototype.handlePushTransMsg=function(e){},e.prototype.handleBigImMsgRsp=function(e){},e.prototype.handleTransRsp=function(e){if(this.stateCenter.isLogin())if(0==e.body.err_code){var t=e.body.trans_type;this.stateCenter.transSeqMap[t]?(this.stateCenter.transSeqMap[t].seq=e.body.trans_seq,this.logger.debug("zb.sc.htr trans "+t+" seq "+e.body.trans_seq)):this.logger.error("zb.sc.htr cannot match send info")}else this.logger.error("zb.sc.htr trans send error "+e.body.err_code);else this.logger.error("zb.sc.htr not login")},e.prototype.handleBizChannelRspCallback=function(e,t){0===e.body.err_code?null!=t.success&&t.success(e.header.seq,e.body.cmd,e.body.rsp_body):null!=t.error&&t.error(e.body.err_code,e.header.seq,e.body.rsp_body)},e.prototype.registerRouter=function(e,t){this.responseRouters[e]=t},e.prototype.getSocket=function(e){return null},e.prototype.getHeader=function(e){return{Protocol:"req_v2",cmd:e,appid:this.stateCenter.appid,seq:++this.cmdSeq,user_id:this.stateCenter.userid,session_id:this.stateCenter.sessionid||"",room_id:this.stateCenter.roomid||""}},e.prototype.sendMessage=function(e,t,n,i){if(this.logger.debug("zb.sc.sm call "+e),this.isDisConnect())return this.logger.error("zb.sc.sm error  "+e),-1;var r=this.getHeader(e),l={header:r,body:t};if(void 0==n&&(n=null),void 0==i&&(i=null),null!=n||null!=i){var s={data:l,seq:r.seq,deleted:!1,time:Date.parse(new Date+""),success:n,error:i},o=this.stateCenter.sendCommandList.push(s);this.stateCenter.sendCommandMap[s.seq]=o}return this.websocket.send(JSON.stringify(l)),this.logger.debug("zb.sc.sm success"),r.seq},e.prototype.sendCustomMessage=function(e,t,n,i){if(this.logger.debug("zb.sc.scm call"),this.isDisConnect())return this.logger.error("zb.sc.scm error"),!1;var r=this.getHeader(e),l={header:r,body:t},s=JSON.stringify(l);void 0==n&&(n=null),void 0==i&&(i=null);var o={data:l,seq:r.seq,deleted:!1,time:Date.parse(new Date+""),success:n,error:i},a=this.stateCenter.sendDataList.push(o);return this.stateCenter.sendDataMap[o.seq]=a,this.websocket.send(s),this.logger.debug("zb.sc.scm success seq: ",r.seq),!0},e.prototype.isDisConnect=function(){return!this.websocket||1!==this.websocket.readyState},e.prototype.closeSocket=function(){this.websocket&&(this.logger.info("zb.sc.cs close websocket"),this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},e.prototype.createSocket=function(e){this.websocket=this.getSocket(e)},e.prototype.openHandler=function(e){this.websocket.onopen=e},e.prototype.closeHandler=function(e){this.websocket.onclose=e},e.prototype.errorHandler=function(){var e=this;this.websocket.onerror=function(t){e.logger.error("zb.sc.oe msg="+JSON.stringify(t))}},e.prototype.checkResponse=function(e){return(e.header.appid!==this.stateCenter.appid||e.header.session_id!==this.stateCenter.sessionid||e.header.user_id!==this.stateCenter.userid||e.header.room_id!==this.stateCenter.roomid||this.stateCenter.runState!==i.ENUM_RUN_STATE.login)&&(this.logger.error("zb.sc.crp check session fail."),!0)},e.prototype.responseHandler=function(){var e=this;this.websocket.onmessage=function(t){var n=JSON.parse(t.data);e.logger.info("zb.sc.ws.rph jsonmsg= ",n.header.cmd),"login"!==n.header.cmd?e.checkResponse(n)?e.logger.error("zb.sc.ws.rph check session fail."):(e.handleSendCommandMsgRsp(n),e.logger.info("zb.sc.ws.rph cmd="+n.header.cmd+",function="+!!e.responseRouters[n.header.cmd]),e.responseRouters[n.header.cmd]&&e.responseRouters[n.header.cmd](n)):e.responseRouters.login(n,e.cmdSeq)}},e.prototype.handleSendCommandMsgRsp=function(e){this.logger.debug("zb.sc.hscmr call");var t,n=this.stateCenter.sendCommandMap[e.header.seq];null!=n&&("login"==(t=n._data).data.header.cmd?this.logger.debug("zb.sc.hscmr don't check "+t.data.header.cmd):"relay"==t.data.header.cmd?this.handleRelayRspCallback(e,t):"bigim_chat"==t.data.header.cmd?this.handleBigImRspCallback(e,t):"biz_channel"==t.data.header.cmd?this.handleBizChannelRspCallback(e,t):0===e.body.err_code?null!=t.success&&t.success(e.header.seq):null!=t.error&&t.error(r.ClientUtil.getServerError(e.body.err_code),e.header.seq),delete this.stateCenter.sendCommandMap[e.header.seq],this.stateCenter.sendCommandList.remove(n)),this.logger.debug("zb.sc.hscmr call success")},e.prototype.handleRelayRspCallback=function(e,t){0===e.body.err_code?null!=t.success&&t.success(e.header.seq,e.body.relay_result):null!=t.error&&t.error(r.ClientUtil.getServerError(e.body.err_code),e.header.seq)},e.prototype.handleBigImRspCallback=function(e,t){0===e.body.err_code?null!=t.success&&this.handleBigImMsgRsp(e):null!=t.error&&t.error(r.ClientUtil.getServerError(e.body.err_code),e.header.seq)},e}();t.SocketCenter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(){}return e.prototype.onPlayStateUpdateHandle=function(e,t,n){1==e&&this.stopPlayingStream(t),this.onPlayStateUpdate(e,t,n)},e.prototype.onPublishStateUpdateHandle=function(e,t,n){var r=this;0==e?this.stateCenter.publishStreamList[t]&&(this.stateCenter.publishStreamList[t].state==i.ENUM_PUBLISH_STREAM_STATE.tryPublish?(this.stateCenter.publishStreamList[t].state=i.ENUM_PUBLISH_STREAM_STATE.update_info,this.streamHandler.updateStreamInfo(t,i.ENUM_STREAM_SUB_CMD.liveBegin,this.stateCenter.publishStreamList[t].extra_info,function(e){r.stateCenter.publishStreamList[t]&&r.stateCenter.publishStreamList[t].state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(r.stateCenter.publishStreamList[t].state=i.ENUM_PUBLISH_STREAM_STATE.stop,r.onPublishStateUpdate(1,t,e),r.streamCenter.stopPlayingStream(t))})):this.WebrtcOnPublishStateUpdateHandle(e,t,n)):(this.onPublishStateUpdate(e,t,n),1==e&&this.stopPublishingStream(t))},e.prototype.resetStreamCenter=function(){if(this.stateCenter.customUrl&&(this.stateCenter.customUrl=null),this.streamCenter.reset(),!this.socketCenter.isDisConnect())for(var e in this.stateCenter.publishStreamList)this.stateCenter.publishStreamList[e].state==i.ENUM_PUBLISH_STREAM_STATE.publishing&&this.streamHandler.updateStreamInfo(e,i.ENUM_STREAM_SUB_CMD.liveEnd,this.stateCenter.publishStreamList[e].extra_info)},e.prototype.handleFetchWebRtcUrlRsp=function(e){var t=e.body.stream_id;if("push"===e.body.ptype)this.stateCenter.publishStreamList[t]?this.streamCenter.startPublishingStream(t,e.body.urls):this.logger.error("cb.cm.hfwur no streamid to publish");else if("pull"==e.body.ptype){for(var n=!1,i=0;i<this.stateCenter.streamList.length;i++)if(this.stateCenter.streamList[i].stream_id===t){n=!0;break}0==n&&this.logger.warn("cb.cm.hfwur cannot find stream, continue to play"),this.streamCenter.startPlayingStream(t,e.body.urls)}},e}();t.Common=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=n(12),s=n(0),o=n(1),a=n(11),u=n(10),c=n(9),d=n(8),h=n(7),p=n(6),g=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.init=function(){this.bindSocketHandler(),this.bindStreamHandler(),this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler(),this.bindStreamCenterHandler()},t.prototype.bindSocketHandler=function(){var e=this;this.socketCenter=new a.SocketCenter(this.logger,this.stateCenter),this.socketCenter.registerRouter("push_signal",function(t){e.liveHandler.handlePushSignalMsg(t)}),this.socketCenter.getSocket=function(t){return e.getSocket(t)},this.socketCenter.handlePushKickout=function(t){e.logger.info("zb.cm.bsh.0  call hpk"),e.roomHandler.setRunState(s.ENUM_RUN_STATE.logout),e.roomHandler.resetRoom(),e.onKickOut({code:s.sdkErrorList.KICK_OUT.code,msg:s.sdkErrorList.KICK_OUT.msg+t.body.reason}),e.logger.debug("zb.cm.bsh.0  call hpk success")},this.socketCenter.handlePushCustomMsg=function(t){e.messageHandler.handlePushCustomMsg(t)},this.socketCenter.handlePushUserStateUpdateMsg=function(t){e.roomHandler.handlePushUserStateUpdateMsg(t)},this.socketCenter.handlePushRoomMsg=function(t){e.onRecvRoomMsg(t.body.chat_data,t.body.server_msg_id,t.body.ret_msg_id)},this.socketCenter.handlePushMergeMsg=function(t){e.messageHandler.handlePushMergeMsg(t)},this.socketCenter.handlePushTransMsg=function(t){e.messageHandler.handlePushTransMsg(t)},this.socketCenter.handleBigImMsgRsp=function(t){e.messageHandler.handleBigImMsgRsp(t)}},t.prototype.bindStreamHandler=function(){var e=this;this.streamHandler=new c.StreamHandler(this.logger,this.stateCenter,this.socketCenter),this.streamHandler.onStreamUpdated=function(t,n){e.onStreamUpdated(t,n)},this.streamHandler.onPublishStateUpdate=function(t,n,i){e.onPublishStateUpdate(t,n,i)},this.streamHandler.onStreamExtraInfoUpdated=function(t){e.onStreamExtraInfoUpdated(t)},this.streamHandler.setCDNInfo=function(t,n){e.setCDNInfo(t,n)}},t.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler=new d.HeartBeatHandler(this.logger,this.stateCenter,this.socketCenter),this.heartBeatHandler.onRecvReliableMessage=function(t,n,i){e.onRecvReliableMessage(t,n,i)},this.heartBeatHandler.handleFetchStreamListRsp=function(t){e.streamHandler.handleFetchStreamListRsp(t)},this.heartBeatHandler.fetchUserList=function(){e.roomHandler.fetchUserList()},this.heartBeatHandler.onUpdateOnlineCount=function(t,n){e.onUpdateOnlineCount(t,n)},this.heartBeatHandler.updateStreamInfo=function(t,n,i,r){void 0===i&&(i=""),e.streamHandler.updateStreamInfo(t,n,i,r)},this.heartBeatHandler.hbLogout=function(t){e.onDisconnect(t)}},t.prototype.bindRoomHandler=function(){var e=this;this.roomHandler=new u.RoomHandler(this.logger,this.stateCenter,this.socketCenter),this.roomHandler.loginSuccessCallBack=function(t,n){e.heartBeatHandler.start(n.body.hearbeat_interval<s.MINIUM_HEARTBEAT_INTERVAL?s.MINIUM_HEARTBEAT_INTERVAL:n.body.hearbeat_interval),e.heartBeatHandler.resetCheckMessage(),e.heartBeatHandler.startCheckMessageTimeout(),e.streamCenter.setSessionInfo(e.stateCenter.appid,e.stateCenter.idName,e.stateCenter.token,e.stateCenter.testEnvironment),n.body.anchor_info&&e.onGetAnchorInfo(n.body.anchor_info.anchor_id_name,n.body.anchor_info.anchor_nick_name),n.body.online_count&&e.onUpdateOnlineCount(e.stateCenter.roomid,n.body.online_count),e.logger.info("zb.cm.brh hls userStateUpdate "+e.stateCenter.userStateUpdate),e.stateCenter.userStateUpdate&&(e.logger.info("zb.cm.brh hls fetch all new userlist"),e.roomHandler.fetchUserList()),e.streamHandler.handleStreamStart(t,n)},this.roomHandler.onGetTotalUserList=function(t,n){e.onGetTotalUserList(t,n)},this.roomHandler.resetRoomCallBack=function(){e.heartBeatHandler.resetHeartbeat(),e.heartBeatHandler.resetCheckMessage(),e.resetStreamCenter()},this.roomHandler.onUserStateUpdate=function(t,n){e.onUserStateUpdate(t,n)},this.roomHandler.onDisconnect=function(t){e.onDisconnect(t)},this.roomHandler.loginBodyData=function(){return e.loginBodyData()}},t.prototype.bindMessageHandler=function(){var e=this;this.messageHandler=new h.MessageHandler(this.logger,this.stateCenter,this.socketCenter),this.messageHandler.onRecvCustomCommand=function(t,n,i){e.onRecvCustomCommand(t,n,i)},this.messageHandler.onRecvBigRoomMessage=function(t,n){e.onRecvBigRoomMessage(t,n)},this.messageHandler.onRecvReliableMessage=function(t,n,i){e.onRecvReliableMessage(t,n,i)}},t.prototype.bindLiveHandler=function(){var e=this;this.liveHandler=new p.LiveHandler(this.logger,this.stateCenter,this.socketCenter),this.liveHandler.onRecvEndJoinLiveCommand=function(t,n,i,r){e.onRecvEndJoinLiveCommand(t,n,i,r)},this.liveHandler.onRecvInviteJoinLiveRequest=function(t,n,i,r){e.onRecvInviteJoinLiveRequest(t,n,i,r)},this.liveHandler.onRecvJoinLiveRequest=function(t,n,i,r){e.onRecvJoinLiveRequest(t,n,i,r)}},t.prototype.bindStreamCenterHandler=function(){var e=this;this.streamCenter.onPlayStateUpdate=function(t,n,i){e.onPlayStateUpdateHandle(t,n,i)},this.streamCenter.onPlayQualityUpdate=function(t,n){e.onPlayQualityUpdate(t,n)},this.streamCenter.onPublishStateUpdate=function(t,n,i){e.onPublishStateUpdateHandle(t,n,i)},this.streamCenter.onPublishQualityUpdate=function(t,n){e.onPublishQualityUpdate(t,n)},this.streamCenter.onPlayerStreamUrlUpdate=function(t,n,i){e.onStreamUrlUpdate(t,n,i)},this.streamCenter.onVideoSizeChanged=function(t,n,i){e.onVideoSizeChanged(t,n,i)}},t.prototype.config=function(e){return this.logger.debug("zb.cm.cf call"),o.ClientUtil.checkConfigParam(e,this.logger)?(this.stateCenter.appid=e.appid,this.stateCenter.server=e.server,this.stateCenter.idName=e.idName,this.stateCenter.nickName=e.nickName,this.logger.setLogLevel(e.logLevel),!1===e.audienceCreateRoom&&(this.stateCenter.roomCreateFlag=0),this.logger.setRemoteLogLevel(e.remoteLogLevel?0:e.remoteLogLevel),this.logger.setSessionInfo(e.appid,"","",e.idName,"",s.PROTO_VERSION),e.logUrl&&this.logger.openLogServer(e.logUrl),-1!=this.stateCenter.server.indexOf("test2-wsliveroom-api.zego.im")&&(this.stateCenter.testEnvironment=!0),this.stateCenter.configOK=!0,this.logger.debug("zb.cm.cf call success"),!0):(this.logger.error("zb.cm.cf param error"),!1)},t.prototype.login=function(e,t,n,i,r){this.roomHandler.login(e,t,n,i,r)},t.prototype.logout=function(){return this.roomHandler.logout()},t.prototype.setUserStateUpdate=function(e){this.roomHandler.setUserStateUpdate(e)},t.prototype.onUserStateUpdate=function(e,t){},t.prototype.onGetTotalUserList=function(e,t){},t.prototype.onUpdateOnlineCount=function(e,t){},t.prototype.onGetAnchorInfo=function(e,t){},t.prototype.release=function(){this.logger.debug("zb.cm.rl call"),this.roomHandler.setRunState(s.ENUM_RUN_STATE.logout),this.roomHandler.resetRoom(),this.logger.stopLogServer(),this.logger.debug("zb.cm.rl call success")},t.prototype.sendCustomCommand=function(e,t,n,i){return this.messageHandler.sendCustomCommand(e,t,n,i)},t.prototype.onRecvCustomCommand=function(e,t,n){},t.prototype.sendRoomMsg=function(e,t,n,i,r){this.messageHandler.sendRoomMsg(e,t,n,i,r)},t.prototype.onRecvRoomMsg=function(e,t,n){},t.prototype.sendReliableMessage=function(e,t,n,i){this.messageHandler.sendReliableMessage(e,t,n,i)},t.prototype.onRecvReliableMessage=function(e,t,n){},t.prototype.sendBigRoomMessage=function(e,t,n,i,r){this.messageHandler.sendBigRoomMessage(e,t,n,i,r)},t.prototype.onRecvBigRoomMessage=function(e,t){},t.prototype.sendRelayMessage=function(e,t,n,i){this.messageHandler.sendRelayMessage(e,t,n,i)},t.prototype.requestJoinLive=function(e,t,n,i){return this.liveHandler.requestJoinLive(e,t,n,i)},t.prototype.onRecvJoinLiveRequest=function(e,t,n,i){},t.prototype.inviteJoinLive=function(e,t,n,i){return this.liveHandler.inviteJoinLive(e,t,n,i)},t.prototype.onRecvInviteJoinLiveRequest=function(e,t,n,i){},t.prototype.endJoinLive=function(e,t,n){return this.liveHandler.endJoinLive(e,t,n)},t.prototype.onRecvEndJoinLiveCommand=function(e,t,n,i){},t.prototype.respondJoinLive=function(e,t,n,i){return this.liveHandler.respondJoinLive(e,t,n,i)},t.prototype.updateMixStream=function(e,t,n){return this.streamHandler.updateMixStream(e,t,n)},t.prototype.stopMixStream=function(e,t,n){return this.streamHandler.stopMixStream(e,t,n)},t.prototype.updateStreamExtraInfo=function(e,t){return this.streamHandler.updateStreamExtraInfo(e,t)},t.prototype.onStreamUrlUpdate=function(e,t,n){},t.prototype.onStreamUpdated=function(e,t){},t.prototype.onStreamExtraInfoUpdated=function(e){},t.prototype.onPlayStateUpdate=function(e,t,n){},t.prototype.onVideoSizeChanged=function(e,t,n){},t.prototype.onPlayQualityUpdate=function(e,t){},t.prototype.onPublishStateUpdate=function(e,t,n){},t.prototype.onPublishQualityUpdate=function(e,t){},t.prototype.onDisconnect=function(e){},t.prototype.onKickOut=function(e){},t.getCurrentVersion=function(){return s.PROTO_VERSION},t}(l.Common);t.BaseCenter=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){}return e.prototype.setSessionInfo=function(e,t,n,i){},e}();t.ZegoStreamCenter=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2),l=n(3),s=function(){function e(e,t,n,l){this.state=i.ENUM_PLAY_STATE.stop,this.candidateInfo=[],this.waitICETimer=null,this.waitingICETimeInterval=5e3,this.waitingOfferTimer=null,this.waitingOfferTimeInterval=5e3,this.waitingServerTimer=null,this.waitingServerTimerInterval=3e3,this.qualityTimer=null,this.playQualityList=[],this.maxQualityListCount=10,this.lastPlayStats={time:0,audioBytesReceived:0,videoBytesReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0},this.reportSeq=r.getSeq(),this.videoSizeCallback=!1,this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.maxRetryCount=3,this.currentRetryCount=0,this.retryState=i.ENUM_RETRY_STATE.didNotStart,this.closeSessionSignal=!1,this.logger=e,this.signal=t,this.dataReport=n,this.qualityTimeInterval=l,n.newReport(this.reportSeq)}return e.prototype.setAudioDestination=function(e){var t=this;return this.remoteVideo?"undefined"!==this.remoteVideo.sinkId?(this.remoteVideo.setSinkId(e).then(function(){t.logger.info("zp.sad.1 success device: "+e)}).catch(function(e){t.logger.info("zp.sad.1 "+e.name)}),!0):(this.logger.error("zp.sad.1 browser does not suppport"),!1):(this.logger.info("zp.sad.1 no remoteVideo"),!1)},e.prototype.startPlay=function(e,t,n,l){var s=this;this.logger.info("zp.sp.1 called ",e),e?(this.streamId=e,this.remoteVideo=t,this.audioOutput=n,this.playOption=l,this.sessionSeq=r.getSeq(),this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,1,0,e,l&&l.streamParams,function(e,t,n){s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{sessionId:n.session_id}),s.logger.info("zp.sp.1 sessionId:"+n.session_id),s.sessionSeq==e?0!==n.result?(s.logger.error("zp.sp.1 create error"),s.playStateUpdateError(r.playErrorList.CREATE_SESSION_ERROR)):(s.sessionId=n.session_id,s.onCreatePlaySessionSuccess(n)):s.logger.error("zp.sp.1 seq is not match.")},function(e,t){s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{error:e}),s.playStateUpdateError(r.playErrorList.SEND_SESSION_TIMEOUT)}),this.state=i.ENUM_PLAY_STATE.waitingSessionRsp,this.logger.debug("zp.sp.1 called success")):this.logger.warn("zp.sp.1 streamId is null")},e.prototype.onCreatePlaySessionSuccess=function(e){var t=this;this.logger.info("zp.ops.1 success");var n=[];e.turn_server&&n.push(e.turn_server),e.stun_server&&n.push(e.stun_server);var i={iceServers:[{urls:n,username:e.turn_username,credential:e.turn_auth_key}]};this.logger.info("zp.ops.1 username: "+e.turn_username),this.logger.info("zp.ops.1 credential: "+e.turn_auth_key),this.peerConnection=new RTCPeerConnection(i),this.peerConnection.onicecandidate=function(e){t.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){t.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){t.onIceConnectionStateChange(e)},this.peerConnection.onaddstream=function(e){t.onGotRemoteStream(e)},this.remoteVideo.oncanplay=function(){t.logger.debug("zp.ops.1 "+t.remoteVideo.videoWidth+" X "+t.remoteVideo.videoHeight),t.videoSizeCallback||(t.logger.debug("zp.ops.1 onresize callback"),t.onVideoSizeChanged(t.streamId,t.remoteVideo.videoWidth,t.remoteVideo.videoHeight),t.videoSizeCallback=!0)};var l={offerToReceiveAudio:1,offerToReceiveVideo:1};this.playOption&&"audio"===this.playOption.playType&&(l.offerToReceiveVideo=0),this.playOption&&"video"===this.playOption.playType&&(l.offerToReceiveAudio=0),this.logger.info("zp.ops.1 createOffer: "+l),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.peerConnection.createOffer(l).then(function(e){t.dataReport.eventEnd(t.reportSeq,"CreateOffer"),t.onCreateOfferSuccess(e)},function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateOffer",{error:e.toString()}),t.logger.error("zp.ops.0 create offer error "+e.toString()),t.playStateUpdateError(r.playErrorList.CREATE_OFFER_ERROR)}),this.signal.registerPushCallback("MediaDescPush",this.sessionId,function(e,n,i){t.onRecvMediaDesc(e,n,i)}),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,function(e,n,i){t.onRecvCandidateInfo(e,n,i)}),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,function(e,n,i){t.onRecvCloseSession(e,n,i)}),this.signal.registerPushCallback("SessionResetPush",this.sessionId,function(e,n,i){t.onRecvResetSession(e,n,i)}),this.logger.debug("zp.ops.1 call success")},e.prototype.onCreateOfferSuccess=function(e){var t=this;e.sdp=l.sdpUtil.zegoSdp(e.sdp),this.logger.info("zp.oco.1 localSdp ",e.sdp),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.peerConnection.setLocalDescription(e).then(function(){t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription"),t.onSetLocalDescriptionSuccess(e)},function(e){t.logger.error("zp.oca.1 set error "+e.toString()),t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription",{error:e.toString()}),t.playStateUpdateError(r.playErrorList.SET_LOCAL_DESC_ERROR)})},e.prototype.onSetLocalDescriptionSuccess=function(e){var t=this;this.logger.info("zp.osd.1 success");var n={sdp:e.sdp};this.answerSeq=r.getSeq(),this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.answerSeq,this.sessionId,0,n,function(e,n,l){t.answerSeq==e&&t.sessionId==n?(t.logger.info("zp.osd.1 send success"),t.dataReport.eventEnd(t.reportSeq,"SendMediaDesc"),t.waitingOfferTimer=setTimeout(function(){t.state==i.ENUM_PLAY_STATE.waitingOffserRsp&&(t.logger.error("zp.osd.1 waiting timeout"),t.playStateUpdateError(r.playErrorList.SERVER_CANDIDATE_TIMEOUT))},t.waitingOfferTimeInterval),t.state=i.ENUM_PLAY_STATE.waitingServerAnswer):t.logger.error("zp.osd.1 seq or sessionId is not equal "+t.answerSeq+" "+e,0+t.sessionId+" "+n)},function(e,n){t.logger.error("zp.osd.1 failed to send "+e),t.dataReport.eventEndWithMsg(t.reportSeq,"SendMediaDesc",{error:e}),t.playStateUpdateError(r.playErrorList.SEND_MEDIA_DESC_TIMEOUT)}),this.state=i.ENUM_PLAY_STATE.waitingOffserRsp},e.prototype.onRecvMediaDesc=function(e,t,n){var l=this;if(this.logger.info("zp.orm.1 received ",n),this.state===i.ENUM_PLAY_STATE.waitingServerAnswer){null!=this.waitingOfferTimer&&(clearTimeout(this.waitingOfferTimer),this.waitingOfferTimer=null),this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0);var s={type:"answer",sdp:n.sdp,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.logger.info("zp.orm.1 remoteSdp ",s.sdp),this.peerConnection.setRemoteDescription(new RTCSessionDescription(s)).then(function(){l.dataReport.eventEnd(l.reportSeq,"SetRemoteDescription"),l.logger.info("zp.orm.1 set success")},function(e){l.logger.error("zp.orm.1 set remote error "+e.toString()),l.dataReport.eventEndWithMsg(l.reportSeq,"SetRemoteDescription",{error:e.toString()}),l.playStateUpdateError(r.playErrorList.SET_REMOTE_DESC_ERROR)}),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[],this.waitICETimer=setTimeout(function(){l.state==i.ENUM_PLAY_STATE.waitingServerICE&&(l.logger.error("zp.orm.1 waiting server timeout"),l.playStateUpdateError(r.playErrorList.SERVER_CANDIDATE_TIMEOUT))},this.waitingICETimeInterval),this.state=i.ENUM_PLAY_STATE.waitingServerICE,this.logger.debug("zp.orm.1 call success")}else this.logger.error("zp.orm.1 current state "+this.state+" not allowed")},e.prototype.onRecvCandidateInfo=function(e,t,n){var l=this;if(this.logger.debug("zp.orci.1 received "),this.state==i.ENUM_PLAY_STATE.waitingServerICE){null!=this.waitICETimer&&(clearTimeout(this.waitICETimer),this.waitICETimer=null),this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0);for(var s=0;s<n.infos.length;s++){var o={sdpMid:n.infos[s].sdpMid,sdpMLineIndex:n.infos[s].sdpMLineIndex,candidate:n.infos[s].candidate};this.logger.debug("zp.orci.1 candidate "+o.candidate),this.peerConnection.addIceCandidate(new RTCIceCandidate(o)).then(function(){l.logger.debug("zp.orci.1 add success")},function(e){l.logger.error("zp.orci.1 add error "+e.toString()),l.playStateUpdateError(r.playErrorList.SERVER_CANDIDATE_ERROR)})}this.state=i.ENUM_PLAY_STATE.connecting,this.logger.debug("zp.orci.1 call success")}else this.logger.warn("zp.orci.1 current state "+this.state+" not allowed")},e.prototype.onIceCandidate=function(e){if(this.logger.info("zp.oic.1 called"),void 0!=e.candidate)if(this.logger.debug("zp.oic.1 candidate "+e.candidate.candidate),this.state<i.ENUM_PLAY_STATE.waitingServerICE||this.state==i.ENUM_PLAY_STATE.stop)this.logger.debug("zp.oic.1 cached"),this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{this.logger.debug("zp.oic.1 send");this.sendCandidateInfo([{candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}])}},e.prototype.onConnectionStateChange=function(e){this.logger.info("zp.oisc.1 called "+e.target.signalingState)},e.prototype.onIceConnectionStateChange=function(e){this.state!=i.ENUM_PLAY_STATE.stop&&null!=this.peerConnection&&(this.logger.info("zp.oisc.1  stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceConnected"),this.state!=i.ENUM_PLAY_STATE.playing&&this.onPlayStateUpdate(r.ENUM_PLAY_STATE_UPDATE.start,this.streamId),this.state=i.ENUM_PLAY_STATE.playing,this.retryState!=i.ENUM_RETRY_STATE.didNotStart&&(this.retryState=i.ENUM_RETRY_STATE.finished,this.currentRetryCount=0),this.dataReport.eventStart(this.reportSeq,"PlayState"),this.setPlayQualityTimer()):"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)))},e.prototype.checkPlayConnectionFailedState=function(e){var t=null;"failed"==e?t=r.playErrorList.MEDIA_CONNECTION_FAILED:"closed"==e&&(t=r.playErrorList.MEDIA_CONNECTION_CLOSED),null!=t&&(this.state!=i.ENUM_PLAY_STATE.playing&&this.retryState==i.ENUM_PLAY_STATE.didNotStart?(this.logger.info("zp.oics.1  state "+this.state+" retryState "+this.retryState+" connectionState "+e),this.playStateUpdateError(t)):this.shouldRetryPlay()?(this.onPlayStateUpdate(r.ENUM_PLAY_STATE_UPDATE.retry,this.streamId),this.startRetryPlay()):this.playStateUpdateError(t))},e.prototype.shouldRetryPlay=function(){return this.retryState==i.ENUM_RETRY_STATE.didNotStart&&this.state!=i.ENUM_PLAY_STATE.playing?(this.logger.info("zp.srp.1.0 connection didn't success"),!1):this.retryState==i.ENUM_RETRY_STATE.retrying?(this.logger.info("zp.srp.0.0 already retrying"),!1):this.currentRetryCount>this.maxRetryCount?(this.logger.info("zp.srp.1.0 beyond max"),!1):(this.logger.debug("zp.srp.1.0 call success"),!0)},e.prototype.startRetryPlay=function(){this.logger.debug("zp.srp.0 call");var e=this.streamId,t=this.remoteVideo,n=this.audioOutput;this.resetPlay(),this.tryStartPlay(e,t,n)},e.prototype.clearTryPlayTimer=function(){null!=this.waitingServerTimer&&(clearTimeout(this.waitingServerTimer),this.waitingServerTimer=null)},e.prototype.tryStartPlay=function(e,t,n){var l=this;if(this.logger.debug("zp.tsp.1 call"),this.clearTryPlayTimer(),this.streamId=e,this.remoteVideo=t,this.audioOutput=n,this.currentRetryCount>this.maxRetryCount)return this.logger.error("zp.tsp.1 beyond max limit"),void this.playStateUpdateError(r.playErrorList.WEBSOCKET_ERROR);this.retryState=i.ENUM_RETRY_STATE.retrying,this.currentRetryCount+=1,this.signal.isServerConnected()?(this.logger.debug("zp.tsp.1 signal connected"),this.startPlay(e,this.remoteVideo,this.audioOputput)):(this.logger.debug("zp.tsp.1 signal server not connected"),this.waitingServerTimer=setTimeout(function(){l.tryStartPlay(e,l.remoteVideo,l.audioOputput)},this.waitingServerTimerInterval))},e.prototype.clearPlayQualityTimer=function(){null!=this.qualityTimer&&(clearInterval(this.qualityTimer),this.qualityTimer=null),this.lastPlayStats={time:null,audioBytesReceived:null,videoBytesReceived:null,framesDecoded:null,framesDropped:null,framesReceived:null}},e.prototype.resetPlay=function(){this.logger.info("zp.rp.1 call"),this.streamId=null,this.state=i.ENUM_PLAY_STATE.stop,void 0!=this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),null!=this.waitingOfferTimer&&(clearTimeout(this.waitingOfferTimer),this.waitingOfferTimer=null),null!=this.waitICETimer&&(clearTimeout(this.waitICETimer),this.waitICETimer=null),this.clearPlayQualityTimer(),this.remoteVideo&&(this.remoteVideo.srcObject=null,this.remoteVideo.oncanplay=null,this.remoteVideo=null),this.audioOputput=null,this.signal&&(this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId)),this.sessionSeq=0,this.answerSeq=0,this.videoSizeCallback=!1,this.currentRetryCount=0,this.retryState=i.ENUM_RETRY_STATE.didNotStart,this.clearTryPlayTimer()},e.prototype.setPlayQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.debug("zp.spq.1 startTimer"),this.clearPlayQualityTimer(),this.qualityTimer=setInterval(function(){e.peerConnection&&e.peerConnection.getStats(null).then(function(t){e.getPlayStats(t)},function(t){e.logger.info("zp.spq.1 getStats error "+t.toString())})},this.qualityTimeInterval),this.lastPlayStats={time:0,audioBytesReceived:0,videoBytesReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0})},e.prototype.getPlayStats=function(e){var t=this;if(void 0!=e){var n={audioFractionLost:0,audioPacketsLost:0,audioBitrate:0,videoBitrate:0,videoFPS:0,playData:0,nackCount:0,pliCount:0,sliCount:0,videoFractionLos:0,audioJitter:0,videoFractionLost:null,videoFramesDecoded:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoFramesDropped:0,totalRoundTripTime:0,currentRoundTripTime:0},i=this.lastPlayStats.time;e.forEach(function(e){("inbound-rtp"==e.type||"ssrc"==e.type&&void 0!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)?(0!=i&&(n.audioBitrate=8*(e.bytesReceived-t.lastPlayStats.audioBytesReceived)/(e.timestamp-i)),n.audioBitrate<0&&(n.audioBitrate=0),n.audioJitter=e.jitter,n.audioPacketsLost=e.packetsLost,n.audioFractionLost=e.fractionLost,t.lastPlayStats.audioBytesReceived=e.bytesReceived,t.lastPlayStats.time=e.timestamp):("inbound-rtp"==e.type||"ssrc"==e.type&&void 0!=e.bytesReceived)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)?(0!=i&&(n.videoBitrate=8*(e.bytesReceived-t.lastPlayStats.videoBytesReceived)/(e.timestamp-i),n.videoFPS=1e3*(e.framesDecoded-t.lastPlayStats.framesDecoded)/(e.timestamp-i)),n.videoBitrate<0&&(n.videoBitrate=0),n.videoFPS<0&&(n.videoFPS=0),n.nackCount=e.nackCount,n.pliCount=e.pliCount,n.sliCount=e.sliCount,n.videoFractionLost=e.fractionLost,n.videoFramesDecoded=e.framesDecoded,t.lastPlayStats.videoBytesReceived=e.bytesReceived,t.lastPlayStats.framesDecoded=e.framesDecoded,t.lastPlayStats.time=e.timestamp):"track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0)?(n.frameHeight=e.frameHeight,n.frameWidth=e.frameWidth,0!=i&&(n.videoTransferFPS=1e3*(e.framesReceived-t.lastPlayStats.framesReceived)/(e.timestamp-i),n.videoFramesDropped=e.framesDropped-t.lastPlayStats.framesDropped),n.videoTransferFPS<0&&(n.videoTransferFPS=0),n.videoFramesDropped<0&&(n.videoFramesDropped=0),t.lastPlayStats.framesReceived=e.framesReceived,t.lastPlayStats.framesDropped=e.framesDropped):"candidate-pair"==e.type&&(void 0!=e.totalRoundTripTime&&(n.totalRoundTripTime=e.totalRoundTripTime),void 0!=e.currentRoundTripTime&&(n.currentRoundTripTime=e.currentRoundTripTime))}),this.uploadPlayQuality(n),0!=i&&this.onPlayQualityUpdate(this.streamId,n)}},e.prototype.uploadPlayQuality=function(e){var t=this;if(this.qualityUpload){var n=Date.parse(new Date+"");(0==this.qualityUploadLastTime||n-this.qualityUploadLastTime>=this.qualityUploadInterval)&&(this.logger.debug("zp.upq.1 upload"),e.stream_type="play",e.stream_id=this.streamId,e.timeStamp=n/1e3,this.signal.QualityReport(r.getSeq(),this.sessionId,e,function(e,n,i){void 0!==i.report&&(t.qualityUpload=i.report,t.qualityUploadInterval=i.report_interval_ms)},function(e,n){t.logger.info("zp.upq.1 upload failed "+e)}),this.qualityUploadLastTime=n)}},e.prototype.onRecvResetSession=function(e,t,n){this.logger.info("zp.orrs.1 received "),t==this.sessionId?(this.dataReport.addEvent(this.reportSeq,"RecvResetSession"),this.shouldRetryPlay()&&this.startRetryPlay()):this.logger.info("zp.orrs.1 cannot find session")},e.prototype.onRecvCloseSession=function(e,t,n){this.logger.info("zp.orcs.1 reason: "+n.reason),this.dataReport.addEvent(this.reportSeq,"RecvCloseSession"),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=JSON.parse(JSON.stringify(r.playErrorList.SESSION_CLOSED));i.msg+=n.reason,24===n.reason?this.startRetryPlay():this.playStateUpdateError(i)},e.prototype.onGotRemoteStream=function(e){this.logger.info("zp.ogrs.0 called "+e.stream),this.remoteVideo?(this.remoteVideo.srcObject=e.stream,this.audioOputput&&this.setAudioDestination(this.audioOputput),this.dataReport.addEvent(this.reportSeq,"GetRemoteStream")):this.logger.error("zp.ogrs.0 no remoteVideo")},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.debug("zp.sci.1 called"),!(e=e.filter(function(e){return!(e.candidate.indexOf("tcp")>0)}))||e.length<1?this.logger.info("zp.sci.1 cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.signal.sendCandidateInfo(r.getSeq(),this.sessionId,e,function(e,n,i){t.logger.debug("zp.sci.1 send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate")},function(e,n){t.logger.error("zp.sci.1 failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.playStateUpdateError(r.playErrorList.SEND_CANDIDATE_ERROR)}))},e.prototype.shouldSendCloseSession=function(e){return this.state!=r.ENUM_PLAY_STATE_UPDATE.stop&&this.state!=i.ENUM_PLAY_STATE.waitingSessionRsp},e.prototype.playStateUpdateError=function(e){this.logger.debug("zp.psue.1 called ",e.code),0!=this.sessionId&&this.shouldSendCloseSession(e)&&(this.signal.sendCloseSession(r.getSeq(),this.sessionId,1),this.closeSessionSignal=!0),this.state=i.ENUM_PLAY_STATE.stop,this.onPlayStateUpdate(r.ENUM_PLAY_STATE_UPDATE.error,this.streamId,e),this.resetPlay()},e.prototype.onPlayStateUpdate=function(e,t,n){},e.prototype.onPlayQualityUpdate=function(e,t){},e.prototype.onVideoSizeChanged=function(e,t,n){},e.prototype.stopPlay=function(){this.logger.debug("zp.sp.1.1 called"),this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(r.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.reportSeq,"PlayState",{state:this.state+""}),this.dataReport.addEvent(this.reportSeq,"StopPlay"),this.dataReport.addMsgExt(this.reportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.dataReport.uploadReport(this.reportSeq,"RTCPlayStream"),this.resetPlay()},e.prototype.onDisconnect=function(){this.logger.info("zp.od.1 call"),this.logger.info("zp.od.1 websocket disconnect"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.playStateUpdateError(r.playErrorList.WEBSOCKET_ERROR)},e}();t.ZegoPlayWeb=s},function(e,t,n){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(2),s=function(){function e(e,t){this.sendDataMap={},this.sendDataList=new r.LinkedList,this.sendDataCheckOnceCount=100,this.signalSeq=0,this.pushCallback={},this.sessionInfos={},this.tryHeartbeatCount=0,this.heartbeatInterval=1e4,this.sendDataTimeout=5e3,this.sendDataDropTimeout=1e4,this.tryConnectCount=1,this.tryConnectTimer=null,this.tryConnectInterval=3e3,this.state=r.ENUM_CONNECT_STATE.disconnect,this.tokenType=0,this.browser=this.getBrowserAndVersion(),this.platform=navigator.platform,this.logger=e,this.stateCenter=t}return e.prototype.getBrowserAndVersion=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(n[1])?{name:"IE",version:(e=/\brv[ :]+([\d\.]+)/g.exec(t)||[])[1]||""}:"Chrome"===n[1]&&null!=(e=t.match(/\bOPR|Edge\/([\d\.]+)/))?{name:"Opera",version:e[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([\d+\.]+)/i))&&n.splice(1,1,e[1]),{name:n[0],version:n[1]})},e.prototype.setSessionInfo=function(e,t){this.logger.debug("zs.ssi.0 call"),this.appid=e+"",this.userid=t},e.prototype.onDisconnect=function(e){},e.prototype.onUpdateHeartBeartInterval=function(e){},e.prototype.resetConnectTimer=function(){this.logger.info("zs.rct.0 call"),clearTimeout(this.tryConnectTimer),this.tryConnectTimer=null,this.tryConnectCount=0},e.prototype.bindWebSocketHandle=function(){var e=this;this.websocket.onmessage=function(t){var n=JSON.parse(t.data);e.logger.debug("zs.bsh.0 signmsg= ",n.header.cmd),n.header.appid==e.appid&&n.header.user_id===e.userid?e.handleServerPush(n):e.logger.warn("zs.bsh.0 check header failed")},this.websocket.onclose=function(t){e.logger.info("zs.bsh.0 close msg = "+JSON.stringify(t)),e.state!=r.ENUM_CONNECT_STATE.disconnect&&(e.resetConnectTimer(),e.startConnectTimer(),e.resetCheckMessage())},this.websocket.onerror=function(t){e.logger.error("zs.bsh.0 msg = "+JSON.stringify(t))}},e.prototype.resetCheckMessage=function(){this.logger.debug("zs.rcm.0 call");for(var e=this.sendDataList.getFirst();null!=e;)this.sendDataList.remove(e),e._data.error&&e._data.error(r.SEND_MSG_RESET,e._data.seq),e=this.sendDataList.getFirst();this.sendDataMap={}},e.prototype.handleServerPush=function(e){switch(e.header.cmd){case"LoginRsp":this.handleRespondData("LoginReq",e);break;case"CreateSessionRsp":this.handleRespondData("CreateSessionReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"MediaDescRsp":this.handleRespondData("MediaDescReq",e);break;case"CandidateInfoRsp":this.handleRespondData("CandidateInfoReq",e);break;case"CloseSessionRsp":this.handleRespondData("CloseSessionReq",e),this.removeSession(e.header.session_id);break;case"ClientHBRsp":this.handleRespondData("ClientHBReq",e);break;case"MediaDescPush":case"CandidateInfoPush":this.handlePushData(e);break;case"CloseSessionPush":this.handlePushData(e),this.removeSession(e.header.session_id);break;case"QualityReportRsp":this.handleRespondData("QualityReportReq",e);break;case"SessionResetPush":this.handlePushResetSessionData(e)}},e.prototype.disconnectCallback=function(){this.connectCallback&&(this.connectCallback(-1,this.server,void 0),this.connectCallback=null);var e=this.server;this.disconnectServer(),this.onDisconnect(e)},e.prototype.updateToken=function(){var e=this;this.logger.info("zs.ut.0 call");var t={token:this.token,tokenType:this.tokenType,roomid:this.stateCenter.roomid,anchorname:this.stateCenter.anchor_info.anchor_id,sdkversion:r.PROTO_VERSION,osinfo:navigator.appVersion};if(0!=Object.keys(this.sessionInfos).length){var n=[];for(var i in this.sessionInfos){var s=parseInt(i);n.push({session_id:s,session_token:this.sessionInfos[s].token})}t.sessions=n}this.sendMessageWithCallback("LoginReq",l.getSeq(),0,t,function(t,n,i){if(0==i.result){e.token=i.token,e.tokenType=i.tokenType;null!=e.connectCallback&&(e.connectCallback(0,e.server,{report:i.report,report_interval:i.report_interval_ms}),e.connectCallback=null)}else{null!=e.connectCallback&&(e.connectCallback(i.result,e.server,{error:i.strError}),e.connectCallback=null)}},function(t,n){null!=e.connectCallback&&(e.connectCallback(-1,e.server,void 0),e.connectCallback=null)})},e.prototype.sendMessageWithCallback=function(e,t,n,i,l,s){if(this.logger.debug("zs.smwc.0 call "+e),!this.websocket||1!==this.websocket.readyState)return this.logger.error("zs.smwc.0 connect not establish"),void(s&&s(r.SEND_MSG_TIMEOUT,t));var o={header:this.getHeader(e,t,n),body:i};void 0==l&&(l=null),void 0==s&&(s=null);var a={seq:t,deleted:!1,cmd:e,time:Date.parse(new Date+""),success:l,error:s},u=this.sendDataList.push(a);this.sendDataMap[a.seq]=u;var c=JSON.stringify(o);this.websocket.send(c),this.logger.debug("zs.smwc.0 success")},e.prototype.getHeader=function(e,t,n){return this.globalHeader={version:"1.0.1",cmd:e,appid:this.appid+"",seq:t,user_id:this.userid,session_id:n},this.globalHeader},e.prototype.connectServer=function(e,t,n){var i=this;if(this.token=e,this.server=t,this.state=r.ENUM_CONNECT_STATE.connecting,this.connectCallback=n,this.websocket&&1===this.websocket.readyState)this.resetConnectTimer(),this.state=r.ENUM_CONNECT_STATE.connected;else{this.logger.debug("zs.cs.0 need new websocket");try{this.websocket&&(this.logger.warn("zs.cs.0 close error websocket"),this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.websocket=new WebSocket(this.server),this.websocket.onopen=function(){i.resetConnectTimer(),i.logger.info("zs.cs.0 websocket open call"),i.bindWebSocketHandle(),i.updateToken(),i.state=r.ENUM_CONNECT_STATE.connected}}catch(e){this.logger.error("zs.cs.0 websocket error "+e)}}this.tryConnectTimer=setTimeout(function(){i.startConnectTimer(n)},this.tryConnectInterval)},e.prototype.startConnectTimer=function(e){if(this.logger.info("zs.sct.0 call"),this.tryConnectCount>=r.MAX_TRY_CONNECT_COUNT)return this.logger.error("zs.sct.0 beyond max limit"),void this.disconnectCallback();this.websocket&&1===this.websocket.readyState?this.resetConnectTimer():(this.tryConnectCount+=1,this.connectServer(this.token,this.server,e))},e.prototype.disconnectServer=function(){this.logger.debug("zs.ds.0 call"),this.server=null,this.connectCallback=null,this.resetCheckMessage(),this.resetConnectTimer(),this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.token="",this.sessionInfos={},this.tokenType=0,this.tryHeartbeatCount=0,this.tryConnectCount=0,this.state=r.ENUM_CONNECT_STATE.disconnect},e.prototype.isServerConnected=function(){return!(!this.websocket||1!==this.websocket.readyState)},e.prototype.createSession=function(e,t,n,i,r,l,s){void 0===r&&(r=""),this.logger.debug("zs.cs.1 call: ",i);this.sendMessageWithCallback("CreateSessionReq",e,0,{type:t,stream_id:i,platform:this.platform,browser:this.browser.name,version:this.browser.version,app_id:this.appid,negotiate_mode:n,strAuthParam:r},l,s)},e.prototype.removeSession=function(e){this.logger.info("zs.rs.0 call"),this.sessionInfos[e]&&delete this.sessionInfos[e]},e.prototype.sendCloseSession=function(e,t,n,i,r){this.logger.debug("zs.scs.0 call: ",t);var l={reason:n};this.removeSession(t),this.sendMessageWithCallback("CloseSessionReq",e,t,l,i,r)},e.prototype.sendMessage=function(e,t,n,i){if(this.logger.debug("zs.sm.0 call "+e),this.websocket&&1===this.websocket.readyState){var r={header:this.getHeader(e,t,n),body:i},l=JSON.stringify(r);this.websocket.send(l),this.logger.debug("zs.sm.0 success")}else this.logger.error("zs.sm.0 connect not establish")},e.prototype.handleRespondData=function(e,t){this.logger.debug("zs.hrd.0 call");var n=this.sendDataMap[t.header.seq];if(null!=n){var i=n._data;i.cmd!==e?this.logger.error("sz.hrd.0 command is not match"):i.success&&i.success(t.header.seq,t.header.session_id,t.body),delete this.sendDataMap[t.header.seq],this.sendDataList.remove(n)}else this.logger.error("zs.hrd.0 cannot find data "+e)},e.prototype.addSession=function(e,t){this.logger.info("zs.as.0 call"),this.sessionInfos[e]={token:t}},e.prototype.handlePushData=function(e){this.logger.debug("zs.hpd.0 call "+e.header.cmd+" session "+e.header.session_id);var t=this.pushCallback[e.header.cmd+e.header.session_id];t?t.callback&&t.callback(e.header.seq,e.header.session_id,e.body):this.logger.info("zs.hpd.0 no callbackData "+e.header.cmd+" session: "+e.header.session_id)},e.prototype.handlePushResetSessionData=function(e){this.logger.debug("zs.hprsd.0 call ");var t=[];if(0==e.body.cResetType)t=Object.keys(this.sessionInfos);else if(1==e.body.cResetType)for(var n=0;n<e.body.session_ids.length;n++)t.push(e.body.session_ids[n]);if(this.sendResetSessionAck(e.header.seq,0,0),0!=t.length)for(var i=0;i<t.length;i++){var r=this.pushCallback[e.header.cmd+t[i]];null==r?this.logger.info("zs.hprsd.0 no callbackData "+t[i]):r.callback&&r.callback(r.object,e.header.seq,t[i],e.body)}else this.logger.info("zs.hprsd.0 no session to callback")},e.prototype.sendMediaDesc=function(e,t,n,i,r,l){this.logger.debug("zs.smd.0 call: ",t);var s={type:n,sdp:i.sdp};void 0!=i.width&&(s.width=i.width),void 0!=i.height&&(s.height=i.height),void 0!=i.frameRate&&(s.framerate=i.frameRate),void 0!=i.video_min_kpbs&&(s.video_min_kpbs=i.video_min_kpbs),void 0!=i.video_max_kpbs&&(s.video_max_kpbs=i.video_max_kpbs),void 0!=i.audio_kpbs&&(s.audio_kpbs=i.audio_kpbs),this.sendMessageWithCallback("MediaDescReq",e,t,s,r,l)},e.prototype.sendCandidateInfo=function(e,t,n,i,r){this.logger.debug("zs.sci.0 call: ",t);for(var l=[],s=0;s<n.length;s++){l.push({candidate:n[s].candidate,sdpMid:n[s].sdpMid,sdpMLineIndex:n[s].sdpMLineIndex})}this.sendMessageWithCallback("CandidateInfoReq",e,t,{infos:l},i,r)},e.prototype.sendMediaDescAck=function(e,t,n){this.logger.debug("zs.smda.0 call: ",t);this.sendMessage("MediaDescAck",e,t,{result:n})},e.prototype.sendCandidateInfoAck=function(e,t,n){this.logger.debug("zs.scia.0 call: ",t);this.sendMessage("CandidateInfoAck",e,t,{result:n})},e.prototype.sendCloseSessionAck=function(e,t,n){this.logger.debug("zs.scsa.0 call: ",t);this.sendMessage("CloseSessionAck",e,t,{result:n})},e.prototype.sendResetSessionAck=function(e,t,n){this.logger.debug("zs.ssra.0 call: ",t);this.sendMessage("SessionResetAck",e,t,{result:n})},e.prototype.registerPushCallback=function(e,t,n){n&&"function"==typeof n&&(this.logger.debug("zs.rpc.0 setcallback"),this.pushCallback[e+t]={callback:n})},e.prototype.unregisterPushCallback=function(e,t){delete this.pushCallback[e+t]},e.prototype.checkMessageTimeout=function(){for(var e=this.sendDataList.getFirst(),t=Date.parse(new Date+""),n=0,i=0,l=0;!(null==e||e._data.time+this.sendDataTimeout>t||(delete this.sendDataMap[e._data.seq],this.sendDataList.remove(e),++i,null==e._data.error||this.sendDataDropTimeout>0&&e._data.time+this.sendDataDropTimeout<t?++l:e._data.error&&e._data.error(r.SEND_MSG_TIMEOUT,e._data.seq),++n>=this.sendDataCheckOnceCount));)e=this.sendDataList.getFirst();0==i&&0==l||this.logger.debug("zs.cmt.0 call success, state: timeout=",i," drop=",l)},e.prototype.sendHeartbeat=function(){var e=this;if(this.logger.debug("zs.shb.0 call"),0!=Object.keys(this.sessionInfos).length){if(++this.tryHeartbeatCount>r.MAX_TRY_HEARTBEAT_COUNT)return this.logger.error("zs.shb.0 heartbeat try limit"),void this.disconnectCallback();var t=[];for(var n in this.sessionInfos)t.push(parseInt(n));var i={session_ids:t};this.sendMessageWithCallback("ClientHBReq",l.getSeq(),0,i,function(t,n,i){e.heartbeatInterval!=i.hb_interval&&(e.heartbeatInterval=i.hb_interval,e.onUpdateHeartBeartInterval(i.hb_interval)),e.tryHeartbeatCount=0},function(t,n){e.tryHeartbeatCount+=1})}else this.logger.info("zs.shb.0 no need to heartbeat")},e.prototype.QualityReport=function(e,t,n,r,l){this.logger.debug("zs.qr.0 call");var s={streams:[i({},n,{aid:t})]};this.sendMessageWithCallback("QualityReportReq",e,t,s,r,l)},e}();t.ZegoSignal=s},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(t){var n;e.exports=function e(t,i,r){function l(o,a){if(!i[o]){if(!t[o]){if(!a&&("function"==typeof n&&n))return n(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[o]={exports:{}};t[o][0].call(c.exports,function(e){return l(t[o][1][e]||e)},c,c.exports,e,t,i,r)}return i[o].exports}for(var s="function"==typeof n&&n,o=0;o<r.length;o++)l(r[o]);return l}({1:[function(e,t,n){"use strict";function i(e,t,n,i,r){var l=a.writeRtpDescription(e.kind,t);if(l+=a.writeIceParameters(e.iceGatherer.getLocalParameters()),l+=a.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),l+="a=mid:"+e.mid+"\r\n",l+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var o="msid:"+(i?i.id:"-")+" "+s+"\r\n";l+="a="+o,l+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,l+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return l+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n"),l}function r(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},r=function(e,t,n,r){var l=i(e.parameters.apt,n),s=i(t.parameters.apt,r);return l&&s&&l.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach(function(i){for(var l=0;l<t.codecs.length;l++){var s=t.codecs[l];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!r(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var i=0;i<t.headerExtensions.length;i++){var r=t.headerExtensions[i];if(e.uri===r.uri){n.headerExtensions.push(r);break}}}),n}function l(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function o(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var a=e("sdp");t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,i,r){var l=new Event("track");l.track=n,l.receiver=i,l.transceiver={receiver:i},l.streams=r,e.setTimeout(function(){t._dispatchEvent("track",l)})}var c=function(n){var i=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){i[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw o("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof i;return r&&(i=[i]),i=i.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)}),delete e.url,e.urls=r?i[0]:i,!!i.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var l=n.iceCandidatePoolSize;l>0;l--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=a.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(c.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(c.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),c.prototype.onicecandidate=null,c.prototype.onaddstream=null,c.prototype.ontrack=null,c.prototype.onremovestream=null,c.prototype.onsignalingstatechange=null,c.prototype.oniceconnectionstatechange=null,c.prototype.onconnectionstatechange=null,c.prototype.onicegatheringstatechange=null,c.prototype.onnegotiationneeded=null,c.prototype.ondatachannel=null,c.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},c.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},c.prototype.getConfiguration=function(){return this._config},c.prototype.getLocalStreams=function(){return this.localStreams},c.prototype.getRemoteStreams=function(){return this.remoteStreams},c.prototype._createTransceiver=function(e,t){var n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},c.prototype.addTrack=function(t,n){if(this._isClosed)throw o("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find(function(e){return e.track===t}))throw o("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==t.kind||(i=this.transceivers[r]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},c.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var i=e.clone();e.getTracks().forEach(function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),i.getTracks().forEach(function(e){n.addTrack(e,i)})}},c.prototype.removeTrack=function(t){if(this._isClosed)throw o("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw o("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null;-1===this.transceivers.map(function(e){return e.stream}).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},c.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},c.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},c.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},c.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;r.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),r},c.prototype._gather=function(t,n){var i=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var l=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var l=new Event("icecandidate");l.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,o=!s||0===Object.keys(s).length;if(o)"new"!==r.state&&"gathering"!==r.state||(r.state="completed");else{"new"===r.state&&(r.state="gathering"),s.component=1,s.ufrag=r.getLocalParameters().usernameFragment;var u=a.writeCandidate(s);l.candidate=Object.assign(l.candidate,a.parseCandidate(u)),l.candidate.candidate=u,l.candidate.toJSON=function(){return{candidate:l.candidate.candidate,sdpMid:l.candidate.sdpMid,sdpMLineIndex:l.candidate.sdpMLineIndex,usernameFragment:l.candidate.usernameFragment}}}var c=a.getMediaSections(i._localDescription.sdp);c[l.candidate.sdpMLineIndex]+=o?"a=end-of-candidates\r\n":"a="+l.candidate.candidate+"\r\n",i._localDescription.sdp=a.getDescription(i._localDescription.sdp)+c.join("");var d=i.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),o||i._dispatchEvent("icecandidate",l),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout(function(){l.forEach(function(e){r.onlocalcandidate(e)})},0)}},c.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},c.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},c.prototype._transceive=function(e,n,i){var l=r(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(l.encodings=e.sendEncodingParameters,l.rtcp={cname:a.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(l.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(l)),i&&e.rtpReceiver&&l.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),l.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],l.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(l.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(l.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(l))},c.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(o("TypeError",'Unsupported type "'+e.type+'"'));if(!l("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(o("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=a.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=a.parseRtpParameters(e);i.transceivers[t].localCapabilities=n}),i.transceivers.forEach(function(e,t){i._gather(e.mid,t)});else if("answer"===e.type){t=a.splitSections(i._remoteDescription.sdp),n=t.shift();var s=a.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var l=i.transceivers[t],o=l.iceGatherer,u=l.iceTransport,c=l.dtlsTransport,d=l.localCapabilities,h=l.remoteCapabilities;if(!(a.isRejected(e)&&0===a.matchPrefix(e,"a=bundle-only").length)&&!l.rejected){var p=a.getIceParameters(e,n),g=a.getDtlsParameters(e,n);s&&(g.role="server"),i.usingBundle&&0!==t||(i._gather(l.mid,t),"new"===u.state&&u.start(o,p,s?"controlling":"controlled"),"new"===c.state&&c.start(g));var f=r(d,h);i._transceive(l,f.codecs.length>0,!1)}})}return i._localDescription={type:e.type,sdp:e.sdp},i._updateSignalingState("offer"===e.type?"have-local-offer":"stable"),Promise.resolve()},c.prototype.setRemoteDescription=function(i){var r=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(o("TypeError",'Unsupported type "'+i.type+'"'));if(!l("setRemoteDescription",i.type,r.signalingState)||r._isClosed)return Promise.reject(o("InvalidStateError","Can not set remote "+i.type+" in state "+r.signalingState));var c={};r.remoteStreams.forEach(function(e){c[e.id]=e});var d=[],h=a.splitSections(i.sdp),p=h.shift(),g=a.matchPrefix(p,"a=ice-lite").length>0,f=a.matchPrefix(p,"a=group:BUNDLE ").length>0;r.usingBundle=f;var m=a.matchPrefix(p,"a=ice-options:")[0];return r.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,h.forEach(function(l,o){var u=a.splitLines(l),h=a.getKind(l),m=a.isRejected(l)&&0===a.matchPrefix(l,"a=bundle-only").length,v=u[0].substr(2).split(" ")[2],_=a.getDirection(l,p),b=a.parseMsid(l),y=a.getMid(l)||a.generateIdentifier();if(m||"application"===h&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))r.transceivers[o]={mid:y,kind:h,protocol:v,rejected:!0};else{var C,S,T,E,R,P,I,L,k;!m&&r.transceivers[o]&&r.transceivers[o].rejected&&(r.transceivers[o]=r._createTransceiver(h,!0));var M,w,U=a.parseRtpParameters(l);m||(M=a.getIceParameters(l,p),(w=a.getDtlsParameters(l,p)).role="client"),I=a.parseRtpEncodingParameters(l);var z=a.parseRtcpParameters(l),O=a.matchPrefix(l,"a=end-of-candidates",p).length>0,D=a.matchPrefix(l,"a=candidate:").map(function(e){return a.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!m&&f&&o>0&&r.transceivers[o]&&(r._disposeIceAndDtlsTransports(o),r.transceivers[o].iceGatherer=r.transceivers[0].iceGatherer,r.transceivers[o].iceTransport=r.transceivers[0].iceTransport,r.transceivers[o].dtlsTransport=r.transceivers[0].dtlsTransport,r.transceivers[o].rtpSender&&r.transceivers[o].rtpSender.setTransport(r.transceivers[0].dtlsTransport),r.transceivers[o].rtpReceiver&&r.transceivers[o].rtpReceiver.setTransport(r.transceivers[0].dtlsTransport)),"offer"!==i.type||m)"answer"!==i.type||m||(C=r.transceivers[o],S=C.iceGatherer,T=C.iceTransport,E=C.dtlsTransport,R=C.rtpReceiver,P=C.sendEncodingParameters,L=C.localCapabilities,r.transceivers[o].recvEncodingParameters=I,r.transceivers[o].remoteCapabilities=U,r.transceivers[o].rtcpParameters=z,D.length&&"new"===T.state&&(!g&&!O||f&&0!==o?D.forEach(function(e){s(C.iceTransport,e)}):T.setRemoteCandidates(D)),f&&0!==o||("new"===T.state&&T.start(S,M,"controlling"),"new"===E.state&&E.start(w)),r._transceive(C,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!R||"sendrecv"!==_&&"sendonly"!==_?delete C.rtpReceiver:(k=R.track,b?(c[b.stream]||(c[b.stream]=new e.MediaStream),n(k,c[b.stream]),d.push([k,R,c[b.stream]])):(c.default||(c.default=new e.MediaStream),n(k,c.default),d.push([k,R,c.default]))));else{(C=r.transceivers[o]||r._createTransceiver(h)).mid=y,C.iceGatherer||(C.iceGatherer=r._createIceGatherer(o,f)),D.length&&"new"===C.iceTransport.state&&(!O||f&&0!==o?D.forEach(function(e){s(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(D)),L=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(L.codecs=L.codecs.filter(function(e){return"rtx"!==e.name})),P=C.sendEncodingParameters||[{ssrc:1001*(2*o+2)}];var N,A=!1;"sendrecv"===_||"sendonly"===_?(A=!C.rtpReceiver,R=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,h),A&&(k=R.track,b&&"-"===b.stream||(b?(c[b.stream]||(c[b.stream]=new e.MediaStream,Object.defineProperty(c[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(k,"id",{get:function(){return b.track}}),N=c[b.stream]):(c.default||(c.default=new e.MediaStream),N=c.default)),N&&(n(k,N),C.associatedRemoteMediaStreams.push(N)),d.push([k,R,N]))):C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(t){var n,i,r=t.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});r&&(n=r,(i=t).removeTrack(n),i.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))}),C.associatedRemoteMediaStreams=[]),C.localCapabilities=L,C.remoteCapabilities=U,C.rtpReceiver=R,C.rtcpParameters=z,C.sendEncodingParameters=P,C.recvEncodingParameters=I,r._transceive(r.transceivers[o],!1,A)}}}),void 0===r._dtlsRole&&(r._dtlsRole="offer"===i.type?"active":"passive"),r._remoteDescription={type:i.type,sdp:i.sdp},r._updateSignalingState("offer"===i.type?"have-remote-offer":"stable"),Object.keys(c).forEach(function(t){var n=c[t];if(n.getTracks().length){if(-1===r.remoteStreams.indexOf(n)){r.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout(function(){r._dispatchEvent("addstream",i)})}d.forEach(function(e){n.id===e[2].id&&u(r,e[0],e[1],[n])})}}),d.forEach(function(e){e[2]||u(r,e[0],e[1],[])}),e.setTimeout(function(){r&&r.transceivers&&r.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},c.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},c.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},c.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},c.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},c.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},c.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(o("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter(function(e){return"audio"===e.kind}).length,l=n.transceivers.filter(function(e){return"video"===e.kind}).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(r=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(l=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--l<0&&(e.wantReceive=!1)});r>0||l>0;)r>0&&(n._createTransceiver("audio"),r--),l>0&&(n._createTransceiver("video"),l--);var u=a.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(i,r){var l=i.track,s=i.kind,o=i.mid||a.generateIdentifier();i.mid=o,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(r,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),u.headerExtensions.forEach(function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var c=i.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];l&&t>=15019&&"video"===s&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=c}),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,u+="a="+a.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))});var c=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(c)},c.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(o("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(o("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var l=a.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(l+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");var s=a.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,o){if(!(o+1>s)){if(e.rejected)return"application"===e.kind?l+="DTLS/SCTP"===e.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?l+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(l+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(l+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var a;e.stream&&("audio"===e.kind?a=e.stream.getAudioTracks()[0]:"video"===e.kind&&(a=e.stream.getVideoTracks()[0]),a&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=r(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,l+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(l+="a=rtcp-rsize\r\n")}});var u=new e.RTCSessionDescription({type:"answer",sdp:l});return Promise.resolve(u)},c.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(i,r){if(!n._remoteDescription)return r(o("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var l=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){l=u;break}var c=n.transceivers[l];if(!c)return r(o("OperationError","Can not add ICE candidate"));if(c.rejected)return i();var d=Object.keys(e.candidate).length>0?a.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===l||l>0&&c.iceTransport!==n.transceivers[0].iceTransport)&&!s(c.iceTransport,d))return r(o("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=a.getMediaSections(n._remoteDescription.sdp))[l]+="a="+(d.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=a.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=a.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=a.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);i()})},c.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw o("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&i.push(e[t].getStats())})}),Promise.all(i).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])}),t})}}});var d=["createOffer","createAnswer"];return d.forEach(function(e){var t=c.prototype[e];c.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=c.prototype[e];c.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=c.prototype[e];c.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),c}},{sdp:2}],2:[function(e,t,n){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},i.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},i.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)t=i[r].trim().split("="),n[t[0].trim()]=t[1];return n},i.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach(function(t){i.push(e.parameters[t]?t+"="+e.parameters[t]:t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},i.getIceParameters=function(e,t){var n=i.splitLines(e);return{usernameFragment:(n=n.concat(i.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(e)[0].split(" "),r=3;r<n.length;r++){var l=n[r],s=i.matchPrefix(e,"a=rtpmap:"+l+" ")[0];if(s){var o=i.parseRtpMap(s),a=i.matchPrefix(e,"a=fmtp:"+l+" ");switch(o.parameters=a.length?i.parseFmtp(a[0]):{},o.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+l+" ").map(i.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(i.parseExtmap(e))}),t},i.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=i.writeRtpMap(e),n+=i.writeFmtp(e),n+=i.writeRtcpFb(e)});var r=0;return t.codecs.forEach(function(e){e.maxptime>r&&(r=e.maxptime)}),r>0&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=i.writeExtmap(e)}),n},i.parseRtpEncodingParameters=function(e){var t,n=[],r=i.parseRtpParameters(e),l=-1!==r.fecMechanisms.indexOf("RED"),s=-1!==r.fecMechanisms.indexOf("ULPFEC"),o=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),a=o.length>0&&o[0].ssrc,u=i.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===a&&(t=u[0][1]),r.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&t&&(i.rtx={ssrc:t}),n.push(i),l&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:t,mechanism:s?"red+ulpfec":"red"},n.push(i))}}),0===n.length&&a&&n.push({ssrc:a});var c=i.matchPrefix(e,"b=");return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=c})),n},i.parseRtcpParameters=function(e){var t={},n=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var r=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=r.length>0,t.compound=0===r.length;var l=i.matchPrefix(e,"a=rtcp-mux");return t.mux=l.length>0,t},i.parseMsid=function(e){var t,n=i.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var r=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return r.length>0?{stream:(t=r[0].value.split(" "))[0],track:t[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t){var n=void 0!==t?t:2;return"v=0\r\no=thisisadapterortc "+(e||i.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,n,r){var l=i.writeRtpDescription(e.kind,t);if(l+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),l+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),l+="a=mid:"+e.mid+"\r\n",l+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var s="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";l+="a="+s,l+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,l+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return l+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(l+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),l},i.getDirection=function(e,t){for(var n=i.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},"object"==typeof t&&(t.exports=i)},{}],3:[function(e,n,i){(function(t){"use strict";var i=e("./adapter_factory.js");n.exports=i({window:t.window})}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":4}],4:[function(e,t,n){"use strict";var i=e("./utils");t.exports=function(t,n){var r=t&&t.window,l={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);var o=i.log,a=i.detectBrowser(r),u=e("./chrome/chrome_shim")||null,c=e("./edge/edge_shim")||null,d=e("./firefox/firefox_shim")||null,h=e("./safari/safari_shim")||null,p=e("./common_shim")||null,g={browserDetails:a,commonShim:p,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(a.browser){case"chrome":if(!u||!u.shimPeerConnection||!l.shimChrome)return o("Chrome shim is not included in this adapter release."),g;o("adapter.js shimming chrome."),g.browserShim=u,p.shimCreateObjectURL(r),u.shimGetUserMedia(r),u.shimMediaStream(r),u.shimSourceObject(r),u.shimPeerConnection(r),u.shimOnTrack(r),u.shimAddTrackRemoveTrack(r),u.shimGetSendersWithDtmf(r),u.shimSenderReceiverGetStats(r),u.fixNegotiationNeeded(r),p.shimRTCIceCandidate(r),p.shimMaxMessageSize(r),p.shimSendThrowTypeError(r);break;case"firefox":if(!d||!d.shimPeerConnection||!l.shimFirefox)return o("Firefox shim is not included in this adapter release."),g;o("adapter.js shimming firefox."),g.browserShim=d,p.shimCreateObjectURL(r),d.shimGetUserMedia(r),d.shimSourceObject(r),d.shimPeerConnection(r),d.shimOnTrack(r),d.shimRemoveStream(r),d.shimSenderGetStats(r),d.shimReceiverGetStats(r),d.shimRTCDataChannel(r),p.shimRTCIceCandidate(r),p.shimMaxMessageSize(r),p.shimSendThrowTypeError(r);break;case"edge":if(!c||!c.shimPeerConnection||!l.shimEdge)return o("MS edge shim is not included in this adapter release."),g;o("adapter.js shimming edge."),g.browserShim=c,p.shimCreateObjectURL(r),c.shimGetUserMedia(r),c.shimPeerConnection(r),c.shimReplaceTrack(r),p.shimMaxMessageSize(r),p.shimSendThrowTypeError(r);break;case"safari":if(!h||!l.shimSafari)return o("Safari shim is not included in this adapter release."),g;o("adapter.js shimming safari."),g.browserShim=h,p.shimCreateObjectURL(r),h.shimRTCIceServerUrls(r),h.shimCallbacksAPI(r),h.shimLocalStreamsAPI(r),h.shimRemoteStreamsAPI(r),h.shimTrackEventTransceiver(r),h.shimGetUserMedia(r),h.shimCreateOfferLegacy(r),p.shimRTCIceCandidate(r),p.shimMaxMessageSize(r),p.shimSendThrowTypeError(r);break;default:o("Unsupported browser!")}return g}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":11,"./safari/safari_shim":13,"./utils":14}],5:[function(e,t,n){"use strict";function i(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;var l=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&l.push(e)}),l.forEach(function(t){e.forEach(function(n){n.type===i&&n.trackId===t.id&&function e(t,n,i){n&&!i.has(n.id)&&(i.set(n.id,n),Object.keys(n).forEach(function(r){r.endsWith("Id")?e(t,t.get(n[r]),i):r.endsWith("Ids")&&n[r].forEach(function(n){e(t,t.get(n),i)})}))}(e,n,r)})}),r}var r=e("../utils.js"),l=r.log;t.exports={shimGetUserMedia:e("./getusermedia"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)"RTCRtpTransceiver"in e||r.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||(e.transceiver={receiver:e.receiver}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(i){var r;r=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===i.track.id}):{track:i.track};var l=new Event("track");l.track=i.track,l.receiver=r,l.transceiver={receiver:r},l.streams=[t.stream],n.dispatchEvent(l)}),t.stream.getTracks().forEach(function(i){var r;r=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===i.id}):{track:i};var l=new Event("track");l.track=i,l.receiver=r,l.transceiver={receiver:r},l.streams=[t.stream],n.dispatchEvent(l)})},n.addEventListener("addstream",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],r.apply(n,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var l=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],l.apply(t,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return i(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var l=e.RTCPeerConnection.prototype.getReceivers;l&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=l.apply(e,[]);return t.forEach(function(t){t._pc=e}),t}),r.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return i(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,i,r=arguments[0];return this.getSenders().forEach(function(e){e.track===r&&(t?i=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===r&&(n?i=!0:n=e),e.track===r}),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var i=t.getSenders();n.apply(this,arguments);var r=t.getSenders().filter(function(e){return-1===i.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(r)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]}),r.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){function t(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}var n=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&n.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var l=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!n._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());n._streams[t.id]=i,n._reverseStreams[i.id]=t,t=i}l.apply(n,[t])};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var i=this;if("closed"===i.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(i.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");i._streams=i._streams||{},i._reverseStreams=i._reverseStreams||{};var l=i._streams[n.id];if(l)l.addTrack(t),Promise.resolve().then(function(){i.dispatchEvent(new Event("negotiationneeded"))});else{var s=new e.MediaStream([t]);i._streams[n.id]=s,i._reverseStreams[s.id]=n,i.addStream(s)}return i.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(n){var i=e.RTCPeerConnection.prototype[n];e.RTCPeerConnection.prototype[n]=function(){var e=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(e,[function(i){var r=t(e,i);n[0].apply(null,[r])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):i.apply(e,arguments).then(function(n){return t(e,n)})}});var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:t(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===t.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var n;if(!(e._pc===t))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");t._streams=t._streams||{},Object.keys(t._streams).forEach(function(i){t._streams[i].getTracks().find(function(t){return e.track===t})&&(n=t._streams[i])}),n&&(1===n.getTracks().length?t.removeStream(t._reverseStreams[n.id]):n.removeTrack(e.track),t.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection)e.RTCPeerConnection=function(t,n){return l("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}});else{var n=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var i=[],l=0;l<e.iceServers.length;l++){var s=e.iceServers[l];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,i.push(s)):i.push(e.iceServers[l])}e.iceServers=i}return new n(e,t)},e.RTCPeerConnection.prototype=n.prototype,Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var r=this,l=arguments;if(arguments.length>0&&"function"==typeof e)return i.apply(this,arguments);if(0===i.length&&(0===arguments.length||"function"!=typeof arguments[0]))return i.apply(this,[]);var s=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},o=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};return arguments.length>=2?i.apply(this,[function(e){l[1](o(s(e)))},arguments[0]]):new Promise(function(e,t){i.apply(r,[function(t){e(o(s(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,i=new Promise(function(i,r){n.apply(t,[e[0],i,r])});return e.length<2?i:i.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,r){n.apply(e,[i,r,t])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var s=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?s.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},fixNegotiationNeeded:function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})},shimGetDisplayMedia:function(e,t){"getDisplayMedia"in e.navigator||("function"==typeof t?navigator.getDisplayMedia=function(e){return t(e).then(function(t){return e.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:e.video.frameRate||3}},navigator.mediaDevices.getUserMedia(e)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}},{"../utils.js":14,"./getusermedia":6}],6:[function(e,t,n){"use strict";var i=e("../utils.js"),r=i.log;t.exports=function(e){var t=i.detectBrowser(e),n=e&&e.navigator,l=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var l={};"number"==typeof i.ideal?(l[r("min",n)]=i.ideal,t.optional.push(l),(l={})[r("max",n)]=i.ideal,t.optional.push(l)):(l[r("",n)]=i.ideal,t.optional.push(l))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=l(e.audio)}if(e&&"object"==typeof e.video){var o,a=e.video.facingMode,u=t.version<66;if((a=a&&("object"==typeof a?a:{ideal:a}))&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||u)&&(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?o=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(o=["front"]),o))return n.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return o.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!n&&t.length&&-1!==o.indexOf("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=a.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=l(e.video),r("chrome: "+JSON.stringify(e)),i(e)});e.video=l(e.video)}return r("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};n.getUserMedia=function(e,t,i){s(e,function(e){n.webkitGetUserMedia(e,t,function(e){i&&i(o(e))})})};var a=function(e){return new Promise(function(t,i){n.getUserMedia(e,t,i)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:a,enumerateDevices:function(){return new Promise(function(t){var n={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return s(e,function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(o(e))})})}}else n.mediaDevices.getUserMedia=function(e){return a(e)};void 0===n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),void 0===n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":14}],7:[function(e,t,n){"use strict";var i=e("sdp"),r=e("./utils");t.exports={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=i.parseCandidate(e.candidate),l=Object.assign(n,r);return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,r.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),i=t.revokeObjectURL.bind(t),l=new Map,s=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++s;return l.set(t,e),r.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return n(e)},t.revokeObjectURL=function(e){i(e),l.delete(e)};var o=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return o.get.apply(this)},set:function(e){return this.srcObject=l.get(e)||null,o.set.apply(this,[e])}});var a=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=l.get(arguments[1])||null),a.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=r.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,r,l,s;if(this._sctp=null,e=arguments[0],(r=i.splitSections(e.sdp)).shift(),r.some(function(e){var t=i.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})){var o,a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),u=(l=a,s=65536,"firefox"===t.browser&&(s=t.version<57?-1===l?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),s),c=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var l=i.matchPrefix(e.sdp,"a=max-message-size:");return l.length>0?r=parseInt(l[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],a);o=0===u&&0===c?Number.POSITIVE_INFINITY:0===u||0===c?Math.max(u,c):Math.min(u,c);var d={};Object.defineProperty(d,"maxMessageSize",{get:function(){return o}}),this._sctp=d}return n.apply(this,arguments)}}},shimSendThrowTypeError:function(e){function t(e,t){var n=e.send;e.send=function(){var i=arguments[0];if("open"===e.readyState&&t.sctp&&(i.length||i.size||i.byteLength)>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},r.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})}}}},{"./utils":14,sdp:2}],8:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./filtericeservers"),l=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=i.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var s=l(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=r(e.iceServers)),new s(e)},e.RTCPeerConnection.prototype=s.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}}},{"../utils":14,"./filtericeservers":9,"./getusermedia":10,"rtcpeerconnection-shim":1}],9:[function(e,t,n){"use strict";var i=e("../utils");t.exports=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var l="string"==typeof r;return l&&(r=[r]),r=r.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=l?r[0]:r,!!r.length}})}},{"../utils":14}],10:[function(e,t,n){"use strict";t.exports=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(function(e){return Promise.reject({name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}})})}}},{}],11:[function(e,t,n){"use strict";var i=e("../utils");t.exports={shimGetUserMedia:e("./getusermedia"),shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=i.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,i){if(t.version<38&&n&&n.iceServers){for(var r=[],l=0;l<n.iceServers.length;l++){var s=n.iceServers[l];if(s.hasOwnProperty("urls"))for(var o=0;o<s.urls.length;o++){var a={url:s.urls[o]};0===s.urls[o].indexOf("turn")&&(a.username=s.username,a.credential=s.credential),r.push(a)}else r.push(n.iceServers[l])}n.iceServers=r}return new e.mozRTCPeerConnection(n,i)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,i){return l.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t}(e)),t.version<53&&!n)try{e.forEach(function(e){e.type=r[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))})}return e}).then(n,i)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n}),i.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;i.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&-1!==e.getTracks().indexOf(n.track)&&t.removeTrack(n)})})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){"getDisplayMedia"in e.navigator||(navigator.getDisplayMedia=function(e){if(!e||!e.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===e.video?e.video={mediaSource:t}:e.video.mediaSource=t,navigator.mediaDevices.getUserMedia(e)})}}},{"../utils":14,"./getusermedia":12}],12:[function(e,t,n){"use strict";var i=e("../utils"),r=i.log;t.exports=function(e){var t=i.detectBrowser(e),n=e&&e.navigator,l=e&&e.MediaStreamTrack,s=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,i,l){var o=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===i.min&&void 0===i.max&&void 0===i.exact||t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var r={};r[n]="number"==typeof i.ideal?{min:i.ideal,max:i.ideal}:i.ideal,e.advanced.push(r),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(r("spec: "+JSON.stringify(e)),e.audio&&(e.audio=o(e.audio)),e.video&&(e.video=o(e.video)),r("ff37: "+JSON.stringify(e))),n.mozGetUserMedia(e,i,function(e){l(s(e))})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(e){return new Promise(function(t,n){o(e,t,n)})},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var a=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return a().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(s(e))})}}if(!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var c=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),c(e.audio,"autoGainControl","mozAutoGainControl"),c(e.audio,"noiseSuppression","mozNoiseSuppression")),d(e)},l&&l.prototype.getSettings){var h=l.prototype.getSettings;l.prototype.getSettings=function(){var e=h.apply(this,arguments);return c(e,"mozAutoGainControl","autoGainControl"),c(e,"mozNoiseSuppression","noiseSuppression"),e}}if(l&&l.prototype.applyConstraints){var p=l.prototype.applyConstraints;l.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),c(e,"autoGainControl","mozAutoGainControl"),c(e,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[e])}}}n.getUserMedia=function(e,r,l){if(t.version<44)return o(e,r,l);i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(r,l)}}},{"../utils":14}],13:[function(e,t,n){"use strict";var i=e("../utils");t.exports={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(n){n.id===e&&(t=n)}),this._remoteStreams&&this._remoteStreams.forEach(function(n){n.id===e&&(t=n)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach(function(i){t.call(n,i,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,i=e.getTracks();this.getSenders().forEach(function(e){-1!==i.indexOf(e.track)&&n.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){"object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})})}}))},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,l=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var i=n.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=i.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return t?(n.then(e,t),Promise.resolve()):n};var o=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=o,t.setRemoteDescription=o=function(e,t,n){var i=l.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=o=function(e,t,n){var i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i}}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],l=0;l<e.iceServers.length;l++){var s=e.iceServers[l];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,r.push(s)):r.push(e.iceServers[l])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveAudio&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}}}},{"../utils":14}],14:[function(e,t,n){"use strict";function i(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}var r=!0,l=!0;t.exports={extractVersion:i,wrapPeerConnectionEvent:function(e,t,n){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);var l=function(e){var t=n(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=l,r.apply(this,[e,l])};var l=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return l.apply(this,arguments);var i=this._eventMap[n];return delete this._eventMap[n],l.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(l=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){l&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=i(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)n.browser="chrome",n.version=i(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=i(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=i(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}}},{}]},{},[3])(3)}).call(this,n(17))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2),l=n(18),s=n(3),o=function(){function e(e,t,n,l){this.state=i.ENUM_PUBLISH_STATE.stop,this.sessionId=0,this.waitingICETimeInterval=5e3,this.waitingAnswerTimeInterval=5e3,this.candidateInfo=[],this.waitingICETimer=null,this.waitingAnswerTimer=null,this.qualityTimer=null,this.publishQualityList=[],this.maxQualityListCount=10,this.lastPublishStats={},this.reportSeq=r.getSeq(),this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.qualitySeq=0,this.maxRetryCount=3,this.currentRetryCount=0,this.retryState=i.ENUM_RETRY_STATE.didNotStart,this.waitingServerTimerInterval=3e3,this.waitingServerTimer=null,this.videoInfo={width:0,height:0,frameRate:0,bitRate:0},this.offerSeq=0,this.qualityCount=0,this.closeSessionSignal=!1,this.logger=e,this.signal=t,this.dataReport=n,this.qualityTimeInterval=l,n.newReport(this.reportSeq)}return e.prototype.publishStateUpdateError=function(e){0!=this.sessionId&&this.shouldSendCloseSession(e)&&(this.signal.sendCloseSession(r.getSeq(),this.sessionId,1),this.closeSessionSignal=!0),this.state=i.ENUM_PUBLISH_STATE.stop,this.onPublishStateUpdate(r.ENUM_PUBLISH_STATE_UPDATE.error,this.streamId,e),this.resetPublish()},e.prototype.resetPublish=function(){this.logger.info("zp.rp.0 call"),this.streamId=null,this.state=i.ENUM_PUBLISH_STATE.stop,void 0==this.peerConnection&&null==this.peerConnection||(this.peerConnection.close(),this.peerConnection=null),null!=this.waitingAnswerTimer&&(clearTimeout(this.waitingAnswerTimer),this.waitingAnswerTimer=null),null!=this.waitingICETimer&&(clearTimeout(this.waitingICETimer),this.waitingICETimer=null),this.clearPublishQualityTimer(),this.signal&&(this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId)),this.sessionSeq=0,this.offerSeq=0,this.candidateInfo=[],this.publishQualityList=[],this.qualityUploadLastTime=0,this.currentRetryCount=0,this.retryState=i.ENUM_RETRY_STATE.didNotStart,this.clearTryPublishTimer()},e.prototype.clearTryPublishTimer=function(){null!=this.waitingServerTimer&&(clearTimeout(this.waitingServerTimer),this.waitingServerTimer=null)},e.prototype.clearPublishQualityTimer=function(){null!=this.qualityTimer&&(clearInterval(this.qualityTimer),this.qualityTimer=null),this.lastPublishStats={},this.qualityCount=0},e.prototype.shouldSendCloseSession=function(e){return this.state!=i.ENUM_PUBLISH_STATE.stop&&this.state!=i.ENUM_PUBLISH_STATE.waitingSessionRsp},e.prototype.startPublish=function(e,t,n,l){var s=this;this.logger.info("zp.sp.0 called"),e?(this.streamId=e,this.localStream=t,n&&(this.videoInfo=n),this.sessionSeq=r.getSeq(),this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,0,0,e,l&&l.streamParams,function(e,t,n){s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{sessionId:n.session_id}),s.logger.info("zp.sp.0 sessionId:"+n.session_id),s.sessionSeq==e?0!==n.result?(s.logger.error("zp.sp.0 create session failed "+n.result),s.publishStateUpdateError(r.publishErrorList.CREATE_SESSION_ERROR)):(s.sessionId=n.session_id,s.logger.debug("zp.sp.0 create session success "+s.sessionId),s.onCreatePublishSessionSuccess(n)):s.logger.error("zp.sp.0 seq is not match.")},function(e,t){s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{error:e}),s.publishStateUpdateError(r.publishErrorList.SEND_SESSION_TIMEOUT)}),this.state=i.ENUM_PUBLISH_STATE.waitingSessionRsp,this.logger.debug("zp.sp.0 called success")):this.logger.error("zp.sp.0 streamId is null")},e.prototype.onCreatePublishSessionSuccess=function(e){var t=this;this.logger.info("zp.ops.0 called");var n=[];e.turn_server&&n.push(e.turn_server),e.stun_server&&n.push(e.stun_server);var i={iceTransportPolicy:"relay",iceServers:[{urls:n,username:e.turn_username,credential:e.turn_auth_key}]};if(this.logger.info("zp.ops.0 username: "+e.turn_username),this.logger.info("zp.ops.0 credential: "+e.turn_auth_key),this.peerConnection=new RTCPeerConnection(i),this.peerConnection.onicecandidate=function(e){t.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){t.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){t.onIceConnectionStateChange(e)},this.localStream){this.localStream.getTracks().forEach(function(e){t.peerConnection.addTrack(e,t.localStream)});var l=this.localStream.getVideoTracks(),s=this.localStream.getAudioTracks();l.length>0&&this.logger.info("zp.ops.0 video device: "+l[0].label),s.length>0&&this.logger.info("zp.ops.0 audio device: "+s[0].label)}var o={offerToReceiveAudio:[].length>0?1:0,offerToReceiveVideo:[].length>0?1:0};this.logger.info("zp.ops.0 createOffer: "+o),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.peerConnection.createOffer(o).then(function(e){t.dataReport.eventEnd(t.reportSeq,"CreateOffer"),t.onCreateOfferSuccess(e)},function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateOffer",{error:e.toString()}),t.logger.error("zp.ops.0 create offer error "+e.toString()),t.publishStateUpdateError(r.publishErrorList.CREATE_OFFER_ERROR)}),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,function(e,n,i){t.onRecvCandidateInfo(e,n,i)}),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,function(e,n,i){t.onRecvCloseSession(e,n,i)}),this.signal.registerPushCallback("MediaDescPush",this.sessionId,function(e,n,i){t.onRecvMediaDescription(e,n,i)}),this.signal.registerPushCallback("SessionResetPush",this.sessionId,function(e,n,i){t.onRecvResetSession(e,n,i)}),this.logger.debug("zp.ops.0 call success")},e.prototype.onCreateOfferSuccess=function(e){var t=this;0!=this.videoInfo.bitRate&&(e.sdp=this.updateBandwidthRestriction(e.sdp,this.videoInfo.bitRate)),e.sdp=s.sdpUtil.zegoSdp(e.sdp),this.logger.info("zp.oco.0 localSdp ",e.sdp),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.peerConnection.setLocalDescription(e).then(function(){t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription"),t.onSetLocalDescriptionSuccess(e)},function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"SetLocalDescription",{error:e.toString()}),t.logger.error("zp.oco.0 error "+e.toString()),t.publishStateUpdateError(r.publishErrorList.SET_LOCAL_DESC_ERROR)})},e.prototype.updateBandwidthRestriction=function(e,t){var n="AS";return"firefox"===l.browserDetails.browser&&(t=1e3*(t>>>0),n="TIAS"),e=-1===e.indexOf("b="+n+":")?e.replace(/c=IN (.*)\r\n/,"c=IN $1\r\nb="+n+":"+t+"\r\n"):e.replace(new RegExp("b="+n+":.*\r\n"),"b="+n+":"+t+"\r\n")},e.prototype.onSetLocalDescriptionSuccess=function(e){var t=this;this.logger.info("zp.osd.0 success");var n={sdp:e.sdp,width:this.videoInfo.width,height:this.videoInfo.height,frameRate:this.videoInfo.frameRate,video_min_kpbs:this.videoInfo.bitRate,video_max_kpbs:this.videoInfo.bitRate,audio_kpbs:48};this.offerSeq=r.getSeq(),this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.offerSeq,this.sessionId,0,n,function(e,n,l){t.offerSeq==e&&t.sessionId==n?(t.logger.info("zp.osd.0 send success"),t.dataReport.eventEnd(t.reportSeq,"SendMediaDesc"),t.waitingAnswerTimer=setTimeout(function(){t.state==i.ENUM_PUBLISH_STATE.waitingServerAnswer&&(t.logger.error("zp.osd.0 waiting timeout"),t.publishStateUpdateError(r.publishErrorList.SERVER_MEDIA_DESC_TIMEOUT))},t.waitingAnswerTimeInterval),t.state=i.ENUM_PUBLISH_STATE.waitingServerAnswer):t.logger.error("zp.osd.0 seq or sessionId is not equal")},function(e,n){t.dataReport.eventEndWithMsg(t.reportSeq,"SendMediaDesc",{error:e}),t.publishStateUpdateError(r.publishErrorList.SEND_MEDIA_DESC_TIMEOUT)}),this.state=i.ENUM_PUBLISH_STATE.waitingOffserRsp,this.logger.debug("zp.osd.0 call success")},e.prototype.stopPublish=function(){this.logger.debug("zp.sp.0.1 called"),this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(r.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.reportSeq,"PublishState",{state:this.state+""}),this.dataReport.addEvent(this.reportSeq,"StopPublish"),this.dataReport.addMsgExt(this.reportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.dataReport.uploadReport(this.reportSeq,"RTCPublishStream"),this.resetPublish()},e.prototype.onPublishStateUpdate=function(e,t,n){},e.prototype.onPublishQualityUpdate=function(e,t){},e.prototype.onDisconnect=function(){this.logger.info("zp.od.0 call"),this.logger.info("zp.od.0 websocket disconnect"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.publishStateUpdateError(r.publishErrorList.WEBSOCKET_ERROR)},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info("zp.sci.0 called"),!(e=e.filter(function(e){return e.candidate.indexOf("relay")>0}))||e.length<1?this.logger.info("zp.sci.0 cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.signal.sendCandidateInfo(r.getSeq(),this.sessionId,e,function(e,n,i){t.logger.debug("zp.sci.0 send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate")},function(e,n){t.logger.error("zp.sci.0 failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.publishStateUpdateError(r.publishErrorList.SEND_CANDIDATE_TIMEOUT)}))},e.prototype.onIceConnectionStateChange=function(e){this.state!=i.ENUM_PUBLISH_STATE.stop&&null!=this.peerConnection&&(this.logger.info("zp.oics.0 stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState?(this.logger.info("zp.oics.0 connected state "+this.state),this.dataReport.eventEnd(this.reportSeq,"IceConnected"),this.state!=i.ENUM_PUBLISH_STATE.publishing&&this.onPublishStateUpdate(r.ENUM_PUBLISH_STATE_UPDATE.start,this.streamId),this.state=i.ENUM_PUBLISH_STATE.publishing,this.retryState!=i.ENUM_RETRY_STATE.didNotStart&&(this.retryState=i.ENUM_RETRY_STATE.finished,this.currentRetryCount=0),this.dataReport.eventStart(this.reportSeq,"PublishState"),this.setPublishQualityTimer()):"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)))},e.prototype.onIceCandidate=function(e){if(e.candidate)if(this.logger.info("zp.oic.0 candidate"+e.candidate.candidate),this.state<i.ENUM_PUBLISH_STATE.waitingServerICE||this.state==i.ENUM_PUBLISH_STATE.stop)this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{this.sendCandidateInfo([{candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}])}},e.prototype.onConnectionStateChange=function(e){this.logger.info("zp.ocs.0 called "+e.target.signalingState)},e.prototype.onRecvMediaDescription=function(e,t,n){this.logger.info("zp.ormd.0 received"),this.state==i.ENUM_PUBLISH_STATE.waitingServerAnswer?(null!=this.waitingAnswerTimer&&(clearTimeout(this.waitingAnswerTimer),this.waitingAnswerTimer=null),this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),1==n.type?this.onGetRemoteOfferSucceses(n.sdp):this.publishStateUpdateError(r.publishErrorList.SERVER_MEDIA_DESC_ERROR)):this.logger.info("zp.ormd.0 current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSucceses=function(e){var t=this;this.logger.info("zp.oro.0 remoteSdp:",e);var n={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).then(function(){t.logger.info("zp.oro.0 set success"),t.dataReport.eventEnd(t.reportSeq,"SetRemoteDescription")},function(e){t.logger.error("zp.oro.0 failed: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SetRemoteDescription",{error:e.toString()}),t.publishStateUpdateError(r.publishErrorList.SET_REMOTE_DESC_ERROR)}),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[],this.state=i.ENUM_PUBLISH_STATE.waitingServerICE,this.waitingICETimer=setTimeout(function(){t.state==i.ENUM_PUBLISH_STATE.waitingServerICE&&(t.logger.error("zp.orod.0 waiting server timeout"),t.publishStateUpdateError(r.publishErrorList.SERVER_CANDIDATE_TIMEOUT))},this.waitingICETimeInterval),this.logger.debug("zp.oro.0 call success")},e.prototype.onRecvCandidateInfo=function(e,t,n){var l=this;if(this.logger.debug("zp.oci.0 received "+n.infos.length),this.state==i.ENUM_PUBLISH_STATE.waitingServerICE){null!=this.waitingICETimer&&(clearTimeout(this.waitingICETimer),this.waitingICETimer=null),this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0);for(var s=0;s<n.infos.length;s++){var o={sdpMid:n.infos[s].sdpMid,sdpMLineIndex:n.infos[s].sdpMLineIndex,candidate:n.infos[s].candidate};this.logger.debug("zp.orci.0 candidate "+o.candidate),this.peerConnection.addIceCandidate(new RTCIceCandidate(o)).then(function(){l.logger.debug("zp.oci.0 add success")},function(e){l.logger.error("zp.oci.0 add error "+e.toString()),l.publishStateUpdateError(r.publishErrorList.SERVER_CANDIDATE_ERROR)})}this.state=i.ENUM_PUBLISH_STATE.connecting,this.dataReport.eventStart(this.reportSeq,"IceConnected")}else this.logger.info("zp.oci.0 current state "+this.state+" not allowed")},e.prototype.onRecvCloseSession=function(e,t,n){this.logger.info("zp.orcs.0 reason: "+n.reason),this.dataReport.addEvent(this.reportSeq,"RecvCloseSession"),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=JSON.parse(JSON.stringify(r.publishErrorList.SESSION_CLOSED));i.msg+=n.reason,this.publishStateUpdateError(i)},e.prototype.onRecvResetSession=function(e,t,n){this.logger.info("zp.orrs.0 received "),t==this.sessionId?(this.dataReport.addEvent(this.reportSeq,"RecvResetSession"),this.shouldRetryPublish()&&this.startRetryPublish()):this.logger.error("zp.orrs.0 cannot find session")},e.prototype.shouldRetryPublish=function(){return this.retryState==i.ENUM_RETRY_STATE.didNotStart&&this.state!=i.ENUM_PUBLISH_STATE.publishing?(this.logger.info("zp.srp.0.0 connection didn't success"),!1):this.retryState==i.ENUM_RETRY_STATE.retrying?(this.logger.info("zp.srp.0.0 already retrying"),!1):this.currentRetryCount>this.maxRetryCount?(this.logger.info("zp.srp.0.0 beyond max"),!1):(this.logger.info("zp.srp.1.0 call success"),!0)},e.prototype.startRetryPublish=function(){this.logger.info("zp.srp.0 call");var e=this.streamId;e?(this.resetPublish(),this.tryStartPublish(e)):this.logger.info("zp.srp.0 no streamid")},e.prototype.tryStartPublish=function(e){var t=this;if(this.logger.info("zp.tsp.0 call"),this.clearTryPublishTimer(),this.streamId=e,this.currentRetryCount>this.maxRetryCount)return this.logger.info("zp.tsp.0 beyond max limit"),void this.publishStateUpdateError(r.publishErrorList.WEBSOCKET_ERROR);this.retryState=i.ENUM_RETRY_STATE.retrying,this.currentRetryCount+=1,this.signal.isServerConnected()?(this.logger.debug("zp.tsp.0 signal connected"),this.startPublish(e,this.localStream,this.videoInfo)):(this.logger.debug("zp.tsp.0 signal server not connected"),this.waitingAnswerTimer=setTimeout(function(){t.tryStartPublish(e)},this.waitingAnswerTimeInterval))},e.prototype.checkPublishConnectionFailedState=function(e){var t=null;"failed"==e?t=r.publishErrorList.MEDIA_CONNECTION_FAILED:"closed"==e&&(t=r.publishErrorList.MEDIA_CONNECTION_CLOSED),null!=t&&(this.state!=i.ENUM_PUBLISH_STATE.publishing&&this.retryState==i.ENUM_PUBLISH_STATE.didNotStart?(this.logger.info("zp.oics.0  state "+this.state+" retryState "+this.retryState+" connectionState "+e),this.publishStateUpdateError(t)):this.shouldRetryPublish()?(this.onPublishStateUpdate(r.ENUM_PUBLISH_STATE_UPDATE.retry,this.streamId),this.startRetryPublish()):this.publishStateUpdateError(t))},e.prototype.setPublishQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.debug("zp.spq.0 called"),this.clearPublishQualityTimer(),this.qualityTimer=setInterval(function(){e.peerConnection&&e.peerConnection.getStats(null).then(function(t){e.getPublishStats(t)},function(t){e.logger.info("zp.spq.0 getStats error "+t.toString())})},this.qualityTimeInterval),this.lastPublishStats={time:0,audioBytesSent:0,videoBytesSent:0,framesEncoded:0,framesSent:0},this.qualitySeq=r.getSeq(),this.qualityCount=0,this.dataReport.newReport(this.qualitySeq))},e.prototype.getPublishStats=function(e){var t=this;if(e){var n={audioBitrate:0,videoBitrate:0,videoFPS:0,nackCount:0,pliCount:0,sliCount:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,totalRoundTripTime:0,currentRoundTripTime:0},i=this.lastPublishStats.time;e.forEach(function(e){("outbound-rtp"==e.type||"ssrc"==e.type&&void 0!=e.bytesSent)&&"audio"==e.mediaType?(0!=i&&(n.audioBitrate=8*(e.bytesSent-t.lastPublishStats.audioBytesSent)/(e.timestamp-i)),n.audioBitrate<0&&(n.audioBitrate=0),t.lastPublishStats.audioBytesSent=e.bytesSent,t.lastPublishStats.time=e.timestamp):("outbound-rtp"==e.type||"ssrc"==e.type&&void 0!=e.bytesSent)&&"video"==e.mediaType?(0!=i&&(n.videoBitrate=8*(e.bytesSent-t.lastPublishStats.videoBytesSent)/(e.timestamp-i),n.videoFPS=1e3*(e.framesEncoded-t.lastPublishStats.framesEncoded)/(e.timestamp-i)),n.videoBitrate<0&&(n.videoBitrate=0),n.videoFPS<0&&(n.videoFPS=0),n.nackCount=e.nackCount,n.pliCount=e.pliCount,n.sliCount=e.sliCount,t.lastPublishStats.videoBytesSent=e.bytesSent,t.lastPublishStats.framesEncoded=e.framesEncoded,t.lastPublishStats.time=e.timestamp):"track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0)?(n.frameHeight=e.frameHeight,n.frameWidth=e.frameWidth,0!=i&&(n.videoTransferFPS=1e3*(e.framesSent-t.lastPublishStats.framesSent)/(e.timestamp-i)),n.videoTransferFPS<0&&(n.videoTransferFPS=0),t.lastPublishStats.framesSent=e.framesSent):"candidate-pair"==e.type&&(void 0!=e.totalRoundTripTime&&(n.totalRoundTripTime=e.totalRoundTripTime),void 0!=e.currentRoundTripTime&&(n.currentRoundTripTime=e.currentRoundTripTime))}),this.uploadPublishQuality(n),0!=i&&this.onPublishQualityUpdate(this.streamId,n)}},e.prototype.uploadPublishQuality=function(e){var t=this;if(this.qualityUpload){var n=Date.parse(new Date+"");(0==this.qualityUploadLastTime||n-this.qualityUploadLastTime>=this.qualityUploadInterval)&&(this.logger.debug("zp.upq.0 upload"),e.stream_type="publish",e.stream_id=this.streamId,e.timeStamp=n/1e3,this.signal.QualityReport(r.getSeq(),this.sessionId,e,function(e,n,i){void 0!==i.report&&(t.qualityUpload=i.report,t.qualityUploadInterval=i.report_interval_ms)},function(e,n){t.logger.info("zp.upq.0 upload failed "+e)}),this.qualityUploadLastTime=n)}},e}();t.ZegoPublish=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e){var t=this;this.log=e,this.localVideo=null,this.localStream=null,this.videoInfo={},this.previewSuc=!1,this.enableMicrophone=function(e){return t.localStream?(t.localStream.getAudioTracks().forEach(function(t){t.enabled=e}),t.logger.debug("zp.em.2 call success"),!0):(t.logger.error("zp.em.2 no localStream"),!1)},this.enableCamera=function(e){return t.localStream?(t.localStream.getVideoTracks().forEach(function(t){t.enabled=e}),t.logger.debug("zp.ec.2 call success"),!0):(t.logger.error("zp.ec.2 no localStream"),!1)},this.setAudioDestination=function(e){return t.localVideo?"undefined"!==t.localVideo.sinkId?(t.localVideo.setSinkId(e).then(function(){t.logger.info("zp.sad.2 success device: "+e)}).catch(function(e){t.logger.info("zp.sad.2 "+e.name)}),!0):(t.logger.error("zp.sad.2 browser does not suppport"),!1):(t.logger.error("zp.sad.2 no localVideo"),!1)},this.logger=e}return e.prototype.getMediaStreamConstraints=function(e){var t={audio:null,video:null};if(t.audio=!1,t.video=!1,e.audio&&(t.audio=!e.audioInput||{deviceId:{exact:e.audioInput}}),e.video){var n=640,r=480,l=15,s=800;if(1===e.videoQuality?(n=i.ENUM_RESOLUTION_TYPE.LOW.width,r=i.ENUM_RESOLUTION_TYPE.LOW.height,l=i.ENUM_RESOLUTION_TYPE.LOW.frameRate,s=i.ENUM_RESOLUTION_TYPE.LOW.bitRate):2===e.videoQuality?(n=i.ENUM_RESOLUTION_TYPE.MEDIUM.width,r=i.ENUM_RESOLUTION_TYPE.MEDIUM.height,l=i.ENUM_RESOLUTION_TYPE.MEDIUM.frameRate,s=i.ENUM_RESOLUTION_TYPE.MEDIUM.bitRate):3===e.videoQuality?(n=i.ENUM_RESOLUTION_TYPE.HIGH.width,r=i.ENUM_RESOLUTION_TYPE.HIGH.height,l=i.ENUM_RESOLUTION_TYPE.HIGH.frameRate,s=i.ENUM_RESOLUTION_TYPE.HIGH.bitRate):4===e.videoQuality?(n=e.width,r=e.height,l=e.frameRate,s=e.bitRate||800):this.logger.info("zp.gmsc.2 user default"),!0===e.horizontal){var o=r;r=n,n=o}t.video={width:n,height:r,frameRate:l,bitRate:s},void 0!=e.facingMode?t.video.facingMode=e.facingMode:void 0!=e.videoInput&&(t.video.deviceId={exact:e.videoInput}),this.logger.info("zp.gmsc.2 width: "+n+" height: "+r+" rate: "+l)}return t},e.prototype.startPreview=function(e,t,n,i){var r=this;if(this.logger.debug("zp.sv.2 called"),this.localVideo=e,void 0!==navigator.mediaDevices&&void 0!=navigator.mediaDevices.getUserMedia){if(t.externalMediaStream instanceof MediaStream)return this.logger.debug("zp.sv.2 use external media stream"),this.localStream=t.externalMediaStream,this.videoInfo={width:t.width,height:t.height,frameRate:t.frameRate,bitRate:t.bitRate},void(n&&n());if(t.externalCapture)this.captureStream(e)?n&&n():i&&i("browser don't support");else{var l=this.getMediaStreamConstraints(t);this.videoInfo=l.video,this.logger.info("zp.sv.2 ",JSON.stringify(l)),navigator.mediaDevices.getUserMedia(l).then(function(e){if(r.logger.info("zp.sv.2 success"),!r.localVideo)return r.logger.info("zp.sv.2 no localVideo"),void(i&&i("no localVideo"));r.localVideo.srcObject=e,r.localStream=e,r.previewSuc=!0,n&&n()},function(e){r.logger.info("zp.sv.2 failed"),i&&i(e.name)})}}else i&&i("browser don't support")},e.prototype.captureStream=function(e){if(!e)return this.logger.info("zp.cs.2 no local video"),!1;if(e.captureStream)this.localStream=e.captureStream(),this.logger.debug("zp.cs.2 captureStream");else{if(!e.mozCaptureStream)return this.logger.info("zp.cs.2 don't support"),!1;this.localStream=e.mozCaptureStream(),this.logger.debug("zp.cs.2 mozCaptureStream")}return this.videoInfo={width:e.videoWidth,height:e.videoHeight,frameRate:0,bitRate:0},this.logger.debug("zp.cs.2 called success"),!0},e.prototype.stopPreview=function(){this.logger.info("zp.sv.2.1 called"),this.localStream&&(this.localStream.getTracks().forEach(function(e){e.stop()}),this.localStream=null,this.localVideo.srcObject=null,this.localVideo=null,this.videoInfo={})},e}();t.ZegoPreview=r},function(e,t,n){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.log=e,this.dataStatistics={},this.logger=e}return e.prototype.newReport=function(e){this.dataStatistics[e]={abs_time:Date.now(),time_consumed:0,error:0,events:[]}},e.prototype.addMsgExt=function(e,t){this.dataStatistics[e]?this.dataStatistics[e].msg_ext=t:console.warn(e+" not exist")},e.prototype.eventStart=function(e,t){this.dataStatistics[e]?void 0!=this.dataStatistics[e].events?this.dataStatistics[e].events.push({event:t,abs_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no events"):this.logger.warn("zd.es.0 no seq match")},e.prototype.eventEnd=function(e,t,n){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(i&&0!==i.length){for(var r=i.length-1;r>=0;r--)if(i[r].event==t&&i[r].time_consumed){i[r].time_consumed=Date.now()-i[r].abs_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},e.prototype.eventEndWithMsg=function(e,t,n){if(this.dataStatistics[e]){var r=this.dataStatistics[e].events;if(r){for(var l=r.length-1;l>=0;l--)if(r[l].event==t&&r[l].time_consumed){r[l].time_consumed=Date.now()-r[l].abs_time,void 0==r[l].msg_ext&&(r[l].msg_ext={}),r[l].msg_ext=i({},n);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},e.prototype.addEventInfo=function(e,t,n,i){if(this.dataStatistics[e]){var r=this.dataStatistics[e].events;if(void 0!=r){for(var l=r.length-1;l>=0;l--)if(r[l].event==t&&void 0!=r[l].time_consumed&&r[l].event==t&&void 0!=r[l].time_consumed){void 0==r[l].msg_ext&&(r[l].msg_ext={}),r[l].msg_ext[n]=i;break}}else this.logger.warn("zd.aei.0 no events")}else this.logger.warn("zd.aei.0 no seq match")},e.prototype.addEvent=function(e,t,n){this.dataStatistics[e]?this.dataStatistics[e].events&&this.dataStatistics[e].events.push(n?{event:t,abs_time:Date.now(),msg_ext:n}:{event:t,abs_time:Date.now()}):this.logger.warn("zd.ae.0 no seq match")},e.prototype.uploadReport=function(e,t){var n=this.dataStatistics[e];void 0!=n&&(n.itemtype=t,n.time_consumed=Date.now()-n.abs_time,this.logger.report(n),delete this.dataStatistics[e])},e}();t.ZegoDataReport=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=n(21),s=n(20),o=n(19),a=n(2),u=n(0),c=n(16),d=n(15),h=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.playerList={},i.publisherList={},i.testEnvironment=!1,i.heartbeatTimer=null,i.heartbeatInterval=1e4,i.qualityTimerInterval=3e3,i.maxRetryCount=5,i.previewVideoList=[],i.signalList={},i.checkMessageTimeout=function(){for(var e in i.signalList)i.signalList[e].signal&&i.signalList[e].signal.checkMessageTimeout()},i.getAllInUseUrl=function(){var e=[];for(var t in i.signalList)e.push(t);return e},i.onDisconnectHandle=function(e){if(i.logger.info("zsc.od.0 call"),i.signalList[e]){for(var t=i.signalList[e],n=0;n<t.publishConnectedList.length;n++){var r=i.publisherList[t.publishConnectedList[n]];r&&r.publisher&&r.publisher.onDisconnect()}for(n=0;n<t.playConnectedList.length;n++){var l=i.playerList[t.playConnectedList[n]];l&&l.player&&l.player.onDisconnect()}delete i.signalList[e],i.stopSignalHeartbeat()}},i.logger=t,i.stateCenter=n,i.dataReport=new l.ZegoDataReport(i.logger),i}return r(t,e),t.prototype.onSignalDisconnected=function(e){},t.prototype.setQualityMonitorCycle=function(e){this.logger.debug("zsc.qmc.0 timeInterval "+e),this.qualityTimerInterval=e},t.prototype.setSessionInfo=function(e,t,n,i){this.logger.debug("zsc.ssi.0 called"),this.appid=e,this.userid=t,this.token=n,this.testEnvironment=i},t.prototype.onPlayStateUpdate=function(e,t,n){},t.prototype.onPlayQualityUpdate=function(e,t){},t.prototype.onPublishStateUpdate=function(e,t,n){},t.prototype.onPublishQualityUpdate=function(e,t){},t.prototype.onUpdateHeartBeartIntervalHandle=function(e){e!=this.heartbeatInterval&&(this.logger.debug("zsc.uhb.0 update "+e),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatInterval=e,this.startSignalHeartbeat())},t.prototype.enableMicrophone=function(e,t){var n=this.checkPreivew(e);return n?n.enableMicrophone(t):(this.logger.info("zsc.em.0 no preview"),!1)},t.prototype.enableCamera=function(e,t){var n=this.checkPreivew(e);return n?n.enableCamera(t):(this.logger.error("zsc.ec.0 no preview"),!1)},t.prototype.startPreview=function(e,t,n,i){if(!e)return this.logger.error("zsc.sp.0 localVideo null"),!1;var r=this.checkPreivew(e);return r?(this.logger.warn("zsc.sp.0 localvideo alredy exist"),!0):(r=new s.ZegoPreview(this.logger),this.previewVideoList.push(r),r.startPreview(e,t,n,i),this.logger.debug("zsc.sp.0 call success"),!0)},t.prototype.stopPreview=function(e){if(!e)return this.logger.warn("zsc.sp.0 localVideo null"),!1;for(var t in this.publisherList)this.publisherList[t].localVideo===e&&(this.publisherList[t].localVideo=null);var n=this.checkPreivew(e);return n?(n.previewSuc&&(n.stopPreview(),this.removePreview(n)),!0):(this.logger.warn("zsc.sp.0 no preview"),!1)},t.prototype.setPublishStateStart=function(e,t,n){var i=this,r=this.getTotalStreamId(e);if(this.publisherList[r])return this.logger.error("zsc.pss.0 publisher already exist"),!1;var l=new o.ZegoPublish(this.logger,null,this.dataReport,this.qualityTimerInterval);return l.onPublishStateUpdate=function(t,n,r){var l=i.publisherList[n];l?i.onPublishStateUpdate(t,l.streamId,r):i.logger.error("zsc.psuh.0 cannot find publish "+e)},l.onPublishQualityUpdate=function(t,n){var r=i.publisherList[t];r?i.onPublishQualityUpdate(r.streamId,n):i.logger.error("zsc.psuh.0 cannot find publish "+e)},this.publisherList[r]={localVideo:t,publisher:l,serverUrls:[],retryCount:0,streamId:e,playOption:n},this.dataReport.eventStart(l.reportSeq,"GetSignalUrl"),!0},t.prototype.getTotalStreamId=function(e){if(this.testEnvironment){var t="zegotest-"+this.appid+"-"+e;return this.logger.info("zsc.gts.0 test streamid "+t),t}return e},t.prototype.startPublishingStream=function(e,t,n){this.logger.info("zsc.sps.0 call");var i=this.getTotalStreamId(e),r=this.publisherList[i];if(!r)return this.logger.error("zsc.sps.0 publisher don't exist"),!1;if(this.dataReport.eventEndWithMsg(r.publisher.reportSeq,"GetSignalUrl",{urls:t}),!t||0===t.length)return this.onPublishStateUpdate(a.ENUM_PUBLISH_STATE_UPDATE.error,e,a.publishErrorList.DISPATCH_ERROR),this.logger.info("zsc.sps.0 server don't have signal url"),!1;var l=t[0];return r.serverUrls=r.serverUrls.concat(t),this.connectPublishServer(i,l)},t.prototype.updateWaitingList=function(e,t,n,i,r){t?e.publishWaitingList.push({streamId:n,success:i,error:r}):e.playWaitingList.push({streamId:n,success:i,error:r})},t.prototype.publishStream=function(e){var t=this.publisherList[e].publisher;if(t){var n=null,i=null,r=this.publisherList[e].playOption,l=this.checkPreivew(this.publisherList[e].localVideo);l&&(n=l.localStream,i=l.videoInfo),n||this.logger.info("zsc.ps.0 no localStream"),this.logger.debug("zsc.ps.0 call success"),t.startPublish(e,n,i,r)}else this.logger.info("zsc.ps.0 publisher don't exist")},t.prototype.connectPublishServer=function(e,t){var n=this,i=this.publisherList[e];return i?(this.dataReport.eventStart(i.publisher.reportSeq,"ConnectServer"),this.connetWithReuseSignalServer(e,!0,t,function(e,i){var r=n.publisherList[e];if(r){var l=r.publisher;if(l){n.dataReport.eventEndWithMsg(l.reportSeq,"ConnectServer",{result:0,server:t});var s=i.tokenInfo;n.logger.info("zsc.cps.0 update token success"),s&&s.report&&(l.qualityUpload=s.report,l.qualityUploadInterval=s.report_interval),l.signal=i.signal,r.retryCount=0,n.publishStream(e),n.getTokenSuccess()}else n.logger.info("zsc.cps.1 check publisher don't exist")}else n.logger.info("zsc.cps.0 after connect publisher don't exist")},function(e,t){n.logger.error("zsc.cps.0 update token failed "+t);var i=n.publisherList[e];if(i)if(n.shouldRetry(i,t)){n.logger.info("zsc.cps.1 retry connect");var r=i.serverUrls[0];i.serverUrls.splice(0,1),i.retryCount+=1,n.connectPublishServer(e,r)}else n.onPublishStateUpdate(a.ENUM_PUBLISH_STATE_UPDATE.error,e,a.publishErrorList.TOKEN_ERROR);else n.logger.info("zsc.cps.0 after connect publisher don't exist")}),!0):(this.logger.error("zsc.cps.0 publisher don't exist"),!1)},t.prototype.shouldRetry=function(e,t){return 0!=e.serverUrls.length&&!(e.retryCount>=this.maxRetryCount)&&3==t},t.prototype.getTokenSuccess=function(){this.logger.debug("zsc.gts.0 call")},t.prototype.stopPublishingStream=function(e){var t=this.getTotalStreamId(e),n=this.publisherList[t];n?(n.publisher&&(n.publisher.stopPublish(),delete n.publisher),this.removeStreamFromSignal(!0,t),this.stopSignalHeartbeat(),delete this.publisherList[t],this.logger.debug("zsc.sps.0.1 call success")):this.logger.warn("zsc.sps.0.1 publisher don't exist")},t.prototype.setPlayStreamAudioOutput=function(e,t){var n=this.getTotalStreamId(e);if(void 0!=t&&0!=t.length){this.logger.debug("zsc.psao.1 device "+t);var i=this.playerList[n];return i?i.player?i.player.setAudioDestination(t):(this.logger.info("zsc.psao.1 player don't exist"),!1):(this.logger.info("zsc.psao.1 play don't exist"),!1)}return!1},t.prototype.setPublishStreamAudioOutput=function(e,t){if(void 0!=t&&0!=t.length&&e){this.logger.debug("zsc.psao.0 device "+t);var n=this.checkPreivew(e);n?n.setAudioDestination(t):this.logger.info("zsc.psao.0 no preview")}return!1},t.prototype.connetWithReuseSignalServer=function(e,t,n,i,r){var l=this;this.logger.info("zsc.crss.0 begin "+n);var s=null;if(this.signalList[n])(s=this.signalList[n]).state==u.ENUM_SIGNAL_STATE.connected?(this.logger.info("zsc.crss.0 already connected "+n+" streamId: "+e),t?s.publishConnectedList.push(e):s.playConnectedList.push(e),i(e,s)):s.state==u.ENUM_SIGNAL_STATE.connecting&&(this.logger.debug("zsc.crss.0 signal is connecting "+n+" streamId: "+e),this.updateWaitingList(s,t,e,i,r));else{this.logger.info("zsc.crss.0 new signal "+n+" streamId: "+e);var o=new c.ZegoSignal(this.logger,this.stateCenter);o.setSessionInfo(this.appid,this.userid),o.onUpdateHeartBeartInterval=this.onUpdateHeartBeartIntervalHandle,o.onDisconnect=this.onDisconnectHandle,this.signalList[n]={signal:o,state:u.ENUM_SIGNAL_STATE.connecting,publishWaitingList:[],playWaitingList:[],publishConnectedList:[],playConnectedList:[],tokenInfo:null},this.updateWaitingList(this.signalList[n],t,e,i,r),o.connectServer(this.token,n,function(e,t,i){s=l.signalList[n];var r,o,a=0;if(0!=e){for(l.logger.debug("zsc.crss.0 connect failed "+t),a=0;a<s.publishWaitingList.length;a++)(r=s.publishWaitingList[a]).error&&r.error(r.streamId,e);for(a=0;a<s.playWaitingList.length;a++)(o=s.playWaitingList[a]).error&&o.error(o.streamId,e);delete l.signalList[n]}else{for(l.logger.debug("zsc.crss.0 connected success "+t),s.state=u.ENUM_SIGNAL_STATE.connected,s.tokenInfo=i,a=0;a<s.publishWaitingList.length;a++)(r=s.publishWaitingList[a]).success&&r.success(r.streamId,s),s.publishConnectedList.push(r.streamId);for(a=0;a<s.playWaitingList.length;a++)(o=s.playWaitingList[a]).success&&o.success(o.streamId,s),s.playConnectedList.push(o.streamId);s.publishWaitingList=[],s.playWaitingList=[],null==l.heartbeatTimer&&l.startSignalHeartbeat()}})}},t.prototype.setPlayStateStart=function(e,t,n,i){var r=this.getTotalStreamId(e);if(this.playerList[r])return this.logger.warn("zsc.pss.1 player already exist"),!1;var l=new d.ZegoPlayWeb(this.logger,null,this.dataReport,this.qualityTimerInterval);return l.onPlayStateUpdate=this.onPlayStateUpdate,l.onPlayQualityUpdate=this.onPlayQualityUpdate,l.onVideoSizeChanged=this.onVideoSizeChanged,this.playerList[r]={player:l,remoteVideo:t,audioOutput:n,signal:null,serverUrls:[],retryCount:0,playOption:i},this.dataReport.eventStart(l.reportSeq,"GetSignalUrl"),!0},t.prototype.startPlayingStream=function(e,t,n){this.logger.info("zsc.sps.1 start play called");var i=this.getTotalStreamId(e),r=this.playerList[i];if(!r)return this.logger.error("zsc.sps.1 player don't exist"),!1;return this.dataReport.eventEndWithMsg(r.player.reportSeq,"GetSignalUrl",{urls:t}),0==t.length?(this.onPlayStateUpdate(a.ENUM_PLAY_STATE_UPDATE.error,e,a.playErrorList.DISPATCH_ERROR),this.logger.info("zsc.sps.1 server don't have signal url"),!1):(r.serverUrls=r.serverUrls.concat(t),this.connectPlayServer(i,t[0]))},t.prototype.connectPlayServer=function(e,t){var n=this,i=this.playerList[e];return i?(this.dataReport.eventStart(i.player.reportSeq,"ConnectServer"),this.connetWithReuseSignalServer(e,!1,t,function(e,i){var r=n.playerList[e];if(r){var l=r.player;if(l){n.dataReport.eventEndWithMsg(l.reportSeq,"ConnectServer",{result:0,server:t});var s=i.tokenInfo;n.logger.info("zsc.cps.1 update token success"),s&&s.report&&(l.qualityUpload=s.report,l.qualityUploadInterval=s.report_interval),l.signal=i.signal,r.retryCount=0,n.playStream(e),n.getTokenSuccess()}else n.logger.error("zsc.cps.1 checkplayer don't exist")}else n.logger.error("zsc.cps.1 after connect player don't exist")},function(e,t){var i=n.playerList[e];if(i)if(n.shouldRetry(i,t)){n.logger.info("zsc.cps.1 retry connect");var r=i.serverUrls[0];i.serverUrls.splice(0,1),i.retryCount+=1,n.connectPlayServer(e,r)}else n.onPlayStateUpdate(a.ENUM_PLAY_STATE_UPDATE.error,e,a.playErrorList.TOKEN_ERROR);else n.logger.error("zsc.cps.1 after connect player don't exist")}),!0):(this.logger.error("zsc.cps.1 player don't exist"),!1)},t.prototype.playStream=function(e){var t=this.playerList[e].player;t?(this.logger.info("zsc.ps.1 call success"),t.startPlay(e,this.playerList[e].remoteVideo,this.playerList[e].audioOutput,this.playerList[e].playOption)):this.logger.warn("zsc.ps.1 player don't exist")},t.prototype.removeStreamFromSignal=function(e,t){var n=[];for(var i in this.signalList){var r=this.signalList[i];if(e){for(var l=0;l<r.publishConnectedList.length;l++)if(r.publishConnectedList[l]===t){this.logger.debug("zsc.rsfs.0 found from publish"),r.publishConnectedList.splice(l,1);break}}else for(var s=0;s<r.playConnectedList.length;s++)if(r.playConnectedList[s]===t){this.logger.debug("zsc.rsfs.0 found from play"),r.playConnectedList.splice(s,1);break}0==r.publishConnectedList.length&&0==r.playConnectedList.length&&(r.signal.disconnectServer(),n.push(i))}for(var o=0;o<n.length;o++)delete this.signalList[n[o]]},t.prototype.stopSignalHeartbeat=function(){this.logger.debug("zsc.ssh.1 call");var e=0;for(var t in this.signalList)e+=1;this.heartbeatTimer&&0==e&&(this.logger.info("zsc.ssh.1 stop"),clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},t.prototype.stopPlayingStream=function(e){var t=this.getTotalStreamId(e),n=this.playerList[t];n?(n.player&&(n.player.stopPlay(),delete n.player),this.removeStreamFromSignal(!1,t),this.stopSignalHeartbeat(),delete this.playerList[t],this.logger.debug("zsc.sps.1.1 call success")):this.logger.info("zsc.sps.1.1 player don't exist")},t.prototype.reset=function(){for(var e in this.publisherList)this.publisherList[e].publisher&&this.publisherList[e].publisher.stopPublish();for(var t in this.playerList)this.playerList[t].player&&this.playerList[t].player.stopPlay();for(var n in this.signalList)this.signalList[n].signal&&this.signalList[n].signal.disconnectServer();this.playerList={},this.publisherList={},this.signalList={},this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},t.prototype.startSignalHeartbeat=function(){var e=this;this.logger.debug("zsc.ssh.0 call"),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatTimer=setTimeout(function(){e.checkSignalHeartbeat()},this.heartbeatInterval)},t.prototype.checkSignalHeartbeat=function(){for(var e in this.logger.debug("zsc.csh.0 call"),this.signalList)this.signalList[e].signal&&this.signalList[e].signal.sendHeartbeat();this.heartbeatTimer&&this.startSignalHeartbeat()},t.prototype.checkPreivew=function(e){for(var t=0;t<this.previewVideoList.length;t++)if(this.previewVideoList[t].localVideo===e)return this.previewVideoList[t];return null},t.prototype.removePreview=function(e){for(var t=0;t<this.previewVideoList.length;t++)if(this.previewVideoList[t]===e){this.previewVideoList.splice(t,1);break}},t.prototype.onPlayerStreamUrlUpdate=function(e,t,n){},t.prototype.onVideoSizeChanged=function(e,t,n){},t}(n(14).ZegoStreamCenter);t.ZegoStreamCenterWeb=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.D=["00","01","02","03","04","05","06","07","08","09"];var r=function(){function e(){this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCache=[],this.logCacheSend=[],this.logCacheMax=100}return e.prototype.setLogLevel=function(e){this.logLevel=this.logLevel<i.ENUM_LOG_LEVEL.debug||this.logLevel>i.ENUM_LOG_LEVEL.report?i.ENUM_LOG_LEVEL.disable:e},e.prototype.setRemoteLogLevel=function(e){this.logRemoteLevel=this.logRemoteLevel<i.ENUM_LOG_LEVEL.debug||this.logRemoteLevel>i.ENUM_LOG_LEVEL.report?i.ENUM_LOG_LEVEL.disable:e},e.prototype.setSessionInfo=function(e,t,n,i,r,l){this.appid=e,this.roomid=t,this.sessionid=n,this.userid=i,this.userName=r,this.version=l},e.prototype.openLogServer=function(e){try{e.startsWith("wss:")?(this.logType=i.ENUM_REMOTE_TYPE.websocket,this.openWebSocketLogServer(e)):e.startsWith("https:")?(this.logType=i.ENUM_REMOTE_TYPE.https,this.openHttpsLogServer(e)):this.logType=i.ENUM_REMOTE_TYPE.disable}catch(e){this.error(JSON.stringify(e))}},e.prototype.stopLogServer=function(){this.logType==i.ENUM_REMOTE_TYPE.websocket?this.stopWebSocketServer():this.logType==i.ENUM_REMOTE_TYPE.https&&(this.SendHttpsLog(),this.stopHttpsServer()),this.logType=i.ENUM_REMOTE_TYPE.disable},e.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},e.prototype.openHttpsLogServer=function(e){var t=this;this.url=e,e&&(this.stopHttpsServer(),this.logUploadTimer||(this.logUploadTimer=setInterval(function(){t.SendHttpsLog()},this.logUploadInterval)))},e.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},e.prototype.report=function(e){var t=this.logReportParamList(i.ENUM_LOG_LEVEL.report,e);this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=i.ENUM_LOG_LEVEL.report&&console.debug.apply(console,t),this.RemoteLog(i.ENUM_LOG_LEVEL.report,t,!0)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(i.ENUM_LOG_LEVEL.debug,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=i.ENUM_LOG_LEVEL.debug&&console.debug.apply(console,n),this.log(i.ENUM_LOG_LEVEL.debug,n)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(i.ENUM_LOG_LEVEL.info,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=i.ENUM_LOG_LEVEL.info&&console.info.apply(console,n),this.log(i.ENUM_LOG_LEVEL.info,n)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(i.ENUM_LOG_LEVEL.warn,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=i.ENUM_LOG_LEVEL.warn&&console.warn.apply(console,n),this.log(i.ENUM_LOG_LEVEL.warn,n)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(i.ENUM_LOG_LEVEL.error,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=i.ENUM_LOG_LEVEL.error&&console.error.apply(console,n),this.log(i.ENUM_LOG_LEVEL.error,n)},e.prototype.log=function(e,t){if(this.logLevel!==i.ENUM_LOG_LEVEL.disable&&this.logLevel<=e)for(this.logCache.push(t);this.logCache.length>this.logCacheMax;)this.logCache.shift();this.logRemoteLevel!==i.ENUM_LOG_LEVEL.disable&&this.logRemoteLevel<=e&&this.RemoteLog(e,t)},e.prototype.RemoteLog=function(e,t,n){void 0===n&&(n=!1),""!=this.url&&(this.logType==i.ENUM_REMOTE_TYPE.websocket?this.RemoteWebSocketLog(e,t):this.logType==i.ENUM_REMOTE_TYPE.https&&this.RemoteHttpsLog(e,t,n))},e.prototype.RemoteWebSocketLog=function(e,t){if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState){var n=this.url;this.url="",this.openLogServer(n),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)}else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState){if(this.logCacheSend.length>0){for(var i="",r=0;r<this.logCacheSend.length;r++)i=i+this.logCacheSend[r]+"\n";t=i+t,this.logCacheSend=[]}this.websocket.send(t)}else console.warn("wrong socket state:"+this.websocket.readyState),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},e.prototype.RemoteHttpsLog=function(e,t,n){this.logCacheSend.push(t),(this.logCacheSend.length>=this.logCacheMax||!0===n)&&this.SendHttpsLog()},e.prototype.logParamList=function(e,n){var i=new Date,r=i.getFullYear()+"/";r+=(t.D[i.getMonth()+1]||i.getMonth()+1)+"/",r+=(t.D[i.getDate()]||i.getDate())+" ",r+=(t.D[i.getHours()]||i.getHours())+":",r+=(t.D[i.getMinutes()]||i.getMinutes())+":",r+=t.D[i.getSeconds()]||i.getSeconds(),r+="."+i.getTime()%1e3;var l=n.substr(0,n.indexOf(" "));0==l.length&&(l=n);var s=n.substr(n.indexOf(" ")+1);0==s.length&&(s="");var o={time:r,level:e,action:l,content:s,appid:this.appid,roomid:this.roomid,userid:this.userid,userName:this.userName,sessionid:this.sessionid};return[JSON.stringify(o)]},e}();t.Logger=r},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=n(23),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.openWebSocketLogServer=function(e){if(this.url!=e){if(this.url=e,this.stopWebSocketServer(),!e)return;this.websocket=new WebSocket(e),this.websocket.onopen=function(e){},this.websocket.onclose=function(e){},this.websocket.onmessage=function(e){},this.websocket.onerror=function(e){console.error("open log websocket error:"+e)}}},t.prototype.SendHttpsLog=function(){var e=this;if(0!=this.logCacheSend.length){var t=this.logCacheSend.join("\n"),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){if(0==n.responseText.length)return;try{var t=JSON.parse(n.responseText).interval;"number"==typeof t&&e.logUploadInterval!==t&&(e.timeInterval=t,e.openHttpsLogServer(e.url))}catch(e){console.log("send result failed "+e)}}else console.log("send failed "+n.status)},n.open("POST",this.url,!0),n.send(t),this.logCacheSend=[]}},t.prototype.logReportParamList=function(e,t){var n=new Date,i=n.getFullYear()+"/";return i+=(l.D[n.getMonth()+1]||n.getMonth()+1)+"/",i+=(l.D[n.getDate()]||n.getDate())+" ",i+=(l.D[n.getHours()]||n.getHours())+":",i+=(l.D[n.getMinutes()]||n.getMinutes())+":",i+=l.D[n.getSeconds()]||n.getSeconds(),i+="."+n.getTime()%1e3,t.time=i,t.level=e,t.console="rtc",t.appid=this.appid,t.roomid=this.roomid,t.userid=this.userid,t.id_name=this.userid,t.userName=this.userName,t.sessionid=this.sessionid,t.version=this.version,[JSON.stringify(t)]},t}(l.Logger);t.LoggerWeb=s},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),s=n(2),o=n(24),a=n(22),u=n(1),c=n(13),d=n(5),h=n(4),p=function(e){function t(){var t=this,n=new o.LoggerWeb,i=new d.StateCenter,r=new a.ZegoStreamCenterWeb(n,i);return(t=e.call(this)||this).streamCenter=r,t.logger=n,t.stateCenter=i,t.init(),window.addEventListener("message",function(e){var n=e.data;"SS_DIALOG_SUCCESS"===n.type&&t.screenStreamFrom(n.streamId,n.canRequestAudioTrack,u.ClientUtil.actionSuccessCallback("screenShare",t.stateCenter.callbackList))}),t}return r(t,e),t.prototype.getSocket=function(e){return new WebSocket(e)},t.prototype.enableCamera=function(e,t){return this.logger.debug("zc.p.ec.0 call"),"boolean"!=typeof t?(this.logger.error("zc.p.ec.0 argument is not bool"),!1):this.streamCenter.enableCamera(e,t)},t.prototype.enableMicrophone=function(e,t){return this.logger.debug("zc.p.em.0 call"),"boolean"!=typeof t?(this.logger.error("zc.p.em.0 argument is not bool"),!1):this.streamCenter.enableMicrophone(e,t)},t.prototype.setLocalAudioOutput=function(e,t){return this.logger.debug("zc.p.psao.1 call"),this.streamCenter.setPublishStreamAudioOutput(e,t)},t.prototype.setPlayAudioOutput=function(e,t){return this.logger.debug("zc.p.psao.1 call"),this.streamCenter.setPlayStreamAudioOutput(e,t)},t.prototype.setCustomSignalUrl=function(e){return this.logger.debug("zc.p.scs.0 call: "+e),e&&0!=e.length?0!=e.indexOf("wss://")?(this.logger.error("zc.p.scs.0 url is not correct"),!1):void(this.stateCenter.customUrl=e):(this.logger.error("zc.p.scs.0 param error"),!1)},t.prototype.setQualityMonitorCycle=function(e){"number"==typeof e&&e>=1e3&&this.streamCenter.setQualityMonitorCycle(e)},t.prototype.startPlayingStream=function(e,t,n,i){var r=this;if(this.logger.debug("zc.p.sps.0 call"),!e||""===e)return this.logger.error("zc.p.sps.0 param error"),!1;if(!t)return this.logger.error("zc.p.sps.0 don't have remoteVideo"),!1;if(this.stateCenter.customUrl)return this.streamCenter.setPlayStateStart(e,t,n,i)?this.streamCenter.startPlayingStream(e,[this.stateCenter.customUrl]):(this.logger.error("zc.p.sps.0 cannot start play"),!1);if(!this.stateCenter.isLogin())return this.logger.error("zc.p.sps.0 not login"),!1;for(var o=!1,a=0;a<this.stateCenter.streamList.length;a++)if(this.stateCenter.streamList[a].stream_id===e){o=!0;break}if(0==o&&this.logger.info("zc.p.sps.0 cannot find stream"),!this.streamCenter.setPlayStateStart(e,t,n,i))return this.logger.info("zc.p.sps.0 cannot start play"),!1;var u={stream_id:e,ptype:"pull",signals:this.streamCenter.getAllInUseUrl()};return this.socketCenter.registerRouter("webrtc_url",function(e){r.handleFetchWebRtcUrlRsp(e)}),this.socketCenter.sendMessage("webrtc_url",u,void 0,function(t,n){r.onPlayStateUpdate(l.ENUM_PLAY_STATE_UPDATE.error,e,t==l.sdkErrorList.SEND_MSG_TIMEOUT?s.playErrorList.DISPATCH_TIMEOUT:s.playErrorList.DISPATCH_ERROR),r.streamCenter.stopPlayingStream(e)}),!0},t.prototype.stopPlayingStream=function(e){if(this.logger.debug("zc.p.sps.1.0 call"),!e||""===e)return this.logger.info("zc.p.sps.1.0 param error"),!1;for(var t in this.streamCenter.stopPlayingStream(e),this.stateCenter.streamUrlMap)if(this.stateCenter.streamUrlMap[t]===e){delete this.stateCenter.streamUrlMap[t];break}return this.logger.debug("zc.p.sps.1.0 call success"),!0},t.prototype.startPreview=function(e,t,n,i){return this.logger.debug("zc.p.sp.0 call"),e?this.streamCenter.startPreview(e,t,n,i):(this.logger.error("zc.p.sp.0 no localVideo"),!1)},t.prototype.stopPreview=function(e){return this.logger.debug("zc.p.sp.1 call"),e?this.streamCenter.stopPreview(e):(this.logger.info("zc.p.sp.1 param error"),!1)},t.prototype.startPublishingStream=function(e,t,n,i){var r=this;if(this.logger.debug("zc.p.sps.1 call"),!e)return this.logger.error("zc.p.sps.1 param error"),!1;if(this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)return this.stateCenter.publishStreamList[e]={state:l.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:n},this.streamCenter.setPublishStateStart(e,t,i)?this.streamCenter.startPublishingStream(e,[this.stateCenter.customUrl]):(this.logger.info("zc.p.sps.1 cannot start publish"),!1);if(!this.stateCenter.isLogin())return this.logger.error("zc.p.sps.1 not login"),!1;if(this.stateCenter.publishStreamList[e]={state:l.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:n},!this.streamCenter.setPublishStateStart(e,t,i))return this.logger.error("zc.p.sps.1 cannot start publish"),!1;this.logger.info("zc.p.sps.1 start publish");var o={stream_id:e,ptype:"push",signals:this.streamCenter.getAllInUseUrl(),header_kvs:[{key:"grpc-metadata-push",value:i&&i.cdnUrl||""}]};return this.socketCenter.registerRouter("webrtc_url",function(e){r.handleFetchWebRtcUrlRsp(e)}),this.socketCenter.sendMessage("webrtc_url",o,void 0,function(t,n){r.onPublishStateUpdate(l.ENUM_PUBLISH_STATE_UPDATE.error,e,t==l.sdkErrorList.SEND_MSG_TIMEOUT?s.publishErrorList.DISPATCH_TIMEOUT:s.publishErrorList.DISPATCH_ERROR),r.streamCenter.stopPublishingStream(e)}),!0},t.prototype.stopPublishingStream=function(e){return this.logger.debug("zc.p.sps.1.1 call"),e?(this.streamCenter.stopPublishingStream(e),this.stateCenter.publishStreamList[e]&&(this.stateCenter.publishStreamList[e].state>=l.ENUM_PUBLISH_STREAM_STATE.update_info&&this.streamHandler.updateStreamInfo(e,l.ENUM_STREAM_SUB_CMD.liveEnd),delete this.stateCenter.publishStreamList[e]),!0):(this.logger.info("zc.p.sps.1.1 param error"),!1)},t.prototype.startScreenShotChrome=function(e){if(!t.screenShotReady)return this.logger.error('zc.b.ss Please install the extension:1. Go to chrome://extensions  2. Check: "Enable Developer mode   3. Click: "Load the unpacked extension... 4. Choose "extension" folder from the repository 5. Reload this page\n                                      '),!1;window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*"),u.ClientUtil.registerCallback("screenShare",{success:e},this.stateCenter.callbackList)},t.prototype.startScreenShotFirFox=function(e,t,n){var i=this,r={video:{},audio:t};r.video.mediaSource=e,navigator.mediaDevices.getUserMedia(r).then(function(e){i.stateCenter.screenShotStream=e,n(!0,e)}).catch(function(e){i.logger.error("zc.b.ssf "+e),n(!1,null)})},t.prototype.stopScreenShot=function(){this.stateCenter.screenShotStream.getTracks().forEach(function(e){e.stop()}),window.postMessage({type:"SS_UI_CANCEL",text:"start"},"*")},t.prototype.WebrtcOnPublishStateUpdateHandle=function(e,t,n){this.stateCenter.publishStreamList[t].state==l.ENUM_PUBLISH_STREAM_STATE.publishing&&this.onPublishStateUpdate(e,t,n)},t.prototype.setCDNInfo=function(e,t){e.urls_flv=t.urls_flv,e.urls_hls=t.urls_m3u8,e.urls_https_flv=t.urls_https_flv,e.urls_https_hls=t.urls_https_m3u8,e.urls_rtmp=t.urls_rtmp},t.prototype.loginBodyData=function(){return{id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,role:this.stateCenter.role,token:this.stateCenter.token,version:l.PROTO_VERSION,room_name:this.stateCenter.roomid,user_state_flag:this.stateCenter.userStateUpdate?1:0,room_create_flag:this.stateCenter.roomCreateFlag,client_type:l.E_CLIENT_TYPE.ClientType_Webrtc}},t.prototype.screenStreamFrom=function(e,t,n){var i=this,r={};r.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}},r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height}},!t&&(r.audio=!1),navigator.mediaDevices.getUserMedia(r).then(function(e){i.stateCenter.screenShotStream=e,n(!0,e)}).catch(function(e){i.logger.error("zc.b.ssf "+e),n(!1,null)})},t.isSupportWebrtc=function(){return u.ClientUtil.isSupportWebrtc()},t.isSupportH264=function(e,t){u.ClientUtil.isSupportH264(e,t)},t.prototype.enumDevices=function(e,n){t.enumDevices(e,n)},t.enumDevices=function(e,t){void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(t){for(var n=[],i=[],r=[],l=0;l<t.length;l++){var s=t[l];"audioinput"===s.kind&&n.push({label:s.label,deviceId:s.deviceId}),"audiooutput"===s.kind&&i.push({label:s.label,deviceId:s.deviceId}),"videoinput"===s.kind&&r.push({label:s.label,deviceId:s.deviceId})}e&&e({microphones:n,speakers:i,cameras:r})}).catch(function(e){t&&t(e)}):t&&t("browser don't support enumerate devices")},t.getAudioInfo=function(e,t){return e.srcObject?(new h.SoundMeter).connectToSource(e.srcObject,function(e){t(e)}):(console.warn("srcObject is empty!"),!1)},t.screenShotReady=!1,t}(c.BaseCenter);t.ZegoClient=p,window.addEventListener("message",function(e){var t=e.data,n=t.type,i=e.origin;i!==window.location.origin&&console.warn("ScreenStream: you should discard foreign event from origin:",i),"SS_PING"===n&&(p.screenShotReady=!0)})}])})}},[201]);